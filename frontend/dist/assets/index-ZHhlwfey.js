(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var Rr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ev(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Sv(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var e1={exports:{}},uc={},t1={exports:{}},Ie={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var io=Symbol.for("react.element"),Tv=Symbol.for("react.portal"),Av=Symbol.for("react.fragment"),Cv=Symbol.for("react.strict_mode"),Nv=Symbol.for("react.profiler"),bv=Symbol.for("react.provider"),Fv=Symbol.for("react.context"),Ov=Symbol.for("react.forward_ref"),Pv=Symbol.for("react.suspense"),Rv=Symbol.for("react.memo"),Dv=Symbol.for("react.lazy"),wd=Symbol.iterator;function Iv(e){return e===null||typeof e!="object"?null:(e=wd&&e[wd]||e["@@iterator"],typeof e=="function"?e:null)}var r1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},n1=Object.assign,a1={};function Ds(e,t,r){this.props=e,this.context=t,this.refs=a1,this.updater=r||r1}Ds.prototype.isReactComponent={};Ds.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ds.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function s1(){}s1.prototype=Ds.prototype;function H0(e,t,r){this.props=e,this.context=t,this.refs=a1,this.updater=r||r1}var V0=H0.prototype=new s1;V0.constructor=H0;n1(V0,Ds.prototype);V0.isPureReactComponent=!0;var yd=Array.isArray,i1=Object.prototype.hasOwnProperty,W0={current:null},o1={key:!0,ref:!0,__self:!0,__source:!0};function l1(e,t,r){var n,a={},s=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(s=""+t.key),t)i1.call(t,n)&&!o1.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:io,type:e,key:s,ref:i,props:a,_owner:W0.current}}function jv(e,t){return{$$typeof:io,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function G0(e){return typeof e=="object"&&e!==null&&e.$$typeof===io}function Lv(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var _d=/\/+/g;function Uc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Lv(""+e.key):t.toString(36)}function ul(e,t,r,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case io:case Tv:i=!0}}if(i)return i=e,a=a(i),e=n===""?"."+Uc(i,0):n,yd(a)?(r="",e!=null&&(r=e.replace(_d,"$&/")+"/"),ul(a,t,r,"",function(c){return c})):a!=null&&(G0(a)&&(a=jv(a,r+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(_d,"$&/")+"/")+e)),t.push(a)),1;if(i=0,n=n===""?".":n+":",yd(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+Uc(s,o);i+=ul(s,t,r,l,a)}else if(l=Iv(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+Uc(s,o++),i+=ul(s,t,r,l,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function Po(e,t,r){if(e==null)return e;var n=[],a=0;return ul(e,n,"","",function(s){return t.call(r,s,a++)}),n}function Mv(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var lr={current:null},fl={transition:null},Bv={ReactCurrentDispatcher:lr,ReactCurrentBatchConfig:fl,ReactCurrentOwner:W0};function c1(){throw Error("act(...) is not supported in production builds of React.")}Ie.Children={map:Po,forEach:function(e,t,r){Po(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Po(e,function(){t++}),t},toArray:function(e){return Po(e,function(t){return t})||[]},only:function(e){if(!G0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ie.Component=Ds;Ie.Fragment=Av;Ie.Profiler=Nv;Ie.PureComponent=H0;Ie.StrictMode=Cv;Ie.Suspense=Pv;Ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Bv;Ie.act=c1;Ie.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=n1({},e.props),a=e.key,s=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,i=W0.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)i1.call(t,l)&&!o1.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:io,type:e.type,key:a,ref:s,props:n,_owner:i}};Ie.createContext=function(e){return e={$$typeof:Fv,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:bv,_context:e},e.Consumer=e};Ie.createElement=l1;Ie.createFactory=function(e){var t=l1.bind(null,e);return t.type=e,t};Ie.createRef=function(){return{current:null}};Ie.forwardRef=function(e){return{$$typeof:Ov,render:e}};Ie.isValidElement=G0;Ie.lazy=function(e){return{$$typeof:Dv,_payload:{_status:-1,_result:e},_init:Mv}};Ie.memo=function(e,t){return{$$typeof:Rv,type:e,compare:t===void 0?null:t}};Ie.startTransition=function(e){var t=fl.transition;fl.transition={};try{e()}finally{fl.transition=t}};Ie.unstable_act=c1;Ie.useCallback=function(e,t){return lr.current.useCallback(e,t)};Ie.useContext=function(e){return lr.current.useContext(e)};Ie.useDebugValue=function(){};Ie.useDeferredValue=function(e){return lr.current.useDeferredValue(e)};Ie.useEffect=function(e,t){return lr.current.useEffect(e,t)};Ie.useId=function(){return lr.current.useId()};Ie.useImperativeHandle=function(e,t,r){return lr.current.useImperativeHandle(e,t,r)};Ie.useInsertionEffect=function(e,t){return lr.current.useInsertionEffect(e,t)};Ie.useLayoutEffect=function(e,t){return lr.current.useLayoutEffect(e,t)};Ie.useMemo=function(e,t){return lr.current.useMemo(e,t)};Ie.useReducer=function(e,t,r){return lr.current.useReducer(e,t,r)};Ie.useRef=function(e){return lr.current.useRef(e)};Ie.useState=function(e){return lr.current.useState(e)};Ie.useSyncExternalStore=function(e,t,r){return lr.current.useSyncExternalStore(e,t,r)};Ie.useTransition=function(){return lr.current.useTransition()};Ie.version="18.3.1";t1.exports=Ie;var J=t1.exports;const Uv=Ev(J);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $v=J,zv=Symbol.for("react.element"),Hv=Symbol.for("react.fragment"),Vv=Object.prototype.hasOwnProperty,Wv=$v.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Gv={key:!0,ref:!0,__self:!0,__source:!0};function u1(e,t,r){var n,a={},s=null,i=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)Vv.call(t,n)&&!Gv.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:zv,type:e,key:s,ref:i,props:a,_owner:Wv.current}}uc.Fragment=Hv;uc.jsx=u1;uc.jsxs=u1;e1.exports=uc;var h=e1.exports,f1={exports:{}},Sr={},d1={exports:{}},h1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ie,M){var se=ie.length;ie.push(M);e:for(;0<se;){var me=se-1>>>1,b=ie[me];if(0<a(b,M))ie[me]=M,ie[se]=b,se=me;else break e}}function r(ie){return ie.length===0?null:ie[0]}function n(ie){if(ie.length===0)return null;var M=ie[0],se=ie.pop();if(se!==M){ie[0]=se;e:for(var me=0,b=ie.length,H=b>>>1;me<H;){var L=2*(me+1)-1,j=ie[L],Z=L+1,V=ie[Z];if(0>a(j,se))Z<b&&0>a(V,j)?(ie[me]=V,ie[Z]=se,me=Z):(ie[me]=j,ie[L]=se,me=L);else if(Z<b&&0>a(V,se))ie[me]=V,ie[Z]=se,me=Z;else break e}}return M}function a(ie,M){var se=ie.sortIndex-M.sortIndex;return se!==0?se:ie.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],c=[],u=1,f=null,d=3,p=!1,x=!1,m=!1,v=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(ie){for(var M=r(c);M!==null;){if(M.callback===null)n(c);else if(M.startTime<=ie)n(c),M.sortIndex=M.expirationTime,t(l,M);else break;M=r(c)}}function E(ie){if(m=!1,g(ie),!x)if(r(l)!==null)x=!0,pe(P);else{var M=r(c);M!==null&&de(E,M.startTime-ie)}}function P(ie,M){x=!1,m&&(m=!1,w(I),I=-1),p=!0;var se=d;try{for(g(M),f=r(l);f!==null&&(!(f.expirationTime>M)||ie&&!z());){var me=f.callback;if(typeof me=="function"){f.callback=null,d=f.priorityLevel;var b=me(f.expirationTime<=M);M=e.unstable_now(),typeof b=="function"?f.callback=b:f===r(l)&&n(l),g(M)}else n(l);f=r(l)}if(f!==null)var H=!0;else{var L=r(c);L!==null&&de(E,L.startTime-M),H=!1}return H}finally{f=null,d=se,p=!1}}var T=!1,k=null,I=-1,R=5,U=-1;function z(){return!(e.unstable_now()-U<R)}function B(){if(k!==null){var ie=e.unstable_now();U=ie;var M=!0;try{M=k(!0,ie)}finally{M?ae():(T=!1,k=null)}}else T=!1}var ae;if(typeof y=="function")ae=function(){y(B)};else if(typeof MessageChannel<"u"){var ge=new MessageChannel,ue=ge.port2;ge.port1.onmessage=B,ae=function(){ue.postMessage(null)}}else ae=function(){v(B,0)};function pe(ie){k=ie,T||(T=!0,ae())}function de(ie,M){I=v(function(){ie(e.unstable_now())},M)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ie){ie.callback=null},e.unstable_continueExecution=function(){x||p||(x=!0,pe(P))},e.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<ie?Math.floor(1e3/ie):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(ie){switch(d){case 1:case 2:case 3:var M=3;break;default:M=d}var se=d;d=M;try{return ie()}finally{d=se}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ie,M){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var se=d;d=ie;try{return M()}finally{d=se}},e.unstable_scheduleCallback=function(ie,M,se){var me=e.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?me+se:me):se=me,ie){case 1:var b=-1;break;case 2:b=250;break;case 5:b=1073741823;break;case 4:b=1e4;break;default:b=5e3}return b=se+b,ie={id:u++,callback:M,priorityLevel:ie,startTime:se,expirationTime:b,sortIndex:-1},se>me?(ie.sortIndex=se,t(c,ie),r(l)===null&&ie===r(c)&&(m?(w(I),I=-1):m=!0,de(E,se-me))):(ie.sortIndex=b,t(l,ie),x||p||(x=!0,pe(P))),ie},e.unstable_shouldYield=z,e.unstable_wrapCallback=function(ie){var M=d;return function(){var se=d;d=M;try{return ie.apply(this,arguments)}finally{d=se}}}})(h1);d1.exports=h1;var Kv=d1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xv=J,kr=Kv;function ce(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var p1=new Set,Ri={};function La(e,t){Ss(e,t),Ss(e+"Capture",t)}function Ss(e,t){for(Ri[e]=t,e=0;e<t.length;e++)p1.add(t[e])}var Tn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bu=Object.prototype.hasOwnProperty,Yv=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,kd={},Ed={};function qv(e){return bu.call(Ed,e)?!0:bu.call(kd,e)?!1:Yv.test(e)?Ed[e]=!0:(kd[e]=!0,!1)}function Jv(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Qv(e,t,r,n){if(t===null||typeof t>"u"||Jv(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function cr(e,t,r,n,a,s,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var Mt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Mt[e]=new cr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Mt[t]=new cr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Mt[e]=new cr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Mt[e]=new cr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Mt[e]=new cr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Mt[e]=new cr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Mt[e]=new cr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Mt[e]=new cr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Mt[e]=new cr(e,5,!1,e.toLowerCase(),null,!1,!1)});var K0=/[\-:]([a-z])/g;function X0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(K0,X0);Mt[t]=new cr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(K0,X0);Mt[t]=new cr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(K0,X0);Mt[t]=new cr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Mt[e]=new cr(e,1,!1,e.toLowerCase(),null,!1,!1)});Mt.xlinkHref=new cr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Mt[e]=new cr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Y0(e,t,r,n){var a=Mt.hasOwnProperty(t)?Mt[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Qv(t,r,a,n)&&(r=null),n||a===null?qv(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Fn=Xv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ro=Symbol.for("react.element"),rs=Symbol.for("react.portal"),ns=Symbol.for("react.fragment"),q0=Symbol.for("react.strict_mode"),Fu=Symbol.for("react.profiler"),x1=Symbol.for("react.provider"),m1=Symbol.for("react.context"),J0=Symbol.for("react.forward_ref"),Ou=Symbol.for("react.suspense"),Pu=Symbol.for("react.suspense_list"),Q0=Symbol.for("react.memo"),Ln=Symbol.for("react.lazy"),g1=Symbol.for("react.offscreen"),Sd=Symbol.iterator;function Xs(e){return e===null||typeof e!="object"?null:(e=Sd&&e[Sd]||e["@@iterator"],typeof e=="function"?e:null)}var ot=Object.assign,$c;function ni(e){if($c===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);$c=t&&t[1]||""}return`
`+$c+e}var zc=!1;function Hc(e,t){if(!e||zc)return"";zc=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),s=n.stack.split(`
`),i=a.length-1,o=s.length-1;1<=i&&0<=o&&a[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==s[o]){if(i!==1||o!==1)do if(i--,o--,0>o||a[i]!==s[o]){var l=`
`+a[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{zc=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?ni(e):""}function Zv(e){switch(e.tag){case 5:return ni(e.type);case 16:return ni("Lazy");case 13:return ni("Suspense");case 19:return ni("SuspenseList");case 0:case 2:case 15:return e=Hc(e.type,!1),e;case 11:return e=Hc(e.type.render,!1),e;case 1:return e=Hc(e.type,!0),e;default:return""}}function Ru(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ns:return"Fragment";case rs:return"Portal";case Fu:return"Profiler";case q0:return"StrictMode";case Ou:return"Suspense";case Pu:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case m1:return(e.displayName||"Context")+".Consumer";case x1:return(e._context.displayName||"Context")+".Provider";case J0:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Q0:return t=e.displayName||null,t!==null?t:Ru(e.type)||"Memo";case Ln:t=e._payload,e=e._init;try{return Ru(e(t))}catch{}}return null}function e2(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ru(t);case 8:return t===q0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function na(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function v1(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function t2(e){var t=v1(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){n=""+i,s.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Do(e){e._valueTracker||(e._valueTracker=t2(e))}function w1(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=v1(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function El(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Du(e,t){var r=t.checked;return ot({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Td(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=na(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function y1(e,t){t=t.checked,t!=null&&Y0(e,"checked",t,!1)}function Iu(e,t){y1(e,t);var r=na(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?ju(e,t.type,r):t.hasOwnProperty("defaultValue")&&ju(e,t.type,na(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Ad(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function ju(e,t,r){(t!=="number"||El(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var ai=Array.isArray;function xs(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+na(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Lu(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ce(91));return ot({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Cd(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ce(92));if(ai(r)){if(1<r.length)throw Error(ce(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:na(r)}}function _1(e,t){var r=na(t.value),n=na(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Nd(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function k1(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Mu(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?k1(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Io,E1=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Io=Io||document.createElement("div"),Io.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Io.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Di(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var di={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},r2=["Webkit","ms","Moz","O"];Object.keys(di).forEach(function(e){r2.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),di[t]=di[e]})});function S1(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||di.hasOwnProperty(e)&&di[e]?(""+t).trim():t+"px"}function T1(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=S1(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var n2=ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bu(e,t){if(t){if(n2[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ce(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ce(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ce(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ce(62))}}function Uu(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $u=null;function Z0(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var zu=null,ms=null,gs=null;function bd(e){if(e=co(e)){if(typeof zu!="function")throw Error(ce(280));var t=e.stateNode;t&&(t=xc(t),zu(e.stateNode,e.type,t))}}function A1(e){ms?gs?gs.push(e):gs=[e]:ms=e}function C1(){if(ms){var e=ms,t=gs;if(gs=ms=null,bd(e),t)for(e=0;e<t.length;e++)bd(t[e])}}function N1(e,t){return e(t)}function b1(){}var Vc=!1;function F1(e,t,r){if(Vc)return e(t,r);Vc=!0;try{return N1(e,t,r)}finally{Vc=!1,(ms!==null||gs!==null)&&(b1(),C1())}}function Ii(e,t){var r=e.stateNode;if(r===null)return null;var n=xc(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ce(231,t,typeof r));return r}var Hu=!1;if(Tn)try{var Ys={};Object.defineProperty(Ys,"passive",{get:function(){Hu=!0}}),window.addEventListener("test",Ys,Ys),window.removeEventListener("test",Ys,Ys)}catch{Hu=!1}function a2(e,t,r,n,a,s,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var hi=!1,Sl=null,Tl=!1,Vu=null,s2={onError:function(e){hi=!0,Sl=e}};function i2(e,t,r,n,a,s,i,o,l){hi=!1,Sl=null,a2.apply(s2,arguments)}function o2(e,t,r,n,a,s,i,o,l){if(i2.apply(this,arguments),hi){if(hi){var c=Sl;hi=!1,Sl=null}else throw Error(ce(198));Tl||(Tl=!0,Vu=c)}}function Ma(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function O1(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Fd(e){if(Ma(e)!==e)throw Error(ce(188))}function l2(e){var t=e.alternate;if(!t){if(t=Ma(e),t===null)throw Error(ce(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return Fd(a),e;if(s===n)return Fd(a),t;s=s.sibling}throw Error(ce(188))}if(r.return!==n.return)r=a,n=s;else{for(var i=!1,o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i){for(o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i)throw Error(ce(189))}}if(r.alternate!==n)throw Error(ce(190))}if(r.tag!==3)throw Error(ce(188));return r.stateNode.current===r?e:t}function P1(e){return e=l2(e),e!==null?R1(e):null}function R1(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=R1(e);if(t!==null)return t;e=e.sibling}return null}var D1=kr.unstable_scheduleCallback,Od=kr.unstable_cancelCallback,c2=kr.unstable_shouldYield,u2=kr.unstable_requestPaint,pt=kr.unstable_now,f2=kr.unstable_getCurrentPriorityLevel,ef=kr.unstable_ImmediatePriority,I1=kr.unstable_UserBlockingPriority,Al=kr.unstable_NormalPriority,d2=kr.unstable_LowPriority,j1=kr.unstable_IdlePriority,fc=null,sn=null;function h2(e){if(sn&&typeof sn.onCommitFiberRoot=="function")try{sn.onCommitFiberRoot(fc,e,void 0,(e.current.flags&128)===128)}catch{}}var Yr=Math.clz32?Math.clz32:m2,p2=Math.log,x2=Math.LN2;function m2(e){return e>>>=0,e===0?32:31-(p2(e)/x2|0)|0}var jo=64,Lo=4194304;function si(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Cl(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~a;o!==0?n=si(o):(s&=i,s!==0&&(n=si(s)))}else i=r&~a,i!==0?n=si(i):s!==0&&(n=si(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Yr(t),a=1<<r,n|=e[r],t&=~a;return n}function g2(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function v2(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-Yr(s),o=1<<i,l=a[i];l===-1?(!(o&r)||o&n)&&(a[i]=g2(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function Wu(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function L1(){var e=jo;return jo<<=1,!(jo&4194240)&&(jo=64),e}function Wc(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function oo(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Yr(t),e[t]=r}function w2(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Yr(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}function tf(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Yr(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var We=0;function M1(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var B1,rf,U1,$1,z1,Gu=!1,Mo=[],Kn=null,Xn=null,Yn=null,ji=new Map,Li=new Map,Bn=[],y2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Pd(e,t){switch(e){case"focusin":case"focusout":Kn=null;break;case"dragenter":case"dragleave":Xn=null;break;case"mouseover":case"mouseout":Yn=null;break;case"pointerover":case"pointerout":ji.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Li.delete(t.pointerId)}}function qs(e,t,r,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},t!==null&&(t=co(t),t!==null&&rf(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function _2(e,t,r,n,a){switch(t){case"focusin":return Kn=qs(Kn,e,t,r,n,a),!0;case"dragenter":return Xn=qs(Xn,e,t,r,n,a),!0;case"mouseover":return Yn=qs(Yn,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return ji.set(s,qs(ji.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,Li.set(s,qs(Li.get(s)||null,e,t,r,n,a)),!0}return!1}function H1(e){var t=_a(e.target);if(t!==null){var r=Ma(t);if(r!==null){if(t=r.tag,t===13){if(t=O1(r),t!==null){e.blockedOn=t,z1(e.priority,function(){U1(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function dl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Ku(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);$u=n,r.target.dispatchEvent(n),$u=null}else return t=co(r),t!==null&&rf(t),e.blockedOn=r,!1;t.shift()}return!0}function Rd(e,t,r){dl(e)&&r.delete(t)}function k2(){Gu=!1,Kn!==null&&dl(Kn)&&(Kn=null),Xn!==null&&dl(Xn)&&(Xn=null),Yn!==null&&dl(Yn)&&(Yn=null),ji.forEach(Rd),Li.forEach(Rd)}function Js(e,t){e.blockedOn===t&&(e.blockedOn=null,Gu||(Gu=!0,kr.unstable_scheduleCallback(kr.unstable_NormalPriority,k2)))}function Mi(e){function t(a){return Js(a,e)}if(0<Mo.length){Js(Mo[0],e);for(var r=1;r<Mo.length;r++){var n=Mo[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Kn!==null&&Js(Kn,e),Xn!==null&&Js(Xn,e),Yn!==null&&Js(Yn,e),ji.forEach(t),Li.forEach(t),r=0;r<Bn.length;r++)n=Bn[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Bn.length&&(r=Bn[0],r.blockedOn===null);)H1(r),r.blockedOn===null&&Bn.shift()}var vs=Fn.ReactCurrentBatchConfig,Nl=!0;function E2(e,t,r,n){var a=We,s=vs.transition;vs.transition=null;try{We=1,nf(e,t,r,n)}finally{We=a,vs.transition=s}}function S2(e,t,r,n){var a=We,s=vs.transition;vs.transition=null;try{We=4,nf(e,t,r,n)}finally{We=a,vs.transition=s}}function nf(e,t,r,n){if(Nl){var a=Ku(e,t,r,n);if(a===null)tu(e,t,n,bl,r),Pd(e,n);else if(_2(a,e,t,r,n))n.stopPropagation();else if(Pd(e,n),t&4&&-1<y2.indexOf(e)){for(;a!==null;){var s=co(a);if(s!==null&&B1(s),s=Ku(e,t,r,n),s===null&&tu(e,t,n,bl,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else tu(e,t,n,null,r)}}var bl=null;function Ku(e,t,r,n){if(bl=null,e=Z0(n),e=_a(e),e!==null)if(t=Ma(e),t===null)e=null;else if(r=t.tag,r===13){if(e=O1(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return bl=e,null}function V1(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(f2()){case ef:return 1;case I1:return 4;case Al:case d2:return 16;case j1:return 536870912;default:return 16}default:return 16}}var Hn=null,af=null,hl=null;function W1(){if(hl)return hl;var e,t=af,r=t.length,n,a="value"in Hn?Hn.value:Hn.textContent,s=a.length;for(e=0;e<r&&t[e]===a[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===a[s-n];n++);return hl=a.slice(e,1<n?1-n:void 0)}function pl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Bo(){return!0}function Dd(){return!1}function Tr(e){function t(r,n,a,s,i){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Bo:Dd,this.isPropagationStopped=Dd,this}return ot(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Bo)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Bo)},persist:function(){},isPersistent:Bo}),t}var Is={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sf=Tr(Is),lo=ot({},Is,{view:0,detail:0}),T2=Tr(lo),Gc,Kc,Qs,dc=ot({},lo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:of,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Qs&&(Qs&&e.type==="mousemove"?(Gc=e.screenX-Qs.screenX,Kc=e.screenY-Qs.screenY):Kc=Gc=0,Qs=e),Gc)},movementY:function(e){return"movementY"in e?e.movementY:Kc}}),Id=Tr(dc),A2=ot({},dc,{dataTransfer:0}),C2=Tr(A2),N2=ot({},lo,{relatedTarget:0}),Xc=Tr(N2),b2=ot({},Is,{animationName:0,elapsedTime:0,pseudoElement:0}),F2=Tr(b2),O2=ot({},Is,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),P2=Tr(O2),R2=ot({},Is,{data:0}),jd=Tr(R2),D2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},I2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},j2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function L2(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=j2[e])?!!t[e]:!1}function of(){return L2}var M2=ot({},lo,{key:function(e){if(e.key){var t=D2[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=pl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?I2[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:of,charCode:function(e){return e.type==="keypress"?pl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?pl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),B2=Tr(M2),U2=ot({},dc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ld=Tr(U2),$2=ot({},lo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:of}),z2=Tr($2),H2=ot({},Is,{propertyName:0,elapsedTime:0,pseudoElement:0}),V2=Tr(H2),W2=ot({},dc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),G2=Tr(W2),K2=[9,13,27,32],lf=Tn&&"CompositionEvent"in window,pi=null;Tn&&"documentMode"in document&&(pi=document.documentMode);var X2=Tn&&"TextEvent"in window&&!pi,G1=Tn&&(!lf||pi&&8<pi&&11>=pi),Md=" ",Bd=!1;function K1(e,t){switch(e){case"keyup":return K2.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function X1(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var as=!1;function Y2(e,t){switch(e){case"compositionend":return X1(t);case"keypress":return t.which!==32?null:(Bd=!0,Md);case"textInput":return e=t.data,e===Md&&Bd?null:e;default:return null}}function q2(e,t){if(as)return e==="compositionend"||!lf&&K1(e,t)?(e=W1(),hl=af=Hn=null,as=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return G1&&t.locale!=="ko"?null:t.data;default:return null}}var J2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ud(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!J2[e.type]:t==="textarea"}function Y1(e,t,r,n){A1(n),t=Fl(t,"onChange"),0<t.length&&(r=new sf("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var xi=null,Bi=null;function Q2(e){ix(e,0)}function hc(e){var t=os(e);if(w1(t))return e}function Z2(e,t){if(e==="change")return t}var q1=!1;if(Tn){var Yc;if(Tn){var qc="oninput"in document;if(!qc){var $d=document.createElement("div");$d.setAttribute("oninput","return;"),qc=typeof $d.oninput=="function"}Yc=qc}else Yc=!1;q1=Yc&&(!document.documentMode||9<document.documentMode)}function zd(){xi&&(xi.detachEvent("onpropertychange",J1),Bi=xi=null)}function J1(e){if(e.propertyName==="value"&&hc(Bi)){var t=[];Y1(t,Bi,e,Z0(e)),F1(Q2,t)}}function ew(e,t,r){e==="focusin"?(zd(),xi=t,Bi=r,xi.attachEvent("onpropertychange",J1)):e==="focusout"&&zd()}function tw(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return hc(Bi)}function rw(e,t){if(e==="click")return hc(t)}function nw(e,t){if(e==="input"||e==="change")return hc(t)}function aw(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Qr=typeof Object.is=="function"?Object.is:aw;function Ui(e,t){if(Qr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!bu.call(t,a)||!Qr(e[a],t[a]))return!1}return!0}function Hd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Vd(e,t){var r=Hd(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Hd(r)}}function Q1(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Q1(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Z1(){for(var e=window,t=El();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=El(e.document)}return t}function cf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function sw(e){var t=Z1(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Q1(r.ownerDocument.documentElement,r)){if(n!==null&&cf(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=Vd(r,s);var i=Vd(r,n);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var iw=Tn&&"documentMode"in document&&11>=document.documentMode,ss=null,Xu=null,mi=null,Yu=!1;function Wd(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Yu||ss==null||ss!==El(n)||(n=ss,"selectionStart"in n&&cf(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),mi&&Ui(mi,n)||(mi=n,n=Fl(Xu,"onSelect"),0<n.length&&(t=new sf("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=ss)))}function Uo(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var is={animationend:Uo("Animation","AnimationEnd"),animationiteration:Uo("Animation","AnimationIteration"),animationstart:Uo("Animation","AnimationStart"),transitionend:Uo("Transition","TransitionEnd")},Jc={},ex={};Tn&&(ex=document.createElement("div").style,"AnimationEvent"in window||(delete is.animationend.animation,delete is.animationiteration.animation,delete is.animationstart.animation),"TransitionEvent"in window||delete is.transitionend.transition);function pc(e){if(Jc[e])return Jc[e];if(!is[e])return e;var t=is[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in ex)return Jc[e]=t[r];return e}var tx=pc("animationend"),rx=pc("animationiteration"),nx=pc("animationstart"),ax=pc("transitionend"),sx=new Map,Gd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function oa(e,t){sx.set(e,t),La(t,[e])}for(var Qc=0;Qc<Gd.length;Qc++){var Zc=Gd[Qc],ow=Zc.toLowerCase(),lw=Zc[0].toUpperCase()+Zc.slice(1);oa(ow,"on"+lw)}oa(tx,"onAnimationEnd");oa(rx,"onAnimationIteration");oa(nx,"onAnimationStart");oa("dblclick","onDoubleClick");oa("focusin","onFocus");oa("focusout","onBlur");oa(ax,"onTransitionEnd");Ss("onMouseEnter",["mouseout","mouseover"]);Ss("onMouseLeave",["mouseout","mouseover"]);Ss("onPointerEnter",["pointerout","pointerover"]);Ss("onPointerLeave",["pointerout","pointerover"]);La("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));La("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));La("onBeforeInput",["compositionend","keypress","textInput","paste"]);La("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));La("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));La("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ii="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cw=new Set("cancel close invalid load scroll toggle".split(" ").concat(ii));function Kd(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,o2(n,t,void 0,e),e.currentTarget=null}function ix(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&a.isPropagationStopped())break e;Kd(a,o,c),s=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&a.isPropagationStopped())break e;Kd(a,o,c),s=l}}}if(Tl)throw e=Vu,Tl=!1,Vu=null,e}function Ze(e,t){var r=t[e0];r===void 0&&(r=t[e0]=new Set);var n=e+"__bubble";r.has(n)||(ox(t,e,2,!1),r.add(n))}function eu(e,t,r){var n=0;t&&(n|=4),ox(r,e,n,t)}var $o="_reactListening"+Math.random().toString(36).slice(2);function $i(e){if(!e[$o]){e[$o]=!0,p1.forEach(function(r){r!=="selectionchange"&&(cw.has(r)||eu(r,!1,e),eu(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[$o]||(t[$o]=!0,eu("selectionchange",!1,t))}}function ox(e,t,r,n){switch(V1(t)){case 1:var a=E2;break;case 4:a=S2;break;default:a=nf}r=a.bind(null,t,r,e),a=void 0,!Hu||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function tu(e,t,r,n,a){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;i=i.return}for(;o!==null;){if(i=_a(o),i===null)return;if(l=i.tag,l===5||l===6){n=s=i;continue e}o=o.parentNode}}n=n.return}F1(function(){var c=s,u=Z0(r),f=[];e:{var d=sx.get(e);if(d!==void 0){var p=sf,x=e;switch(e){case"keypress":if(pl(r)===0)break e;case"keydown":case"keyup":p=B2;break;case"focusin":x="focus",p=Xc;break;case"focusout":x="blur",p=Xc;break;case"beforeblur":case"afterblur":p=Xc;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Id;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=C2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=z2;break;case tx:case rx:case nx:p=F2;break;case ax:p=V2;break;case"scroll":p=T2;break;case"wheel":p=G2;break;case"copy":case"cut":case"paste":p=P2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Ld}var m=(t&4)!==0,v=!m&&e==="scroll",w=m?d!==null?d+"Capture":null:d;m=[];for(var y=c,g;y!==null;){g=y;var E=g.stateNode;if(g.tag===5&&E!==null&&(g=E,w!==null&&(E=Ii(y,w),E!=null&&m.push(zi(y,E,g)))),v)break;y=y.return}0<m.length&&(d=new p(d,x,null,r,u),f.push({event:d,listeners:m}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",d&&r!==$u&&(x=r.relatedTarget||r.fromElement)&&(_a(x)||x[An]))break e;if((p||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,p?(x=r.relatedTarget||r.toElement,p=c,x=x?_a(x):null,x!==null&&(v=Ma(x),x!==v||x.tag!==5&&x.tag!==6)&&(x=null)):(p=null,x=c),p!==x)){if(m=Id,E="onMouseLeave",w="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(m=Ld,E="onPointerLeave",w="onPointerEnter",y="pointer"),v=p==null?d:os(p),g=x==null?d:os(x),d=new m(E,y+"leave",p,r,u),d.target=v,d.relatedTarget=g,E=null,_a(u)===c&&(m=new m(w,y+"enter",x,r,u),m.target=g,m.relatedTarget=v,E=m),v=E,p&&x)t:{for(m=p,w=x,y=0,g=m;g;g=Ga(g))y++;for(g=0,E=w;E;E=Ga(E))g++;for(;0<y-g;)m=Ga(m),y--;for(;0<g-y;)w=Ga(w),g--;for(;y--;){if(m===w||w!==null&&m===w.alternate)break t;m=Ga(m),w=Ga(w)}m=null}else m=null;p!==null&&Xd(f,d,p,m,!1),x!==null&&v!==null&&Xd(f,v,x,m,!0)}}e:{if(d=c?os(c):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var P=Z2;else if(Ud(d))if(q1)P=nw;else{P=tw;var T=ew}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(P=rw);if(P&&(P=P(e,c))){Y1(f,P,r,u);break e}T&&T(e,d,c),e==="focusout"&&(T=d._wrapperState)&&T.controlled&&d.type==="number"&&ju(d,"number",d.value)}switch(T=c?os(c):window,e){case"focusin":(Ud(T)||T.contentEditable==="true")&&(ss=T,Xu=c,mi=null);break;case"focusout":mi=Xu=ss=null;break;case"mousedown":Yu=!0;break;case"contextmenu":case"mouseup":case"dragend":Yu=!1,Wd(f,r,u);break;case"selectionchange":if(iw)break;case"keydown":case"keyup":Wd(f,r,u)}var k;if(lf)e:{switch(e){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else as?K1(e,r)&&(I="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(I="onCompositionStart");I&&(G1&&r.locale!=="ko"&&(as||I!=="onCompositionStart"?I==="onCompositionEnd"&&as&&(k=W1()):(Hn=u,af="value"in Hn?Hn.value:Hn.textContent,as=!0)),T=Fl(c,I),0<T.length&&(I=new jd(I,e,null,r,u),f.push({event:I,listeners:T}),k?I.data=k:(k=X1(r),k!==null&&(I.data=k)))),(k=X2?Y2(e,r):q2(e,r))&&(c=Fl(c,"onBeforeInput"),0<c.length&&(u=new jd("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:c}),u.data=k))}ix(f,t)})}function zi(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Fl(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=Ii(e,r),s!=null&&n.unshift(zi(e,s,a)),s=Ii(e,t),s!=null&&n.push(zi(e,s,a))),e=e.return}return n}function Ga(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Xd(e,t,r,n,a){for(var s=t._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,a?(l=Ii(r,s),l!=null&&i.unshift(zi(r,l,o))):a||(l=Ii(r,s),l!=null&&i.push(zi(r,l,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var uw=/\r\n?/g,fw=/\u0000|\uFFFD/g;function Yd(e){return(typeof e=="string"?e:""+e).replace(uw,`
`).replace(fw,"")}function zo(e,t,r){if(t=Yd(t),Yd(e)!==t&&r)throw Error(ce(425))}function Ol(){}var qu=null,Ju=null;function Qu(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Zu=typeof setTimeout=="function"?setTimeout:void 0,dw=typeof clearTimeout=="function"?clearTimeout:void 0,qd=typeof Promise=="function"?Promise:void 0,hw=typeof queueMicrotask=="function"?queueMicrotask:typeof qd<"u"?function(e){return qd.resolve(null).then(e).catch(pw)}:Zu;function pw(e){setTimeout(function(){throw e})}function ru(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Mi(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Mi(t)}function qn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Jd(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var js=Math.random().toString(36).slice(2),an="__reactFiber$"+js,Hi="__reactProps$"+js,An="__reactContainer$"+js,e0="__reactEvents$"+js,xw="__reactListeners$"+js,mw="__reactHandles$"+js;function _a(e){var t=e[an];if(t)return t;for(var r=e.parentNode;r;){if(t=r[An]||r[an]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Jd(e);e!==null;){if(r=e[an])return r;e=Jd(e)}return t}e=r,r=e.parentNode}return null}function co(e){return e=e[an]||e[An],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function os(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ce(33))}function xc(e){return e[Hi]||null}var t0=[],ls=-1;function la(e){return{current:e}}function et(e){0>ls||(e.current=t0[ls],t0[ls]=null,ls--)}function qe(e,t){ls++,t0[ls]=e.current,e.current=t}var aa={},Yt=la(aa),pr=la(!1),ba=aa;function Ts(e,t){var r=e.type.contextTypes;if(!r)return aa;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function xr(e){return e=e.childContextTypes,e!=null}function Pl(){et(pr),et(Yt)}function Qd(e,t,r){if(Yt.current!==aa)throw Error(ce(168));qe(Yt,t),qe(pr,r)}function lx(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(ce(108,e2(e)||"Unknown",a));return ot({},r,n)}function Rl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||aa,ba=Yt.current,qe(Yt,e),qe(pr,pr.current),!0}function Zd(e,t,r){var n=e.stateNode;if(!n)throw Error(ce(169));r?(e=lx(e,t,ba),n.__reactInternalMemoizedMergedChildContext=e,et(pr),et(Yt),qe(Yt,e)):et(pr),qe(pr,r)}var vn=null,mc=!1,nu=!1;function cx(e){vn===null?vn=[e]:vn.push(e)}function gw(e){mc=!0,cx(e)}function ca(){if(!nu&&vn!==null){nu=!0;var e=0,t=We;try{var r=vn;for(We=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}vn=null,mc=!1}catch(a){throw vn!==null&&(vn=vn.slice(e+1)),D1(ef,ca),a}finally{We=t,nu=!1}}return null}var cs=[],us=0,Dl=null,Il=0,br=[],Fr=0,Fa=null,wn=1,yn="";function ma(e,t){cs[us++]=Il,cs[us++]=Dl,Dl=e,Il=t}function ux(e,t,r){br[Fr++]=wn,br[Fr++]=yn,br[Fr++]=Fa,Fa=e;var n=wn;e=yn;var a=32-Yr(n)-1;n&=~(1<<a),r+=1;var s=32-Yr(t)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,wn=1<<32-Yr(t)+a|r<<a|n,yn=s+e}else wn=1<<s|r<<a|n,yn=e}function uf(e){e.return!==null&&(ma(e,1),ux(e,1,0))}function ff(e){for(;e===Dl;)Dl=cs[--us],cs[us]=null,Il=cs[--us],cs[us]=null;for(;e===Fa;)Fa=br[--Fr],br[Fr]=null,yn=br[--Fr],br[Fr]=null,wn=br[--Fr],br[Fr]=null}var _r=null,yr=null,rt=!1,Wr=null;function fx(e,t){var r=Or(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function eh(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,_r=e,yr=qn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,_r=e,yr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Fa!==null?{id:wn,overflow:yn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Or(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,_r=e,yr=null,!0):!1;default:return!1}}function r0(e){return(e.mode&1)!==0&&(e.flags&128)===0}function n0(e){if(rt){var t=yr;if(t){var r=t;if(!eh(e,t)){if(r0(e))throw Error(ce(418));t=qn(r.nextSibling);var n=_r;t&&eh(e,t)?fx(n,r):(e.flags=e.flags&-4097|2,rt=!1,_r=e)}}else{if(r0(e))throw Error(ce(418));e.flags=e.flags&-4097|2,rt=!1,_r=e}}}function th(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;_r=e}function Ho(e){if(e!==_r)return!1;if(!rt)return th(e),rt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Qu(e.type,e.memoizedProps)),t&&(t=yr)){if(r0(e))throw dx(),Error(ce(418));for(;t;)fx(e,t),t=qn(t.nextSibling)}if(th(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ce(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){yr=qn(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}yr=null}}else yr=_r?qn(e.stateNode.nextSibling):null;return!0}function dx(){for(var e=yr;e;)e=qn(e.nextSibling)}function As(){yr=_r=null,rt=!1}function df(e){Wr===null?Wr=[e]:Wr.push(e)}var vw=Fn.ReactCurrentBatchConfig;function Zs(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ce(309));var n=r.stateNode}if(!n)throw Error(ce(147,e));var a=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(i){var o=a.refs;i===null?delete o[s]:o[s]=i},t._stringRef=s,t)}if(typeof e!="string")throw Error(ce(284));if(!r._owner)throw Error(ce(290,e))}return e}function Vo(e,t){throw e=Object.prototype.toString.call(t),Error(ce(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function rh(e){var t=e._init;return t(e._payload)}function hx(e){function t(w,y){if(e){var g=w.deletions;g===null?(w.deletions=[y],w.flags|=16):g.push(y)}}function r(w,y){if(!e)return null;for(;y!==null;)t(w,y),y=y.sibling;return null}function n(w,y){for(w=new Map;y!==null;)y.key!==null?w.set(y.key,y):w.set(y.index,y),y=y.sibling;return w}function a(w,y){return w=ea(w,y),w.index=0,w.sibling=null,w}function s(w,y,g){return w.index=g,e?(g=w.alternate,g!==null?(g=g.index,g<y?(w.flags|=2,y):g):(w.flags|=2,y)):(w.flags|=1048576,y)}function i(w){return e&&w.alternate===null&&(w.flags|=2),w}function o(w,y,g,E){return y===null||y.tag!==6?(y=uu(g,w.mode,E),y.return=w,y):(y=a(y,g),y.return=w,y)}function l(w,y,g,E){var P=g.type;return P===ns?u(w,y,g.props.children,E,g.key):y!==null&&(y.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Ln&&rh(P)===y.type)?(E=a(y,g.props),E.ref=Zs(w,y,g),E.return=w,E):(E=_l(g.type,g.key,g.props,null,w.mode,E),E.ref=Zs(w,y,g),E.return=w,E)}function c(w,y,g,E){return y===null||y.tag!==4||y.stateNode.containerInfo!==g.containerInfo||y.stateNode.implementation!==g.implementation?(y=fu(g,w.mode,E),y.return=w,y):(y=a(y,g.children||[]),y.return=w,y)}function u(w,y,g,E,P){return y===null||y.tag!==7?(y=Aa(g,w.mode,E,P),y.return=w,y):(y=a(y,g),y.return=w,y)}function f(w,y,g){if(typeof y=="string"&&y!==""||typeof y=="number")return y=uu(""+y,w.mode,g),y.return=w,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ro:return g=_l(y.type,y.key,y.props,null,w.mode,g),g.ref=Zs(w,null,y),g.return=w,g;case rs:return y=fu(y,w.mode,g),y.return=w,y;case Ln:var E=y._init;return f(w,E(y._payload),g)}if(ai(y)||Xs(y))return y=Aa(y,w.mode,g,null),y.return=w,y;Vo(w,y)}return null}function d(w,y,g,E){var P=y!==null?y.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return P!==null?null:o(w,y,""+g,E);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Ro:return g.key===P?l(w,y,g,E):null;case rs:return g.key===P?c(w,y,g,E):null;case Ln:return P=g._init,d(w,y,P(g._payload),E)}if(ai(g)||Xs(g))return P!==null?null:u(w,y,g,E,null);Vo(w,g)}return null}function p(w,y,g,E,P){if(typeof E=="string"&&E!==""||typeof E=="number")return w=w.get(g)||null,o(y,w,""+E,P);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Ro:return w=w.get(E.key===null?g:E.key)||null,l(y,w,E,P);case rs:return w=w.get(E.key===null?g:E.key)||null,c(y,w,E,P);case Ln:var T=E._init;return p(w,y,g,T(E._payload),P)}if(ai(E)||Xs(E))return w=w.get(g)||null,u(y,w,E,P,null);Vo(y,E)}return null}function x(w,y,g,E){for(var P=null,T=null,k=y,I=y=0,R=null;k!==null&&I<g.length;I++){k.index>I?(R=k,k=null):R=k.sibling;var U=d(w,k,g[I],E);if(U===null){k===null&&(k=R);break}e&&k&&U.alternate===null&&t(w,k),y=s(U,y,I),T===null?P=U:T.sibling=U,T=U,k=R}if(I===g.length)return r(w,k),rt&&ma(w,I),P;if(k===null){for(;I<g.length;I++)k=f(w,g[I],E),k!==null&&(y=s(k,y,I),T===null?P=k:T.sibling=k,T=k);return rt&&ma(w,I),P}for(k=n(w,k);I<g.length;I++)R=p(k,w,I,g[I],E),R!==null&&(e&&R.alternate!==null&&k.delete(R.key===null?I:R.key),y=s(R,y,I),T===null?P=R:T.sibling=R,T=R);return e&&k.forEach(function(z){return t(w,z)}),rt&&ma(w,I),P}function m(w,y,g,E){var P=Xs(g);if(typeof P!="function")throw Error(ce(150));if(g=P.call(g),g==null)throw Error(ce(151));for(var T=P=null,k=y,I=y=0,R=null,U=g.next();k!==null&&!U.done;I++,U=g.next()){k.index>I?(R=k,k=null):R=k.sibling;var z=d(w,k,U.value,E);if(z===null){k===null&&(k=R);break}e&&k&&z.alternate===null&&t(w,k),y=s(z,y,I),T===null?P=z:T.sibling=z,T=z,k=R}if(U.done)return r(w,k),rt&&ma(w,I),P;if(k===null){for(;!U.done;I++,U=g.next())U=f(w,U.value,E),U!==null&&(y=s(U,y,I),T===null?P=U:T.sibling=U,T=U);return rt&&ma(w,I),P}for(k=n(w,k);!U.done;I++,U=g.next())U=p(k,w,I,U.value,E),U!==null&&(e&&U.alternate!==null&&k.delete(U.key===null?I:U.key),y=s(U,y,I),T===null?P=U:T.sibling=U,T=U);return e&&k.forEach(function(B){return t(w,B)}),rt&&ma(w,I),P}function v(w,y,g,E){if(typeof g=="object"&&g!==null&&g.type===ns&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case Ro:e:{for(var P=g.key,T=y;T!==null;){if(T.key===P){if(P=g.type,P===ns){if(T.tag===7){r(w,T.sibling),y=a(T,g.props.children),y.return=w,w=y;break e}}else if(T.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Ln&&rh(P)===T.type){r(w,T.sibling),y=a(T,g.props),y.ref=Zs(w,T,g),y.return=w,w=y;break e}r(w,T);break}else t(w,T);T=T.sibling}g.type===ns?(y=Aa(g.props.children,w.mode,E,g.key),y.return=w,w=y):(E=_l(g.type,g.key,g.props,null,w.mode,E),E.ref=Zs(w,y,g),E.return=w,w=E)}return i(w);case rs:e:{for(T=g.key;y!==null;){if(y.key===T)if(y.tag===4&&y.stateNode.containerInfo===g.containerInfo&&y.stateNode.implementation===g.implementation){r(w,y.sibling),y=a(y,g.children||[]),y.return=w,w=y;break e}else{r(w,y);break}else t(w,y);y=y.sibling}y=fu(g,w.mode,E),y.return=w,w=y}return i(w);case Ln:return T=g._init,v(w,y,T(g._payload),E)}if(ai(g))return x(w,y,g,E);if(Xs(g))return m(w,y,g,E);Vo(w,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,y!==null&&y.tag===6?(r(w,y.sibling),y=a(y,g),y.return=w,w=y):(r(w,y),y=uu(g,w.mode,E),y.return=w,w=y),i(w)):r(w,y)}return v}var Cs=hx(!0),px=hx(!1),jl=la(null),Ll=null,fs=null,hf=null;function pf(){hf=fs=Ll=null}function xf(e){var t=jl.current;et(jl),e._currentValue=t}function a0(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function ws(e,t){Ll=e,hf=fs=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(hr=!0),e.firstContext=null)}function Dr(e){var t=e._currentValue;if(hf!==e)if(e={context:e,memoizedValue:t,next:null},fs===null){if(Ll===null)throw Error(ce(308));fs=e,Ll.dependencies={lanes:0,firstContext:e}}else fs=fs.next=e;return t}var ka=null;function mf(e){ka===null?ka=[e]:ka.push(e)}function xx(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,mf(t)):(r.next=a.next,a.next=r),t.interleaved=r,Cn(e,n)}function Cn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Mn=!1;function gf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function mx(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function kn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Jn(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,ze&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Cn(e,r)}return a=n.interleaved,a===null?(t.next=t,mf(n)):(t.next=a.next,a.next=t),n.interleaved=t,Cn(e,r)}function xl(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,tf(e,r)}}function nh(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=i:s=s.next=i,r=r.next}while(r!==null);s===null?a=s=t:s=s.next=t}else a=s=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Ml(e,t,r,n){var a=e.updateQueue;Mn=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,c=l.next;l.next=null,i===null?s=c:i.next=c,i=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==i&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(s!==null){var f=a.baseState;i=0,u=c=l=null,o=s;do{var d=o.lane,p=o.eventTime;if((n&d)===d){u!==null&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=e,m=o;switch(d=t,p=r,m.tag){case 1:if(x=m.payload,typeof x=="function"){f=x.call(p,f,d);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=m.payload,d=typeof x=="function"?x.call(p,f,d):x,d==null)break e;f=ot({},f,d);break e;case 2:Mn=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,d=a.effects,d===null?a.effects=[o]:d.push(o))}else p={eventTime:p,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=p,l=f):u=u.next=p,i|=d;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;d=o,o=d.next,d.next=null,a.lastBaseUpdate=d,a.shared.pending=null}}while(!0);if(u===null&&(l=f),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);Pa|=i,e.lanes=i,e.memoizedState=f}}function ah(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(ce(191,a));a.call(n)}}}var uo={},on=la(uo),Vi=la(uo),Wi=la(uo);function Ea(e){if(e===uo)throw Error(ce(174));return e}function vf(e,t){switch(qe(Wi,t),qe(Vi,e),qe(on,uo),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Mu(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Mu(t,e)}et(on),qe(on,t)}function Ns(){et(on),et(Vi),et(Wi)}function gx(e){Ea(Wi.current);var t=Ea(on.current),r=Mu(t,e.type);t!==r&&(qe(Vi,e),qe(on,r))}function wf(e){Vi.current===e&&(et(on),et(Vi))}var st=la(0);function Bl(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var au=[];function yf(){for(var e=0;e<au.length;e++)au[e]._workInProgressVersionPrimary=null;au.length=0}var ml=Fn.ReactCurrentDispatcher,su=Fn.ReactCurrentBatchConfig,Oa=0,it=null,Et=null,Ft=null,Ul=!1,gi=!1,Gi=0,ww=0;function $t(){throw Error(ce(321))}function _f(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Qr(e[r],t[r]))return!1;return!0}function kf(e,t,r,n,a,s){if(Oa=s,it=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ml.current=e===null||e.memoizedState===null?Ew:Sw,e=r(n,a),gi){s=0;do{if(gi=!1,Gi=0,25<=s)throw Error(ce(301));s+=1,Ft=Et=null,t.updateQueue=null,ml.current=Tw,e=r(n,a)}while(gi)}if(ml.current=$l,t=Et!==null&&Et.next!==null,Oa=0,Ft=Et=it=null,Ul=!1,t)throw Error(ce(300));return e}function Ef(){var e=Gi!==0;return Gi=0,e}function rn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ft===null?it.memoizedState=Ft=e:Ft=Ft.next=e,Ft}function Ir(){if(Et===null){var e=it.alternate;e=e!==null?e.memoizedState:null}else e=Et.next;var t=Ft===null?it.memoizedState:Ft.next;if(t!==null)Ft=t,Et=e;else{if(e===null)throw Error(ce(310));Et=e,e={memoizedState:Et.memoizedState,baseState:Et.baseState,baseQueue:Et.baseQueue,queue:Et.queue,next:null},Ft===null?it.memoizedState=Ft=e:Ft=Ft.next=e}return Ft}function Ki(e,t){return typeof t=="function"?t(e):t}function iu(e){var t=Ir(),r=t.queue;if(r===null)throw Error(ce(311));r.lastRenderedReducer=e;var n=Et,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var i=a.next;a.next=s.next,s.next=i}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var o=i=null,l=null,c=s;do{var u=c.lane;if((Oa&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var f={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=f,i=n):l=l.next=f,it.lanes|=u,Pa|=u}c=c.next}while(c!==null&&c!==s);l===null?i=n:l.next=o,Qr(n,t.memoizedState)||(hr=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do s=a.lane,it.lanes|=s,Pa|=s,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function ou(e){var t=Ir(),r=t.queue;if(r===null)throw Error(ce(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(a!==null){r.pending=null;var i=a=a.next;do s=e(s,i.action),i=i.next;while(i!==a);Qr(s,t.memoizedState)||(hr=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function vx(){}function wx(e,t){var r=it,n=Ir(),a=t(),s=!Qr(n.memoizedState,a);if(s&&(n.memoizedState=a,hr=!0),n=n.queue,Sf(kx.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Ft!==null&&Ft.memoizedState.tag&1){if(r.flags|=2048,Xi(9,_x.bind(null,r,n,a,t),void 0,null),Ot===null)throw Error(ce(349));Oa&30||yx(r,t,a)}return a}function yx(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=it.updateQueue,t===null?(t={lastEffect:null,stores:null},it.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function _x(e,t,r,n){t.value=r,t.getSnapshot=n,Ex(t)&&Sx(e)}function kx(e,t,r){return r(function(){Ex(t)&&Sx(e)})}function Ex(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Qr(e,r)}catch{return!0}}function Sx(e){var t=Cn(e,1);t!==null&&qr(t,e,1,-1)}function sh(e){var t=rn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ki,lastRenderedState:e},t.queue=e,e=e.dispatch=kw.bind(null,it,e),[t.memoizedState,e]}function Xi(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=it.updateQueue,t===null?(t={lastEffect:null,stores:null},it.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Tx(){return Ir().memoizedState}function gl(e,t,r,n){var a=rn();it.flags|=e,a.memoizedState=Xi(1|t,r,void 0,n===void 0?null:n)}function gc(e,t,r,n){var a=Ir();n=n===void 0?null:n;var s=void 0;if(Et!==null){var i=Et.memoizedState;if(s=i.destroy,n!==null&&_f(n,i.deps)){a.memoizedState=Xi(t,r,s,n);return}}it.flags|=e,a.memoizedState=Xi(1|t,r,s,n)}function ih(e,t){return gl(8390656,8,e,t)}function Sf(e,t){return gc(2048,8,e,t)}function Ax(e,t){return gc(4,2,e,t)}function Cx(e,t){return gc(4,4,e,t)}function Nx(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function bx(e,t,r){return r=r!=null?r.concat([e]):null,gc(4,4,Nx.bind(null,t,e),r)}function Tf(){}function Fx(e,t){var r=Ir();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&_f(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Ox(e,t){var r=Ir();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&_f(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Px(e,t,r){return Oa&21?(Qr(r,t)||(r=L1(),it.lanes|=r,Pa|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,hr=!0),e.memoizedState=r)}function yw(e,t){var r=We;We=r!==0&&4>r?r:4,e(!0);var n=su.transition;su.transition={};try{e(!1),t()}finally{We=r,su.transition=n}}function Rx(){return Ir().memoizedState}function _w(e,t,r){var n=Zn(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Dx(e))Ix(t,r);else if(r=xx(e,t,r,n),r!==null){var a=sr();qr(r,e,n,a),jx(r,t,n)}}function kw(e,t,r){var n=Zn(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Dx(e))Ix(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var i=t.lastRenderedState,o=s(i,r);if(a.hasEagerState=!0,a.eagerState=o,Qr(o,i)){var l=t.interleaved;l===null?(a.next=a,mf(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=xx(e,t,a,n),r!==null&&(a=sr(),qr(r,e,n,a),jx(r,t,n))}}function Dx(e){var t=e.alternate;return e===it||t!==null&&t===it}function Ix(e,t){gi=Ul=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function jx(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,tf(e,r)}}var $l={readContext:Dr,useCallback:$t,useContext:$t,useEffect:$t,useImperativeHandle:$t,useInsertionEffect:$t,useLayoutEffect:$t,useMemo:$t,useReducer:$t,useRef:$t,useState:$t,useDebugValue:$t,useDeferredValue:$t,useTransition:$t,useMutableSource:$t,useSyncExternalStore:$t,useId:$t,unstable_isNewReconciler:!1},Ew={readContext:Dr,useCallback:function(e,t){return rn().memoizedState=[e,t===void 0?null:t],e},useContext:Dr,useEffect:ih,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,gl(4194308,4,Nx.bind(null,t,e),r)},useLayoutEffect:function(e,t){return gl(4194308,4,e,t)},useInsertionEffect:function(e,t){return gl(4,2,e,t)},useMemo:function(e,t){var r=rn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=rn();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=_w.bind(null,it,e),[n.memoizedState,e]},useRef:function(e){var t=rn();return e={current:e},t.memoizedState=e},useState:sh,useDebugValue:Tf,useDeferredValue:function(e){return rn().memoizedState=e},useTransition:function(){var e=sh(!1),t=e[0];return e=yw.bind(null,e[1]),rn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=it,a=rn();if(rt){if(r===void 0)throw Error(ce(407));r=r()}else{if(r=t(),Ot===null)throw Error(ce(349));Oa&30||yx(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,ih(kx.bind(null,n,s,e),[e]),n.flags|=2048,Xi(9,_x.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=rn(),t=Ot.identifierPrefix;if(rt){var r=yn,n=wn;r=(n&~(1<<32-Yr(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Gi++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=ww++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Sw={readContext:Dr,useCallback:Fx,useContext:Dr,useEffect:Sf,useImperativeHandle:bx,useInsertionEffect:Ax,useLayoutEffect:Cx,useMemo:Ox,useReducer:iu,useRef:Tx,useState:function(){return iu(Ki)},useDebugValue:Tf,useDeferredValue:function(e){var t=Ir();return Px(t,Et.memoizedState,e)},useTransition:function(){var e=iu(Ki)[0],t=Ir().memoizedState;return[e,t]},useMutableSource:vx,useSyncExternalStore:wx,useId:Rx,unstable_isNewReconciler:!1},Tw={readContext:Dr,useCallback:Fx,useContext:Dr,useEffect:Sf,useImperativeHandle:bx,useInsertionEffect:Ax,useLayoutEffect:Cx,useMemo:Ox,useReducer:ou,useRef:Tx,useState:function(){return ou(Ki)},useDebugValue:Tf,useDeferredValue:function(e){var t=Ir();return Et===null?t.memoizedState=e:Px(t,Et.memoizedState,e)},useTransition:function(){var e=ou(Ki)[0],t=Ir().memoizedState;return[e,t]},useMutableSource:vx,useSyncExternalStore:wx,useId:Rx,unstable_isNewReconciler:!1};function zr(e,t){if(e&&e.defaultProps){t=ot({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function s0(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:ot({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var vc={isMounted:function(e){return(e=e._reactInternals)?Ma(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=sr(),a=Zn(e),s=kn(n,a);s.payload=t,r!=null&&(s.callback=r),t=Jn(e,s,a),t!==null&&(qr(t,e,a,n),xl(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=sr(),a=Zn(e),s=kn(n,a);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Jn(e,s,a),t!==null&&(qr(t,e,a,n),xl(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=sr(),n=Zn(e),a=kn(r,n);a.tag=2,t!=null&&(a.callback=t),t=Jn(e,a,n),t!==null&&(qr(t,e,n,r),xl(t,e,n))}};function oh(e,t,r,n,a,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,i):t.prototype&&t.prototype.isPureReactComponent?!Ui(r,n)||!Ui(a,s):!0}function Lx(e,t,r){var n=!1,a=aa,s=t.contextType;return typeof s=="object"&&s!==null?s=Dr(s):(a=xr(t)?ba:Yt.current,n=t.contextTypes,s=(n=n!=null)?Ts(e,a):aa),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=vc,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function lh(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&vc.enqueueReplaceState(t,t.state,null)}function i0(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},gf(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=Dr(s):(s=xr(t)?ba:Yt.current,a.context=Ts(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(s0(e,t,s,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&vc.enqueueReplaceState(a,a.state,null),Ml(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function bs(e,t){try{var r="",n=t;do r+=Zv(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function lu(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function o0(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Aw=typeof WeakMap=="function"?WeakMap:Map;function Mx(e,t,r){r=kn(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Hl||(Hl=!0,g0=n),o0(e,t)},r}function Bx(e,t,r){r=kn(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){o0(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){o0(e,t),typeof n!="function"&&(Qn===null?Qn=new Set([this]):Qn.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function ch(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Aw;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=Uw.bind(null,e,t,r),t.then(e,e))}function uh(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function fh(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=kn(-1,1),t.tag=2,Jn(r,t,1))),r.lanes|=1),e)}var Cw=Fn.ReactCurrentOwner,hr=!1;function tr(e,t,r,n){t.child=e===null?px(t,null,r,n):Cs(t,e.child,r,n)}function dh(e,t,r,n,a){r=r.render;var s=t.ref;return ws(t,a),n=kf(e,t,r,n,s,a),r=Ef(),e!==null&&!hr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Nn(e,t,a)):(rt&&r&&uf(t),t.flags|=1,tr(e,t,n,a),t.child)}function hh(e,t,r,n,a){if(e===null){var s=r.type;return typeof s=="function"&&!Rf(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,Ux(e,t,s,n,a)):(e=_l(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var i=s.memoizedProps;if(r=r.compare,r=r!==null?r:Ui,r(i,n)&&e.ref===t.ref)return Nn(e,t,a)}return t.flags|=1,e=ea(s,n),e.ref=t.ref,e.return=t,t.child=e}function Ux(e,t,r,n,a){if(e!==null){var s=e.memoizedProps;if(Ui(s,n)&&e.ref===t.ref)if(hr=!1,t.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(hr=!0);else return t.lanes=e.lanes,Nn(e,t,a)}return l0(e,t,r,n,a)}function $x(e,t,r){var n=t.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},qe(hs,gr),gr|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,qe(hs,gr),gr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,qe(hs,gr),gr|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,qe(hs,gr),gr|=n;return tr(e,t,a,r),t.child}function zx(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function l0(e,t,r,n,a){var s=xr(r)?ba:Yt.current;return s=Ts(t,s),ws(t,a),r=kf(e,t,r,n,s,a),n=Ef(),e!==null&&!hr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Nn(e,t,a)):(rt&&n&&uf(t),t.flags|=1,tr(e,t,r,a),t.child)}function ph(e,t,r,n,a){if(xr(r)){var s=!0;Rl(t)}else s=!1;if(ws(t,a),t.stateNode===null)vl(e,t),Lx(t,r,n),i0(t,r,n,a),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=r.contextType;typeof c=="object"&&c!==null?c=Dr(c):(c=xr(r)?ba:Yt.current,c=Ts(t,c));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";f||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==c)&&lh(t,i,n,c),Mn=!1;var d=t.memoizedState;i.state=d,Ml(t,n,i,a),l=t.memoizedState,o!==n||d!==l||pr.current||Mn?(typeof u=="function"&&(s0(t,r,u,n),l=t.memoizedState),(o=Mn||oh(t,r,o,n,d,l,c))?(f||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,mx(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:zr(t.type,o),i.props=c,f=t.pendingProps,d=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=Dr(l):(l=xr(r)?ba:Yt.current,l=Ts(t,l));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==f||d!==l)&&lh(t,i,n,l),Mn=!1,d=t.memoizedState,i.state=d,Ml(t,n,i,a);var x=t.memoizedState;o!==f||d!==x||pr.current||Mn?(typeof p=="function"&&(s0(t,r,p,n),x=t.memoizedState),(c=Mn||oh(t,r,c,n,d,x,l)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,x,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,x,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),i.props=n,i.state=x,i.context=l,n=c):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return c0(e,t,r,n,s,a)}function c0(e,t,r,n,a,s){zx(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return a&&Zd(t,r,!1),Nn(e,t,s);n=t.stateNode,Cw.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=Cs(t,e.child,null,s),t.child=Cs(t,null,o,s)):tr(e,t,o,s),t.memoizedState=n.state,a&&Zd(t,r,!0),t.child}function Hx(e){var t=e.stateNode;t.pendingContext?Qd(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Qd(e,t.context,!1),vf(e,t.containerInfo)}function xh(e,t,r,n,a){return As(),df(a),t.flags|=256,tr(e,t,r,n),t.child}var u0={dehydrated:null,treeContext:null,retryLane:0};function f0(e){return{baseLanes:e,cachePool:null,transitions:null}}function Vx(e,t,r){var n=t.pendingProps,a=st.current,s=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),qe(st,a&1),e===null)return n0(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,s?(n=t.mode,s=t.child,i={mode:"hidden",children:i},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=_c(i,n,0,null),e=Aa(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=f0(r),t.memoizedState=u0,e):Af(t,i));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return Nw(e,t,i,n,o,a,r);if(s){s=n.fallback,i=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=ea(a,l),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?s=ea(o,s):(s=Aa(s,i,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,i=e.child.memoizedState,i=i===null?f0(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~r,t.memoizedState=u0,n}return s=e.child,e=s.sibling,n=ea(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Af(e,t){return t=_c({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Wo(e,t,r,n){return n!==null&&df(n),Cs(t,e.child,null,r),e=Af(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Nw(e,t,r,n,a,s,i){if(r)return t.flags&256?(t.flags&=-257,n=lu(Error(ce(422))),Wo(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=_c({mode:"visible",children:n.children},a,0,null),s=Aa(s,a,i,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Cs(t,e.child,null,i),t.child.memoizedState=f0(i),t.memoizedState=u0,s);if(!(t.mode&1))return Wo(e,t,i,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(ce(419)),n=lu(s,n,void 0),Wo(e,t,i,n)}if(o=(i&e.childLanes)!==0,hr||o){if(n=Ot,n!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|i)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,Cn(e,a),qr(n,e,a,-1))}return Pf(),n=lu(Error(ce(421))),Wo(e,t,i,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=$w.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,yr=qn(a.nextSibling),_r=t,rt=!0,Wr=null,e!==null&&(br[Fr++]=wn,br[Fr++]=yn,br[Fr++]=Fa,wn=e.id,yn=e.overflow,Fa=t),t=Af(t,n.children),t.flags|=4096,t)}function mh(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),a0(e.return,t,r)}function cu(e,t,r,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function Wx(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if(tr(e,t,n.children,r),n=st.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&mh(e,r,t);else if(e.tag===19)mh(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(qe(st,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Bl(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),cu(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Bl(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}cu(t,!0,r,null,s);break;case"together":cu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function vl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Nn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Pa|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ce(153));if(t.child!==null){for(e=t.child,r=ea(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ea(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function bw(e,t,r){switch(t.tag){case 3:Hx(t),As();break;case 5:gx(t);break;case 1:xr(t.type)&&Rl(t);break;case 4:vf(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;qe(jl,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(qe(st,st.current&1),t.flags|=128,null):r&t.child.childLanes?Vx(e,t,r):(qe(st,st.current&1),e=Nn(e,t,r),e!==null?e.sibling:null);qe(st,st.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Wx(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),qe(st,st.current),n)break;return null;case 22:case 23:return t.lanes=0,$x(e,t,r)}return Nn(e,t,r)}var Gx,d0,Kx,Xx;Gx=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};d0=function(){};Kx=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Ea(on.current);var s=null;switch(r){case"input":a=Du(e,a),n=Du(e,n),s=[];break;case"select":a=ot({},a,{value:void 0}),n=ot({},n,{value:void 0}),s=[];break;case"textarea":a=Lu(e,a),n=Lu(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Ol)}Bu(r,n);var i;r=null;for(c in a)if(!n.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Ri.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=a!=null?a[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Ri.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ze("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};Xx=function(e,t,r,n){r!==n&&(t.flags|=4)};function ei(e,t){if(!rt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function zt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Fw(e,t,r){var n=t.pendingProps;switch(ff(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zt(t),null;case 1:return xr(t.type)&&Pl(),zt(t),null;case 3:return n=t.stateNode,Ns(),et(pr),et(Yt),yf(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Ho(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Wr!==null&&(y0(Wr),Wr=null))),d0(e,t),zt(t),null;case 5:wf(t);var a=Ea(Wi.current);if(r=t.type,e!==null&&t.stateNode!=null)Kx(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ce(166));return zt(t),null}if(e=Ea(on.current),Ho(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[an]=t,n[Hi]=s,e=(t.mode&1)!==0,r){case"dialog":Ze("cancel",n),Ze("close",n);break;case"iframe":case"object":case"embed":Ze("load",n);break;case"video":case"audio":for(a=0;a<ii.length;a++)Ze(ii[a],n);break;case"source":Ze("error",n);break;case"img":case"image":case"link":Ze("error",n),Ze("load",n);break;case"details":Ze("toggle",n);break;case"input":Td(n,s),Ze("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Ze("invalid",n);break;case"textarea":Cd(n,s),Ze("invalid",n)}Bu(r,s),a=null;for(var i in s)if(s.hasOwnProperty(i)){var o=s[i];i==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&zo(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&zo(n.textContent,o,e),a=["children",""+o]):Ri.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&Ze("scroll",n)}switch(r){case"input":Do(n),Ad(n,s,!0);break;case"textarea":Do(n),Nd(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Ol)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=k1(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[an]=t,e[Hi]=n,Gx(e,t,!1,!1),t.stateNode=e;e:{switch(i=Uu(r,n),r){case"dialog":Ze("cancel",e),Ze("close",e),a=n;break;case"iframe":case"object":case"embed":Ze("load",e),a=n;break;case"video":case"audio":for(a=0;a<ii.length;a++)Ze(ii[a],e);a=n;break;case"source":Ze("error",e),a=n;break;case"img":case"image":case"link":Ze("error",e),Ze("load",e),a=n;break;case"details":Ze("toggle",e),a=n;break;case"input":Td(e,n),a=Du(e,n),Ze("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=ot({},n,{value:void 0}),Ze("invalid",e);break;case"textarea":Cd(e,n),a=Lu(e,n),Ze("invalid",e);break;default:a=n}Bu(r,a),o=a;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?T1(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&E1(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Di(e,l):typeof l=="number"&&Di(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ri.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Ze("scroll",e):l!=null&&Y0(e,s,l,i))}switch(r){case"input":Do(e),Ad(e,n,!1);break;case"textarea":Do(e),Nd(e);break;case"option":n.value!=null&&e.setAttribute("value",""+na(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?xs(e,!!n.multiple,s,!1):n.defaultValue!=null&&xs(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Ol)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return zt(t),null;case 6:if(e&&t.stateNode!=null)Xx(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ce(166));if(r=Ea(Wi.current),Ea(on.current),Ho(t)){if(n=t.stateNode,r=t.memoizedProps,n[an]=t,(s=n.nodeValue!==r)&&(e=_r,e!==null))switch(e.tag){case 3:zo(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&zo(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[an]=t,t.stateNode=n}return zt(t),null;case 13:if(et(st),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(rt&&yr!==null&&t.mode&1&&!(t.flags&128))dx(),As(),t.flags|=98560,s=!1;else if(s=Ho(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(ce(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ce(317));s[an]=t}else As(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;zt(t),s=!1}else Wr!==null&&(y0(Wr),Wr=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||st.current&1?St===0&&(St=3):Pf())),t.updateQueue!==null&&(t.flags|=4),zt(t),null);case 4:return Ns(),d0(e,t),e===null&&$i(t.stateNode.containerInfo),zt(t),null;case 10:return xf(t.type._context),zt(t),null;case 17:return xr(t.type)&&Pl(),zt(t),null;case 19:if(et(st),s=t.memoizedState,s===null)return zt(t),null;if(n=(t.flags&128)!==0,i=s.rendering,i===null)if(n)ei(s,!1);else{if(St!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=Bl(e),i!==null){for(t.flags|=128,ei(s,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return qe(st,st.current&1|2),t.child}e=e.sibling}s.tail!==null&&pt()>Fs&&(t.flags|=128,n=!0,ei(s,!1),t.lanes=4194304)}else{if(!n)if(e=Bl(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),ei(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!rt)return zt(t),null}else 2*pt()-s.renderingStartTime>Fs&&r!==1073741824&&(t.flags|=128,n=!0,ei(s,!1),t.lanes=4194304);s.isBackwards?(i.sibling=t.child,t.child=i):(r=s.last,r!==null?r.sibling=i:t.child=i,s.last=i)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=pt(),t.sibling=null,r=st.current,qe(st,n?r&1|2:r&1),t):(zt(t),null);case 22:case 23:return Of(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?gr&1073741824&&(zt(t),t.subtreeFlags&6&&(t.flags|=8192)):zt(t),null;case 24:return null;case 25:return null}throw Error(ce(156,t.tag))}function Ow(e,t){switch(ff(t),t.tag){case 1:return xr(t.type)&&Pl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ns(),et(pr),et(Yt),yf(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return wf(t),null;case 13:if(et(st),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ce(340));As()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return et(st),null;case 4:return Ns(),null;case 10:return xf(t.type._context),null;case 22:case 23:return Of(),null;case 24:return null;default:return null}}var Go=!1,Wt=!1,Pw=typeof WeakSet=="function"?WeakSet:Set,_e=null;function ds(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){ct(e,t,n)}else r.current=null}function h0(e,t,r){try{r()}catch(n){ct(e,t,n)}}var gh=!1;function Rw(e,t){if(qu=Nl,e=Z1(),cf(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,c=0,u=0,f=e,d=null;t:for(;;){for(var p;f!==r||a!==0&&f.nodeType!==3||(o=i+a),f!==s||n!==0&&f.nodeType!==3||(l=i+n),f.nodeType===3&&(i+=f.nodeValue.length),(p=f.firstChild)!==null;)d=f,f=p;for(;;){if(f===e)break t;if(d===r&&++c===a&&(o=i),d===s&&++u===n&&(l=i),(p=f.nextSibling)!==null)break;f=d,d=f.parentNode}f=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Ju={focusedElem:e,selectionRange:r},Nl=!1,_e=t;_e!==null;)if(t=_e,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,_e=e;else for(;_e!==null;){t=_e;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var m=x.memoizedProps,v=x.memoizedState,w=t.stateNode,y=w.getSnapshotBeforeUpdate(t.elementType===t.type?m:zr(t.type,m),v);w.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var g=t.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ce(163))}}catch(E){ct(t,t.return,E)}if(e=t.sibling,e!==null){e.return=t.return,_e=e;break}_e=t.return}return x=gh,gh=!1,x}function vi(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&h0(t,r,s)}a=a.next}while(a!==n)}}function wc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function p0(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Yx(e){var t=e.alternate;t!==null&&(e.alternate=null,Yx(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[an],delete t[Hi],delete t[e0],delete t[xw],delete t[mw])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function qx(e){return e.tag===5||e.tag===3||e.tag===4}function vh(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||qx(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function x0(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Ol));else if(n!==4&&(e=e.child,e!==null))for(x0(e,t,r),e=e.sibling;e!==null;)x0(e,t,r),e=e.sibling}function m0(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(m0(e,t,r),e=e.sibling;e!==null;)m0(e,t,r),e=e.sibling}var Rt=null,Hr=!1;function Pn(e,t,r){for(r=r.child;r!==null;)Jx(e,t,r),r=r.sibling}function Jx(e,t,r){if(sn&&typeof sn.onCommitFiberUnmount=="function")try{sn.onCommitFiberUnmount(fc,r)}catch{}switch(r.tag){case 5:Wt||ds(r,t);case 6:var n=Rt,a=Hr;Rt=null,Pn(e,t,r),Rt=n,Hr=a,Rt!==null&&(Hr?(e=Rt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Rt.removeChild(r.stateNode));break;case 18:Rt!==null&&(Hr?(e=Rt,r=r.stateNode,e.nodeType===8?ru(e.parentNode,r):e.nodeType===1&&ru(e,r),Mi(e)):ru(Rt,r.stateNode));break;case 4:n=Rt,a=Hr,Rt=r.stateNode.containerInfo,Hr=!0,Pn(e,t,r),Rt=n,Hr=a;break;case 0:case 11:case 14:case 15:if(!Wt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&h0(r,t,i),a=a.next}while(a!==n)}Pn(e,t,r);break;case 1:if(!Wt&&(ds(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){ct(r,t,o)}Pn(e,t,r);break;case 21:Pn(e,t,r);break;case 22:r.mode&1?(Wt=(n=Wt)||r.memoizedState!==null,Pn(e,t,r),Wt=n):Pn(e,t,r);break;default:Pn(e,t,r)}}function wh(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Pw),t.forEach(function(n){var a=zw.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Mr(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:Rt=o.stateNode,Hr=!1;break e;case 3:Rt=o.stateNode.containerInfo,Hr=!0;break e;case 4:Rt=o.stateNode.containerInfo,Hr=!0;break e}o=o.return}if(Rt===null)throw Error(ce(160));Jx(s,i,a),Rt=null,Hr=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){ct(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Qx(t,e),t=t.sibling}function Qx(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Mr(t,e),Zr(e),n&4){try{vi(3,e,e.return),wc(3,e)}catch(m){ct(e,e.return,m)}try{vi(5,e,e.return)}catch(m){ct(e,e.return,m)}}break;case 1:Mr(t,e),Zr(e),n&512&&r!==null&&ds(r,r.return);break;case 5:if(Mr(t,e),Zr(e),n&512&&r!==null&&ds(r,r.return),e.flags&32){var a=e.stateNode;try{Di(a,"")}catch(m){ct(e,e.return,m)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,i=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&y1(a,s),Uu(o,i);var c=Uu(o,s);for(i=0;i<l.length;i+=2){var u=l[i],f=l[i+1];u==="style"?T1(a,f):u==="dangerouslySetInnerHTML"?E1(a,f):u==="children"?Di(a,f):Y0(a,u,f,c)}switch(o){case"input":Iu(a,s);break;case"textarea":_1(a,s);break;case"select":var d=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?xs(a,!!s.multiple,p,!1):d!==!!s.multiple&&(s.defaultValue!=null?xs(a,!!s.multiple,s.defaultValue,!0):xs(a,!!s.multiple,s.multiple?[]:"",!1))}a[Hi]=s}catch(m){ct(e,e.return,m)}}break;case 6:if(Mr(t,e),Zr(e),n&4){if(e.stateNode===null)throw Error(ce(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(m){ct(e,e.return,m)}}break;case 3:if(Mr(t,e),Zr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Mi(t.containerInfo)}catch(m){ct(e,e.return,m)}break;case 4:Mr(t,e),Zr(e);break;case 13:Mr(t,e),Zr(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(bf=pt())),n&4&&wh(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(Wt=(c=Wt)||u,Mr(t,e),Wt=c):Mr(t,e),Zr(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(_e=e,u=e.child;u!==null;){for(f=_e=u;_e!==null;){switch(d=_e,p=d.child,d.tag){case 0:case 11:case 14:case 15:vi(4,d,d.return);break;case 1:ds(d,d.return);var x=d.stateNode;if(typeof x.componentWillUnmount=="function"){n=d,r=d.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(m){ct(n,r,m)}}break;case 5:ds(d,d.return);break;case 22:if(d.memoizedState!==null){_h(f);continue}}p!==null?(p.return=d,_e=p):_h(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{a=f.stateNode,c?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=f.stateNode,l=f.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=S1("display",i))}catch(m){ct(e,e.return,m)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(m){ct(e,e.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Mr(t,e),Zr(e),n&4&&wh(e);break;case 21:break;default:Mr(t,e),Zr(e)}}function Zr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(qx(r)){var n=r;break e}r=r.return}throw Error(ce(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Di(a,""),n.flags&=-33);var s=vh(e);m0(e,s,a);break;case 3:case 4:var i=n.stateNode.containerInfo,o=vh(e);x0(e,o,i);break;default:throw Error(ce(161))}}catch(l){ct(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Dw(e,t,r){_e=e,Zx(e)}function Zx(e,t,r){for(var n=(e.mode&1)!==0;_e!==null;){var a=_e,s=a.child;if(a.tag===22&&n){var i=a.memoizedState!==null||Go;if(!i){var o=a.alternate,l=o!==null&&o.memoizedState!==null||Wt;o=Go;var c=Wt;if(Go=i,(Wt=l)&&!c)for(_e=a;_e!==null;)i=_e,l=i.child,i.tag===22&&i.memoizedState!==null?kh(a):l!==null?(l.return=i,_e=l):kh(a);for(;s!==null;)_e=s,Zx(s),s=s.sibling;_e=a,Go=o,Wt=c}yh(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,_e=s):yh(e)}}function yh(e){for(;_e!==null;){var t=_e;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Wt||wc(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Wt)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:zr(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&ah(t,s,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}ah(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&Mi(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ce(163))}Wt||t.flags&512&&p0(t)}catch(d){ct(t,t.return,d)}}if(t===e){_e=null;break}if(r=t.sibling,r!==null){r.return=t.return,_e=r;break}_e=t.return}}function _h(e){for(;_e!==null;){var t=_e;if(t===e){_e=null;break}var r=t.sibling;if(r!==null){r.return=t.return,_e=r;break}_e=t.return}}function kh(e){for(;_e!==null;){var t=_e;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{wc(4,t)}catch(l){ct(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){ct(t,a,l)}}var s=t.return;try{p0(t)}catch(l){ct(t,s,l)}break;case 5:var i=t.return;try{p0(t)}catch(l){ct(t,i,l)}}}catch(l){ct(t,t.return,l)}if(t===e){_e=null;break}var o=t.sibling;if(o!==null){o.return=t.return,_e=o;break}_e=t.return}}var Iw=Math.ceil,zl=Fn.ReactCurrentDispatcher,Cf=Fn.ReactCurrentOwner,Pr=Fn.ReactCurrentBatchConfig,ze=0,Ot=null,vt=null,It=0,gr=0,hs=la(0),St=0,Yi=null,Pa=0,yc=0,Nf=0,wi=null,fr=null,bf=0,Fs=1/0,xn=null,Hl=!1,g0=null,Qn=null,Ko=!1,Vn=null,Vl=0,yi=0,v0=null,wl=-1,yl=0;function sr(){return ze&6?pt():wl!==-1?wl:wl=pt()}function Zn(e){return e.mode&1?ze&2&&It!==0?It&-It:vw.transition!==null?(yl===0&&(yl=L1()),yl):(e=We,e!==0||(e=window.event,e=e===void 0?16:V1(e.type)),e):1}function qr(e,t,r,n){if(50<yi)throw yi=0,v0=null,Error(ce(185));oo(e,r,n),(!(ze&2)||e!==Ot)&&(e===Ot&&(!(ze&2)&&(yc|=r),St===4&&Un(e,It)),mr(e,n),r===1&&ze===0&&!(t.mode&1)&&(Fs=pt()+500,mc&&ca()))}function mr(e,t){var r=e.callbackNode;v2(e,t);var n=Cl(e,e===Ot?It:0);if(n===0)r!==null&&Od(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Od(r),t===1)e.tag===0?gw(Eh.bind(null,e)):cx(Eh.bind(null,e)),hw(function(){!(ze&6)&&ca()}),r=null;else{switch(M1(n)){case 1:r=ef;break;case 4:r=I1;break;case 16:r=Al;break;case 536870912:r=j1;break;default:r=Al}r=om(r,em.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function em(e,t){if(wl=-1,yl=0,ze&6)throw Error(ce(327));var r=e.callbackNode;if(ys()&&e.callbackNode!==r)return null;var n=Cl(e,e===Ot?It:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Wl(e,n);else{t=n;var a=ze;ze|=2;var s=rm();(Ot!==e||It!==t)&&(xn=null,Fs=pt()+500,Ta(e,t));do try{Mw();break}catch(o){tm(e,o)}while(!0);pf(),zl.current=s,ze=a,vt!==null?t=0:(Ot=null,It=0,t=St)}if(t!==0){if(t===2&&(a=Wu(e),a!==0&&(n=a,t=w0(e,a))),t===1)throw r=Yi,Ta(e,0),Un(e,n),mr(e,pt()),r;if(t===6)Un(e,n);else{if(a=e.current.alternate,!(n&30)&&!jw(a)&&(t=Wl(e,n),t===2&&(s=Wu(e),s!==0&&(n=s,t=w0(e,s))),t===1))throw r=Yi,Ta(e,0),Un(e,n),mr(e,pt()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(ce(345));case 2:ga(e,fr,xn);break;case 3:if(Un(e,n),(n&130023424)===n&&(t=bf+500-pt(),10<t)){if(Cl(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){sr(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Zu(ga.bind(null,e,fr,xn),t);break}ga(e,fr,xn);break;case 4:if(Un(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var i=31-Yr(n);s=1<<i,i=t[i],i>a&&(a=i),n&=~s}if(n=a,n=pt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Iw(n/1960))-n,10<n){e.timeoutHandle=Zu(ga.bind(null,e,fr,xn),n);break}ga(e,fr,xn);break;case 5:ga(e,fr,xn);break;default:throw Error(ce(329))}}}return mr(e,pt()),e.callbackNode===r?em.bind(null,e):null}function w0(e,t){var r=wi;return e.current.memoizedState.isDehydrated&&(Ta(e,t).flags|=256),e=Wl(e,t),e!==2&&(t=fr,fr=r,t!==null&&y0(t)),e}function y0(e){fr===null?fr=e:fr.push.apply(fr,e)}function jw(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!Qr(s(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Un(e,t){for(t&=~Nf,t&=~yc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Yr(t),n=1<<r;e[r]=-1,t&=~n}}function Eh(e){if(ze&6)throw Error(ce(327));ys();var t=Cl(e,0);if(!(t&1))return mr(e,pt()),null;var r=Wl(e,t);if(e.tag!==0&&r===2){var n=Wu(e);n!==0&&(t=n,r=w0(e,n))}if(r===1)throw r=Yi,Ta(e,0),Un(e,t),mr(e,pt()),r;if(r===6)throw Error(ce(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ga(e,fr,xn),mr(e,pt()),null}function Ff(e,t){var r=ze;ze|=1;try{return e(t)}finally{ze=r,ze===0&&(Fs=pt()+500,mc&&ca())}}function Ra(e){Vn!==null&&Vn.tag===0&&!(ze&6)&&ys();var t=ze;ze|=1;var r=Pr.transition,n=We;try{if(Pr.transition=null,We=1,e)return e()}finally{We=n,Pr.transition=r,ze=t,!(ze&6)&&ca()}}function Of(){gr=hs.current,et(hs)}function Ta(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,dw(r)),vt!==null)for(r=vt.return;r!==null;){var n=r;switch(ff(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Pl();break;case 3:Ns(),et(pr),et(Yt),yf();break;case 5:wf(n);break;case 4:Ns();break;case 13:et(st);break;case 19:et(st);break;case 10:xf(n.type._context);break;case 22:case 23:Of()}r=r.return}if(Ot=e,vt=e=ea(e.current,null),It=gr=t,St=0,Yi=null,Nf=yc=Pa=0,fr=wi=null,ka!==null){for(t=0;t<ka.length;t++)if(r=ka[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var i=s.next;s.next=a,n.next=i}r.pending=n}ka=null}return e}function tm(e,t){do{var r=vt;try{if(pf(),ml.current=$l,Ul){for(var n=it.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Ul=!1}if(Oa=0,Ft=Et=it=null,gi=!1,Gi=0,Cf.current=null,r===null||r.return===null){St=1,Yi=t,vt=null;break}e:{var s=e,i=r.return,o=r,l=t;if(t=It,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=uh(i);if(p!==null){p.flags&=-257,fh(p,i,o,s,t),p.mode&1&&ch(s,c,t),t=p,l=c;var x=t.updateQueue;if(x===null){var m=new Set;m.add(l),t.updateQueue=m}else x.add(l);break e}else{if(!(t&1)){ch(s,c,t),Pf();break e}l=Error(ce(426))}}else if(rt&&o.mode&1){var v=uh(i);if(v!==null){!(v.flags&65536)&&(v.flags|=256),fh(v,i,o,s,t),df(bs(l,o));break e}}s=l=bs(l,o),St!==4&&(St=2),wi===null?wi=[s]:wi.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var w=Mx(s,l,t);nh(s,w);break e;case 1:o=l;var y=s.type,g=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Qn===null||!Qn.has(g)))){s.flags|=65536,t&=-t,s.lanes|=t;var E=Bx(s,o,t);nh(s,E);break e}}s=s.return}while(s!==null)}am(r)}catch(P){t=P,vt===r&&r!==null&&(vt=r=r.return);continue}break}while(!0)}function rm(){var e=zl.current;return zl.current=$l,e===null?$l:e}function Pf(){(St===0||St===3||St===2)&&(St=4),Ot===null||!(Pa&268435455)&&!(yc&268435455)||Un(Ot,It)}function Wl(e,t){var r=ze;ze|=2;var n=rm();(Ot!==e||It!==t)&&(xn=null,Ta(e,t));do try{Lw();break}catch(a){tm(e,a)}while(!0);if(pf(),ze=r,zl.current=n,vt!==null)throw Error(ce(261));return Ot=null,It=0,St}function Lw(){for(;vt!==null;)nm(vt)}function Mw(){for(;vt!==null&&!c2();)nm(vt)}function nm(e){var t=im(e.alternate,e,gr);e.memoizedProps=e.pendingProps,t===null?am(e):vt=t,Cf.current=null}function am(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Ow(r,t),r!==null){r.flags&=32767,vt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{St=6,vt=null;return}}else if(r=Fw(r,t,gr),r!==null){vt=r;return}if(t=t.sibling,t!==null){vt=t;return}vt=t=e}while(t!==null);St===0&&(St=5)}function ga(e,t,r){var n=We,a=Pr.transition;try{Pr.transition=null,We=1,Bw(e,t,r,n)}finally{Pr.transition=a,We=n}return null}function Bw(e,t,r,n){do ys();while(Vn!==null);if(ze&6)throw Error(ce(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ce(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(w2(e,s),e===Ot&&(vt=Ot=null,It=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ko||(Ko=!0,om(Al,function(){return ys(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Pr.transition,Pr.transition=null;var i=We;We=1;var o=ze;ze|=4,Cf.current=null,Rw(e,r),Qx(r,e),sw(Ju),Nl=!!qu,Ju=qu=null,e.current=r,Dw(r),u2(),ze=o,We=i,Pr.transition=s}else e.current=r;if(Ko&&(Ko=!1,Vn=e,Vl=a),s=e.pendingLanes,s===0&&(Qn=null),h2(r.stateNode),mr(e,pt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Hl)throw Hl=!1,e=g0,g0=null,e;return Vl&1&&e.tag!==0&&ys(),s=e.pendingLanes,s&1?e===v0?yi++:(yi=0,v0=e):yi=0,ca(),null}function ys(){if(Vn!==null){var e=M1(Vl),t=Pr.transition,r=We;try{if(Pr.transition=null,We=16>e?16:e,Vn===null)var n=!1;else{if(e=Vn,Vn=null,Vl=0,ze&6)throw Error(ce(331));var a=ze;for(ze|=4,_e=e.current;_e!==null;){var s=_e,i=s.child;if(_e.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(_e=c;_e!==null;){var u=_e;switch(u.tag){case 0:case 11:case 15:vi(8,u,s)}var f=u.child;if(f!==null)f.return=u,_e=f;else for(;_e!==null;){u=_e;var d=u.sibling,p=u.return;if(Yx(u),u===c){_e=null;break}if(d!==null){d.return=p,_e=d;break}_e=p}}}var x=s.alternate;if(x!==null){var m=x.child;if(m!==null){x.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(m!==null)}}_e=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,_e=i;else e:for(;_e!==null;){if(s=_e,s.flags&2048)switch(s.tag){case 0:case 11:case 15:vi(9,s,s.return)}var w=s.sibling;if(w!==null){w.return=s.return,_e=w;break e}_e=s.return}}var y=e.current;for(_e=y;_e!==null;){i=_e;var g=i.child;if(i.subtreeFlags&2064&&g!==null)g.return=i,_e=g;else e:for(i=y;_e!==null;){if(o=_e,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:wc(9,o)}}catch(P){ct(o,o.return,P)}if(o===i){_e=null;break e}var E=o.sibling;if(E!==null){E.return=o.return,_e=E;break e}_e=o.return}}if(ze=a,ca(),sn&&typeof sn.onPostCommitFiberRoot=="function")try{sn.onPostCommitFiberRoot(fc,e)}catch{}n=!0}return n}finally{We=r,Pr.transition=t}}return!1}function Sh(e,t,r){t=bs(r,t),t=Mx(e,t,1),e=Jn(e,t,1),t=sr(),e!==null&&(oo(e,1,t),mr(e,t))}function ct(e,t,r){if(e.tag===3)Sh(e,e,r);else for(;t!==null;){if(t.tag===3){Sh(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Qn===null||!Qn.has(n))){e=bs(r,e),e=Bx(t,e,1),t=Jn(t,e,1),e=sr(),t!==null&&(oo(t,1,e),mr(t,e));break}}t=t.return}}function Uw(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=sr(),e.pingedLanes|=e.suspendedLanes&r,Ot===e&&(It&r)===r&&(St===4||St===3&&(It&130023424)===It&&500>pt()-bf?Ta(e,0):Nf|=r),mr(e,t)}function sm(e,t){t===0&&(e.mode&1?(t=Lo,Lo<<=1,!(Lo&130023424)&&(Lo=4194304)):t=1);var r=sr();e=Cn(e,t),e!==null&&(oo(e,t,r),mr(e,r))}function $w(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),sm(e,r)}function zw(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ce(314))}n!==null&&n.delete(t),sm(e,r)}var im;im=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||pr.current)hr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return hr=!1,bw(e,t,r);hr=!!(e.flags&131072)}else hr=!1,rt&&t.flags&1048576&&ux(t,Il,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;vl(e,t),e=t.pendingProps;var a=Ts(t,Yt.current);ws(t,r),a=kf(null,t,n,e,a,r);var s=Ef();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,xr(n)?(s=!0,Rl(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,gf(t),a.updater=vc,t.stateNode=a,a._reactInternals=t,i0(t,n,e,r),t=c0(null,t,n,!0,s,r)):(t.tag=0,rt&&s&&uf(t),tr(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(vl(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=Vw(n),e=zr(n,e),a){case 0:t=l0(null,t,n,e,r);break e;case 1:t=ph(null,t,n,e,r);break e;case 11:t=dh(null,t,n,e,r);break e;case 14:t=hh(null,t,n,zr(n.type,e),r);break e}throw Error(ce(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:zr(n,a),l0(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:zr(n,a),ph(e,t,n,a,r);case 3:e:{if(Hx(t),e===null)throw Error(ce(387));n=t.pendingProps,s=t.memoizedState,a=s.element,mx(e,t),Ml(t,n,null,r);var i=t.memoizedState;if(n=i.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=bs(Error(ce(423)),t),t=xh(e,t,n,r,a);break e}else if(n!==a){a=bs(Error(ce(424)),t),t=xh(e,t,n,r,a);break e}else for(yr=qn(t.stateNode.containerInfo.firstChild),_r=t,rt=!0,Wr=null,r=px(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(As(),n===a){t=Nn(e,t,r);break e}tr(e,t,n,r)}t=t.child}return t;case 5:return gx(t),e===null&&n0(t),n=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,i=a.children,Qu(n,a)?i=null:s!==null&&Qu(n,s)&&(t.flags|=32),zx(e,t),tr(e,t,i,r),t.child;case 6:return e===null&&n0(t),null;case 13:return Vx(e,t,r);case 4:return vf(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Cs(t,null,n,r):tr(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:zr(n,a),dh(e,t,n,a,r);case 7:return tr(e,t,t.pendingProps,r),t.child;case 8:return tr(e,t,t.pendingProps.children,r),t.child;case 12:return tr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value,qe(jl,n._currentValue),n._currentValue=i,s!==null)if(Qr(s.value,i)){if(s.children===a.children&&!pr.current){t=Nn(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){i=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=kn(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),a0(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)i=s.type===t.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(ce(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),a0(i,r,t),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===t){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}tr(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,ws(t,r),a=Dr(a),n=n(a),t.flags|=1,tr(e,t,n,r),t.child;case 14:return n=t.type,a=zr(n,t.pendingProps),a=zr(n.type,a),hh(e,t,n,a,r);case 15:return Ux(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:zr(n,a),vl(e,t),t.tag=1,xr(n)?(e=!0,Rl(t)):e=!1,ws(t,r),Lx(t,n,a),i0(t,n,a,r),c0(null,t,n,!0,e,r);case 19:return Wx(e,t,r);case 22:return $x(e,t,r)}throw Error(ce(156,t.tag))};function om(e,t){return D1(e,t)}function Hw(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Or(e,t,r,n){return new Hw(e,t,r,n)}function Rf(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Vw(e){if(typeof e=="function")return Rf(e)?1:0;if(e!=null){if(e=e.$$typeof,e===J0)return 11;if(e===Q0)return 14}return 2}function ea(e,t){var r=e.alternate;return r===null?(r=Or(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function _l(e,t,r,n,a,s){var i=2;if(n=e,typeof e=="function")Rf(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case ns:return Aa(r.children,a,s,t);case q0:i=8,a|=8;break;case Fu:return e=Or(12,r,t,a|2),e.elementType=Fu,e.lanes=s,e;case Ou:return e=Or(13,r,t,a),e.elementType=Ou,e.lanes=s,e;case Pu:return e=Or(19,r,t,a),e.elementType=Pu,e.lanes=s,e;case g1:return _c(r,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case x1:i=10;break e;case m1:i=9;break e;case J0:i=11;break e;case Q0:i=14;break e;case Ln:i=16,n=null;break e}throw Error(ce(130,e==null?e:typeof e,""))}return t=Or(i,r,t,a),t.elementType=e,t.type=n,t.lanes=s,t}function Aa(e,t,r,n){return e=Or(7,e,n,t),e.lanes=r,e}function _c(e,t,r,n){return e=Or(22,e,n,t),e.elementType=g1,e.lanes=r,e.stateNode={isHidden:!1},e}function uu(e,t,r){return e=Or(6,e,null,t),e.lanes=r,e}function fu(e,t,r){return t=Or(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ww(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Wc(0),this.expirationTimes=Wc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wc(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Df(e,t,r,n,a,s,i,o,l){return e=new Ww(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Or(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},gf(s),e}function Gw(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:rs,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function lm(e){if(!e)return aa;e=e._reactInternals;e:{if(Ma(e)!==e||e.tag!==1)throw Error(ce(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(xr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ce(171))}if(e.tag===1){var r=e.type;if(xr(r))return lx(e,r,t)}return t}function cm(e,t,r,n,a,s,i,o,l){return e=Df(r,n,!0,e,a,s,i,o,l),e.context=lm(null),r=e.current,n=sr(),a=Zn(r),s=kn(n,a),s.callback=t??null,Jn(r,s,a),e.current.lanes=a,oo(e,a,n),mr(e,n),e}function kc(e,t,r,n){var a=t.current,s=sr(),i=Zn(a);return r=lm(r),t.context===null?t.context=r:t.pendingContext=r,t=kn(s,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Jn(a,t,i),e!==null&&(qr(e,a,i,s),xl(e,a,i)),i}function Gl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Th(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function If(e,t){Th(e,t),(e=e.alternate)&&Th(e,t)}function Kw(){return null}var um=typeof reportError=="function"?reportError:function(e){console.error(e)};function jf(e){this._internalRoot=e}Ec.prototype.render=jf.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ce(409));kc(e,t,null,null)};Ec.prototype.unmount=jf.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ra(function(){kc(null,e,null,null)}),t[An]=null}};function Ec(e){this._internalRoot=e}Ec.prototype.unstable_scheduleHydration=function(e){if(e){var t=$1();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Bn.length&&t!==0&&t<Bn[r].priority;r++);Bn.splice(r,0,e),r===0&&H1(e)}};function Lf(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Sc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Ah(){}function Xw(e,t,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var c=Gl(i);s.call(c)}}var i=cm(t,n,e,0,null,!1,!1,"",Ah);return e._reactRootContainer=i,e[An]=i.current,$i(e.nodeType===8?e.parentNode:e),Ra(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var c=Gl(l);o.call(c)}}var l=Df(e,0,!1,null,null,!1,!1,"",Ah);return e._reactRootContainer=l,e[An]=l.current,$i(e.nodeType===8?e.parentNode:e),Ra(function(){kc(t,l,r,n)}),l}function Tc(e,t,r,n,a){var s=r._reactRootContainer;if(s){var i=s;if(typeof a=="function"){var o=a;a=function(){var l=Gl(i);o.call(l)}}kc(t,i,e,a)}else i=Xw(r,t,e,a,n);return Gl(i)}B1=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=si(t.pendingLanes);r!==0&&(tf(t,r|1),mr(t,pt()),!(ze&6)&&(Fs=pt()+500,ca()))}break;case 13:Ra(function(){var n=Cn(e,1);if(n!==null){var a=sr();qr(n,e,1,a)}}),If(e,1)}};rf=function(e){if(e.tag===13){var t=Cn(e,134217728);if(t!==null){var r=sr();qr(t,e,134217728,r)}If(e,134217728)}};U1=function(e){if(e.tag===13){var t=Zn(e),r=Cn(e,t);if(r!==null){var n=sr();qr(r,e,t,n)}If(e,t)}};$1=function(){return We};z1=function(e,t){var r=We;try{return We=e,t()}finally{We=r}};zu=function(e,t,r){switch(t){case"input":if(Iu(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=xc(n);if(!a)throw Error(ce(90));w1(n),Iu(n,a)}}}break;case"textarea":_1(e,r);break;case"select":t=r.value,t!=null&&xs(e,!!r.multiple,t,!1)}};N1=Ff;b1=Ra;var Yw={usingClientEntryPoint:!1,Events:[co,os,xc,A1,C1,Ff]},ti={findFiberByHostInstance:_a,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},qw={bundleType:ti.bundleType,version:ti.version,rendererPackageName:ti.rendererPackageName,rendererConfig:ti.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Fn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=P1(e),e===null?null:e.stateNode},findFiberByHostInstance:ti.findFiberByHostInstance||Kw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xo.isDisabled&&Xo.supportsFiber)try{fc=Xo.inject(qw),sn=Xo}catch{}}Sr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Yw;Sr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Lf(t))throw Error(ce(200));return Gw(e,t,null,r)};Sr.createRoot=function(e,t){if(!Lf(e))throw Error(ce(299));var r=!1,n="",a=um;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Df(e,1,!1,null,null,r,!1,n,a),e[An]=t.current,$i(e.nodeType===8?e.parentNode:e),new jf(t)};Sr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ce(188)):(e=Object.keys(e).join(","),Error(ce(268,e)));return e=P1(t),e=e===null?null:e.stateNode,e};Sr.flushSync=function(e){return Ra(e)};Sr.hydrate=function(e,t,r){if(!Sc(t))throw Error(ce(200));return Tc(null,e,t,!0,r)};Sr.hydrateRoot=function(e,t,r){if(!Lf(e))throw Error(ce(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",i=um;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=cm(t,null,e,1,r??null,a,!1,s,i),e[An]=t.current,$i(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Ec(t)};Sr.render=function(e,t,r){if(!Sc(t))throw Error(ce(200));return Tc(null,e,t,!1,r)};Sr.unmountComponentAtNode=function(e){if(!Sc(e))throw Error(ce(40));return e._reactRootContainer?(Ra(function(){Tc(null,null,e,!1,function(){e._reactRootContainer=null,e[An]=null})}),!0):!1};Sr.unstable_batchedUpdates=Ff;Sr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Sc(r))throw Error(ce(200));if(e==null||e._reactInternals===void 0)throw Error(ce(38));return Tc(e,t,r,!1,n)};Sr.version="18.3.1-next-f1338f8080-20240426";function fm(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(fm)}catch(e){console.error(e)}}fm(),f1.exports=Sr;var Jw=f1.exports,dm,Ch=Jw;dm=Ch.createRoot,Ch.hydrateRoot;const Qw="modulepreload",Zw=function(e){return"/"+e},Nh={},fo=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(r.map(l=>{if(l=Zw(l),l in Nh)return;Nh[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":Qw,c||(f.as="script"),f.crossOrigin="",f.href=l,o&&f.setAttribute("nonce",o),document.head.appendChild(f),c)return new Promise((d,p)=>{f.addEventListener("load",d),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return a.then(i=>{for(const o of i||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})},ey=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>fo(async()=>{const{default:n}=await Promise.resolve().then(()=>Ls);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class Mf extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class ty extends Mf{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class bh extends Mf{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Fh extends Mf{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var _0;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(_0||(_0={}));var ry=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class ny{constructor(t,{headers:r={},customFetch:n,region:a=_0.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=ey(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return ry(this,void 0,void 0,function*(){try{const{headers:a,method:s,body:i}=r;let o={},{region:l}=r;l||(l=this.region);const c=new URL(`${this.url}/${t}`);l&&l!=="any"&&(o["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;i&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=i):typeof i=="string"?(o["Content-Type"]="text/plain",u=i):typeof FormData<"u"&&i instanceof FormData?u=i:(o["Content-Type"]="application/json",u=JSON.stringify(i)));const f=yield this.fetch(c.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),a),body:u}).catch(m=>{throw new ty(m)}),d=f.headers.get("x-relay-error");if(d&&d==="true")throw new bh(f);if(!f.ok)throw new Fh(f);let p=((n=f.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),x;return p==="application/json"?x=yield f.json():p==="application/octet-stream"?x=yield f.blob():p==="text/event-stream"?x=f:p==="multipart/form-data"?x=yield f.formData():x=yield f.text(),{data:x,error:null,response:f}}catch(a){return{data:null,error:a,response:a instanceof Fh||a instanceof bh?a.context:void 0}}})}}var dr={},Bf={},Ac={},ho={},Cc={},Nc={},ay=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Os=ay();const sy=Os.fetch,hm=Os.fetch.bind(Os),pm=Os.Headers,iy=Os.Request,oy=Os.Response,Ls=Object.freeze(Object.defineProperty({__proto__:null,Headers:pm,Request:iy,Response:oy,default:hm,fetch:sy},Symbol.toStringTag,{value:"Module"})),ly=Sv(Ls);var bc={};Object.defineProperty(bc,"__esModule",{value:!0});let cy=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};bc.default=cy;var xm=Rr&&Rr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Nc,"__esModule",{value:!0});const uy=xm(ly),fy=xm(bc);let dy=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=uy.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var i,o,l;let c=null,u=null,f=null,d=s.status,p=s.statusText;if(s.ok){if(this.method!=="HEAD"){const w=await s.text();w===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=w:u=JSON.parse(w))}const m=(i=this.headers.Prefer)===null||i===void 0?void 0:i.match(/count=(exact|planned|estimated)/),v=(o=s.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");m&&v&&v.length>1&&(f=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,f=null,d=406,p="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const m=await s.text();try{c=JSON.parse(m),Array.isArray(c)&&s.status===404&&(u=[],c=null,d=200,p="OK")}catch{s.status===404&&m===""?(d=204,p="No Content"):c={message:m}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,d=200,p="OK"),c&&this.shouldThrowOnError)throw new fy.default(c)}return{error:c,data:u,count:f,status:d,statusText:p}});return this.shouldThrowOnError||(a=a.catch(s=>{var i,o,l;return{error:{message:`${(i=s==null?void 0:s.name)!==null&&i!==void 0?i:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};Nc.default=dy;var hy=Rr&&Rr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Cc,"__esModule",{value:!0});const py=hy(Nc);let xy=class extends py.default{select(t){let r=!1;const n=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:a,referencedTable:s=a}={}){const i=s?`${s}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:a=n}={}){const s=typeof a>"u"?"offset":`${a}.offset`,i=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(i,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:s=!1,format:i="text"}={}){var o;const l=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${i}; for="${c}"; options=${l};`,i==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Cc.default=xy;var my=Rr&&Rr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ho,"__esModule",{value:!0});const gy=my(Cc);let vy=class extends gy.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:a}={}){let s="";a==="plain"?s="pl":a==="phrase"?s="ph":a==="websearch"&&(s="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${s}fts${i}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};ho.default=vy;var wy=Rr&&Rr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ac,"__esModule",{value:!0});const ri=wy(ho);let yy=class{constructor(t,{headers:r={},schema:n,fetch:a}){this.url=t,this.headers=r,this.schema=n,this.fetch=a}select(t,{head:r=!1,count:n}={}){const a=r?"HEAD":"GET";let s=!1;const i=(t??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",i),n&&(this.headers.Prefer=`count=${n}`),new ri.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const a="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),n||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(t)){const i=t.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(i.length>0){const o=[...new Set(i)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new ri.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:a,defaultToNull:s=!0}={}){const i="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),a&&o.push(`count=${a}`),s||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const l=t.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new ri.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),r&&a.push(`count=${r}`),this.headers.Prefer=a.join(","),new ri.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new ri.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Ac.default=yy;var Fc={},Oc={};Object.defineProperty(Oc,"__esModule",{value:!0});Oc.version=void 0;Oc.version="0.0.0-automated";Object.defineProperty(Fc,"__esModule",{value:!0});Fc.DEFAULT_HEADERS=void 0;const _y=Oc;Fc.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${_y.version}`};var mm=Rr&&Rr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Bf,"__esModule",{value:!0});const ky=mm(Ac),Ey=mm(ho),Sy=Fc;let Ty=class gm{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=Object.assign(Object.assign({},Sy.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new ky.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new gm(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:s}={}){let i;const o=new URL(`${this.url}/rpc/${t}`);let l;n||a?(i=n?"HEAD":"GET",Object.entries(r).filter(([u,f])=>f!==void 0).map(([u,f])=>[u,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([u,f])=>{o.searchParams.append(u,f)})):(i="POST",l=r);const c=Object.assign({},this.headers);return s&&(c.Prefer=`count=${s}`),new Ey.default({method:i,url:o,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};Bf.default=Ty;var Ms=Rr&&Rr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(dr,"__esModule",{value:!0});dr.PostgrestError=dr.PostgrestBuilder=dr.PostgrestTransformBuilder=dr.PostgrestFilterBuilder=dr.PostgrestQueryBuilder=dr.PostgrestClient=void 0;const vm=Ms(Bf);dr.PostgrestClient=vm.default;const wm=Ms(Ac);dr.PostgrestQueryBuilder=wm.default;const ym=Ms(ho);dr.PostgrestFilterBuilder=ym.default;const _m=Ms(Cc);dr.PostgrestTransformBuilder=_m.default;const km=Ms(Nc);dr.PostgrestBuilder=km.default;const Em=Ms(bc);dr.PostgrestError=Em.default;var Ay=dr.default={PostgrestClient:vm.default,PostgrestQueryBuilder:wm.default,PostgrestFilterBuilder:ym.default,PostgrestTransformBuilder:_m.default,PostgrestBuilder:km.default,PostgrestError:Em.default};const{PostgrestClient:Cy,PostgrestQueryBuilder:zF,PostgrestFilterBuilder:HF,PostgrestTransformBuilder:VF,PostgrestBuilder:WF,PostgrestError:GF}=Ay;class Ny{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const r=parseInt(process.versions.node.split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const by="2.15.1",Fy=`realtime-js/${by}`,Oy="1.0.0",k0=1e4,Py=1e3,Ry=100;var _i;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(_i||(_i={}));var yt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(yt||(yt={}));var Vr;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Vr||(Vr={}));var E0;(function(e){e.websocket="websocket"})(E0||(E0={}));var wa;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(wa||(wa={}));class Dy{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),s=r.getUint8(2);let i=this.HEADER_LENGTH+2;const o=n.decode(t.slice(i,i+a));i=i+a;const l=n.decode(t.slice(i,i+s));i=i+s;const c=JSON.parse(n.decode(t.slice(i,t.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class Sm{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ye;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Ye||(Ye={}));const Oh=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((s,i)=>(s[i]=Iy(i,e,t,a),s),{})},Iy=(e,t,r,n)=>{const a=t.find(o=>o.name===e),s=a==null?void 0:a.type,i=r[e];return s&&!n.includes(s)?Tm(s,i):S0(i)},Tm=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return By(t,r)}switch(e){case Ye.bool:return jy(t);case Ye.float4:case Ye.float8:case Ye.int2:case Ye.int4:case Ye.int8:case Ye.numeric:case Ye.oid:return Ly(t);case Ye.json:case Ye.jsonb:return My(t);case Ye.timestamp:return Uy(t);case Ye.abstime:case Ye.date:case Ye.daterange:case Ye.int4range:case Ye.int8range:case Ye.money:case Ye.reltime:case Ye.text:case Ye.time:case Ye.timestamptz:case Ye.timetz:case Ye.tsrange:case Ye.tstzrange:return S0(t);default:return S0(t)}},S0=e=>e,jy=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Ly=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},My=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},By=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const i=e.slice(1,r);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(o=>Tm(t,o))}return e},Uy=e=>typeof e=="string"?e.replace(" ","T"):e,Am=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class du{constructor(t,r,n={},a=k0){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Ph;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Ph||(Ph={}));class ki{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ki.syncState(this.state,a,s,i),this.pendingDiffs.forEach(l=>{this.state=ki.syncDiff(this.state,l,s,i)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=ki.syncDiff(this.state,a,s,i),o())}),this.onJoin((a,s,i)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:s,newPresences:i})}),this.onLeave((a,s,i)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const s=this.cloneDeep(t),i=this.transformState(r),o={},l={};return this.map(s,(c,u)=>{i[c]||(l[c]=u)}),this.map(i,(c,u)=>{const f=s[c];if(f){const d=u.map(v=>v.presence_ref),p=f.map(v=>v.presence_ref),x=u.filter(v=>p.indexOf(v.presence_ref)<0),m=f.filter(v=>d.indexOf(v.presence_ref)<0);x.length>0&&(o[c]=x),m.length>0&&(l[c]=m)}else o[c]=u}),this.syncDiff(s,{joins:o,leaves:l},n,a)}static syncDiff(t,r,n,a){const{joins:s,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(s,(o,l)=>{var c;const u=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),u.length>0){const f=t[o].map(p=>p.presence_ref),d=u.filter(p=>f.indexOf(p.presence_ref)<0);t[o].unshift(...d)}n(o,u,l)}),this.map(i,(o,l)=>{let c=t[o];if(!c)return;const u=l.map(f=>f.presence_ref);c=c.filter(f=>u.indexOf(f.presence_ref)<0),t[o]=c,a(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Rh;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Rh||(Rh={}));var Ei;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Ei||(Ei={}));var mn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(mn||(mn={}));class Uf{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=yt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new du(this,Vr.join,this.params,this.timeout),this.rejoinTimer=new Sm(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=yt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=yt.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=yt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=yt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=yt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Vr.reply,{},(a,s)=>{this._trigger(this._replyEventName(s),a)}),this.presence=new ki(this),this.broadcastEndpointURL=Am(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==yt.closed){const{config:{broadcast:s,presence:i,private:o}}=this.params,l=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(d=>d.filter))!==null&&a!==void 0?a:[],c=!!this.bindings[Ei.PRESENCE]&&this.bindings[Ei.PRESENCE].length>0,u={},f={broadcast:s,presence:Object.assign(Object.assign({},i),{enabled:c}),postgres_changes:l,private:o};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this._onError(d=>t==null?void 0:t(mn.CHANNEL_ERROR,d)),this._onClose(()=>t==null?void 0:t(mn.CLOSED)),this.updateJoinPayload(Object.assign({config:f},u)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:d})=>{var p;if(this.socket.setAuth(),d===void 0){t==null||t(mn.SUBSCRIBED);return}else{const x=this.bindings.postgres_changes,m=(p=x==null?void 0:x.length)!==null&&p!==void 0?p:0,v=[];for(let w=0;w<m;w++){const y=x[w],{filter:{event:g,schema:E,table:P,filter:T}}=y,k=d&&d[w];if(k&&k.event===g&&k.schema===E&&k.table===P&&k.filter===T)v.push(Object.assign(Object.assign({},y),{id:k.id}));else{this.unsubscribe(),this.state=yt.errored,t==null||t(mn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,t&&t(mn.SUBSCRIBED);return}}).receive("error",d=>{this.state=yt.errored,t==null||t(mn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(mn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===yt.joined&&t===Ei.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:i}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=c.body)===null||a===void 0?void 0:a.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=yt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Vr.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new du(this,Vr.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=yt.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,s=setTimeout(()=>a.abort(),n),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(s),i}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new du(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>Ry){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,s;const i=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=Vr;if(n&&[o,l,c,u].indexOf(i)>=0&&n!==this._joinRef())return;let d=this._onMessage(i,r,n);if(r&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(p=>{var x,m,v;return((x=p.filter)===null||x===void 0?void 0:x.event)==="*"||((v=(m=p.filter)===null||m===void 0?void 0:m.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===i}).map(p=>p.callback(d,n)):(s=this.bindings[i])===null||s===void 0||s.filter(p=>{var x,m,v,w,y,g;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in p){const E=p.id,P=(x=p.filter)===null||x===void 0?void 0:x.event;return E&&((m=r.ids)===null||m===void 0?void 0:m.includes(E))&&(P==="*"||(P==null?void 0:P.toLocaleLowerCase())===((v=r.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const E=(y=(w=p==null?void 0:p.filter)===null||w===void 0?void 0:w.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return E==="*"||E===((g=r==null?void 0:r.event)===null||g===void 0?void 0:g.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===i}).map(p=>{if(typeof d=="object"&&"ids"in d){const x=d.data,{schema:m,table:v,commit_timestamp:w,type:y,errors:g}=x;d=Object.assign(Object.assign({},{schema:m,table:v,commit_timestamp:w,eventType:y,new:{},old:{},errors:g}),this._getPayloadRecords(x))}p.callback(d,n)})}_isClosed(){return this.state===yt.closed}_isJoined(){return this.state===yt.joined}_isJoining(){return this.state===yt.joining}_isLeaving(){return this.state===yt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),s={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var s;return!(((s=a.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&Uf.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Vr.close,{},t)}_onError(t){this._on(Vr.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=yt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Oh(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Oh(t.columns,t.old_record)),r}}const Dh=()=>{},Yo={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},$y=[1e3,2e3,5e3,1e4],zy=1e4,Hy=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Vy{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=k0,this.transport=null,this.heartbeatIntervalMs=Yo.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Dh,this.ref=0,this.reconnectTimer=null,this.logger=Dh,this.conn=null,this.sendBuffer=[],this.serializer=new Dy,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let s;return a?s=a:typeof fetch>"u"?s=(...i)=>fo(async()=>{const{default:o}=await Promise.resolve().then(()=>Ls);return{default:o}},void 0).then(({default:o})=>o(...i)).catch(o=>{throw new Error(`Failed to load @supabase/node-fetch: ${o.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):s=fetch,(...i)=>s(...i)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${E0.websocket}`,this.httpEndpoint=Am(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Ny.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Oy}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case _i.connecting:return wa.Connecting;case _i.open:return wa.Open;case _i.closing:return wa.Closing;default:return wa.Closed}}isConnected(){return this.connectionState()===wa.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(s=>s.topic===n);if(a)return a;{const s=new Uf(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:a,ref:s}=t,i=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${s})`,a),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(Py,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Yo.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{r.topic==="phoenix"&&r.event==="phx_reply"&&this.heartbeatCallback(r.payload.status==="ok"?"ok":"error"),r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:s,ref:i}=r,o=i?`(${i})`:"",l=s.status||"";this.log("receive",`${l} ${n} ${a} ${o}`.trim(),s),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(a,s,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Vr.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([Hy],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:Fy};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(Vr.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Sm(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Yo.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,s,i,o,l,c;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:k0,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:Yo.HEARTBEAT_INTERVAL,this.worker=(s=t==null?void 0:t.worker)!==null&&s!==void 0?s:!1,this.accessToken=(i=t==null?void 0:t.accessToken)!==null&&i!==void 0?i:null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(o=t==null?void 0:t.reconnectAfterMs)!==null&&o!==void 0?o:u=>$y[u-1]||zy,this.encode=(l=t==null?void 0:t.encode)!==null&&l!==void 0?l:(u,f)=>f(JSON.stringify(u)),this.decode=(c=t==null?void 0:t.decode)!==null&&c!==void 0?c:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class $f extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function _t(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class Wy extends $f{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class T0 extends $f{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var Gy=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const Cm=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>fo(async()=>{const{default:n}=await Promise.resolve().then(()=>Ls);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},Ky=()=>Gy(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield fo(()=>Promise.resolve().then(()=>Ls),void 0)).Response:Response}),A0=e=>{if(Array.isArray(e))return e.map(r=>A0(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[a]=A0(n)}),t},Xy=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var Ba=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const hu=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Yy=(e,t,r)=>Ba(void 0,void 0,void 0,function*(){const n=yield Ky();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{const s=e.status||500,i=(a==null?void 0:a.statusCode)||s+"";t(new Wy(hu(a),s,i))}).catch(a=>{t(new T0(hu(a),a))}):t(new T0(hu(e),e))}),qy=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?a:(Xy(n)?(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,t!=null&&t.duplex&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r))};function po(e,t,r,n,a,s){return Ba(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(r,qy(t,n,a,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>i(l)).catch(l=>Yy(l,o,n))})})}function Kl(e,t,r,n){return Ba(this,void 0,void 0,function*(){return po(e,"GET",t,r,n)})}function nn(e,t,r,n,a){return Ba(this,void 0,void 0,function*(){return po(e,"POST",t,n,a,r)})}function C0(e,t,r,n,a){return Ba(this,void 0,void 0,function*(){return po(e,"PUT",t,n,a,r)})}function Jy(e,t,r,n){return Ba(this,void 0,void 0,function*(){return po(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function Nm(e,t,r,n,a){return Ba(this,void 0,void 0,function*(){return po(e,"DELETE",t,n,a,r)})}var er=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const Qy={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ih={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Zy{constructor(t,r={},n,a){this.url=t,this.headers=r,this.bucketId=n,this.fetch=Cm(a)}uploadOrUpdate(t,r,n,a){return er(this,void 0,void 0,function*(){try{let s;const i=Object.assign(Object.assign({},Ih),a);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const l=i.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=n,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),a!=null&&a.headers&&(o=Object.assign(Object.assign({},o),a.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),f=yield(t=="PUT"?C0:nn)(this.fetch,`${this.url}/object/${u}`,s,Object.assign({headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:c,id:f.Id,fullPath:f.Key},error:null}}catch(s){if(_t(s))return{data:null,error:s};throw s}})}upload(t,r,n){return er(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return er(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),i=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:Ih.upsert},a),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const f=yield C0(this.fetch,o.toString(),l,{headers:u});return{data:{path:s,fullPath:f.Key},error:null}}catch(l){if(_t(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return er(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const s=yield nn(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),i=new URL(this.url+s.url),o=i.searchParams.get("token");if(!o)throw new $f("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:o},error:null}}catch(n){if(_t(n))return{data:null,error:n};throw n}})}update(t,r,n){return er(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return er(this,void 0,void 0,function*(){try{return{data:yield nn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(_t(a))return{data:null,error:a};throw a}})}copy(t,r,n){return er(this,void 0,void 0,function*(){try{return{data:{path:(yield nn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(_t(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return er(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),s=yield nn(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(a){if(_t(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return er(this,void 0,void 0,function*(){try{const a=yield nn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${s}`):null})),error:null}}catch(a){if(_t(a))return{data:null,error:a};throw a}})}download(t,r){return er(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),i=s?`?${s}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield Kl(this.fetch,`${this.url}/${a}/${o}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(_t(o))return{data:null,error:o};throw o}})}info(t){return er(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield Kl(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:A0(n),error:null}}catch(n){if(_t(n))return{data:null,error:n};throw n}})}exists(t){return er(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield Jy(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(_t(n)&&n instanceof T0){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&a.push(s);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&a.push(l);let c=a.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return er(this,void 0,void 0,function*(){try{return{data:yield Nm(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(_t(r))return{data:null,error:r};throw r}})}list(t,r,n){return er(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},Qy),r),{prefix:t||""});return{data:yield nn(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(_t(a))return{data:null,error:a};throw a}})}listV2(t,r){return er(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield nn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(_t(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const e_="2.11.0",t_={"X-Client-Info":`storage-js/${e_}`};var Ka=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class r_{constructor(t,r={},n,a){const s=new URL(t);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href,this.headers=Object.assign(Object.assign({},t_),r),this.fetch=Cm(n)}listBuckets(){return Ka(this,void 0,void 0,function*(){try{return{data:yield Kl(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(_t(t))return{data:null,error:t};throw t}})}getBucket(t){return Ka(this,void 0,void 0,function*(){try{return{data:yield Kl(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(_t(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return Ka(this,void 0,void 0,function*(){try{return{data:yield nn(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(_t(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return Ka(this,void 0,void 0,function*(){try{return{data:yield C0(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(_t(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Ka(this,void 0,void 0,function*(){try{return{data:yield nn(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(_t(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ka(this,void 0,void 0,function*(){try{return{data:yield Nm(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(_t(r))return{data:null,error:r};throw r}})}}class n_ extends r_{constructor(t,r={},n,a){super(t,r,n,a)}from(t){return new Zy(this.url,this.headers,t,this.fetch)}}const a_="2.55.0";let oi="";typeof Deno<"u"?oi="deno":typeof document<"u"?oi="web":typeof navigator<"u"&&navigator.product==="ReactNative"?oi="react-native":oi="node";const s_={"X-Client-Info":`supabase-js-${oi}/${a_}`},i_={headers:s_},o_={schema:"public"},l_={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},c_={};var u_=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const f_=e=>{let t;return e?t=e:typeof fetch>"u"?t=hm:t=fetch,(...r)=>t(...r)},d_=()=>typeof Headers>"u"?pm:Headers,h_=(e,t,r)=>{const n=f_(r),a=d_();return(s,i)=>u_(void 0,void 0,void 0,function*(){var o;const l=(o=yield t())!==null&&o!==void 0?o:e;let c=new a(i==null?void 0:i.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},i),{headers:c}))})};var p_=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};function x_(e){return e.endsWith("/")?e:e+"/"}function m_(e,t){var r,n;const{db:a,auth:s,realtime:i,global:o}=e,{db:l,auth:c,realtime:u,global:f}=t,d={db:Object.assign(Object.assign({},l),a),auth:Object.assign(Object.assign({},c),s),realtime:Object.assign(Object.assign({},u),i),storage:{},global:Object.assign(Object.assign(Object.assign({},f),o),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>p_(this,void 0,void 0,function*(){return""})};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}const bm="2.71.1",Za=30*1e3,N0=3,pu=N0*Za,g_="http://localhost:9999",v_="supabase.auth.token",w_={"X-Client-Info":`gotrue-js/${bm}`},b0="X-Supabase-Api-Version",Fm={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},y_=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,__=10*60*1e3;class zf extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Fe(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class k_ extends zf{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function E_(e){return Fe(e)&&e.name==="AuthApiError"}class Om extends zf{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class ua extends zf{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class jn extends ua{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function S_(e){return Fe(e)&&e.name==="AuthSessionMissingError"}class qo extends ua{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Jo extends ua{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Qo extends ua{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function T_(e){return Fe(e)&&e.name==="AuthImplicitGrantRedirectError"}class jh extends ua{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class F0 extends ua{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function xu(e){return Fe(e)&&e.name==="AuthRetryableFetchError"}class Lh extends ua{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class O0 extends ua{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Xl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Mh=` 	
\r=`.split(""),A_=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Mh.length;t+=1)e[Mh[t].charCodeAt(0)]=-2;for(let t=0;t<Xl.length;t+=1)e[Xl[t].charCodeAt(0)]=t;return e})();function Bh(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Xl[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Xl[n]),t.queuedBits-=6}}function Pm(e,t,r){const n=A_[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Uh(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=i=>{b_(i,n,r)};for(let i=0;i<e.length;i+=1)Pm(e.charCodeAt(i),a,s);return t.join("")}function C_(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function N_(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}C_(n,t)}}function b_(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function F_(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)Pm(e.charCodeAt(a),r,n);return new Uint8Array(t)}function O_(e){const t=[];return N_(e,r=>t.push(r)),new Uint8Array(t)}function P_(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>Bh(a,r,n)),Bh(null,r,n),t.join("")}function R_(e){return Math.round(Date.now()/1e3)+e}function D_(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const $r=()=>typeof window<"u"&&typeof document<"u",ha={tested:!1,writable:!1},Rm=()=>{if(!$r())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ha.tested)return ha.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),ha.tested=!0,ha.writable=!0}catch{ha.tested=!0,ha.writable=!1}return ha.writable};function I_(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,s)=>{t[s]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const Dm=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>fo(async()=>{const{default:n}=await Promise.resolve().then(()=>Ls);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},j_=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",es=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},pa=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Rn=async(e,t)=>{await e.removeItem(t)};class Pc{constructor(){this.promise=new Pc.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Pc.promiseConstructor=Promise;function mu(e){const t=e.split(".");if(t.length!==3)throw new O0("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!y_.test(t[n]))throw new O0("JWT not in base64url format");return{header:JSON.parse(Uh(t[0])),payload:JSON.parse(Uh(t[1])),signature:F_(t[2]),raw:{header:t[0],payload:t[1]}}}async function L_(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function M_(e,t){return new Promise((n,a)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await e(s);if(!t(s,null,i)){n(i);return}}catch(i){if(!t(s,i)){a(i);return}}})()})}function B_(e){return("0"+e.toString(16)).substr(-2)}function U_(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let s=0;s<56;s++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,B_).join("")}async function $_(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(s=>String.fromCharCode(s)).join("")}async function z_(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await $_(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Xa(e,t,r=!1){const n=U_();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await es(e,`${t}-code-verifier`,a);const s=await z_(n);return[s,n===s?"plain":"s256"]}const H_=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function V_(e){const t=e.headers.get(b0);if(!t||!t.match(H_))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function W_(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function G_(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const K_=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ya(e){if(!K_.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function gu(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function $h(e){return JSON.parse(JSON.stringify(e))}var X_=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const va=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Y_=[502,503,504];async function zh(e){var t;if(!j_(e))throw new F0(va(e),0);if(Y_.includes(e.status))throw new F0(va(e),e.status);let r;try{r=await e.json()}catch(s){throw new Om(va(s),s)}let n;const a=V_(e);if(a&&a.getTime()>=Fm["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Lh(va(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new jn}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new Lh(va(r),e.status,r.weak_password.reasons);throw new k_(va(r),e.status||500,n)}const q_=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function De(e,t,r,n){var a;const s=Object.assign({},n==null?void 0:n.headers);s[b0]||(s[b0]=Fm["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const i=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(i.redirect_to=n.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await J_(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function J_(e,t,r,n,a,s){const i=q_(t,n,a,s);let o;try{o=await e(r,Object.assign({},i))}catch(l){throw console.error(l),new F0(va(l),0)}if(o.ok||await zh(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await zh(l)}}function pn(e){var t;let r=null;tk(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=R_(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Hh(e){const t=pn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function $n(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Q_(e){return{data:e,error:null}}function Z_(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s}=e,i=X_(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s},l=Object.assign({},i);return{data:{properties:o,user:l},error:null}}function ek(e){return e}function tk(e){return e.access_token&&e.refresh_token&&e.expires_in}const vu=["global","local","others"];var rk=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class nk{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=Dm(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=vu[0]){if(vu.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${vu.join(", ")}`);try{return await De(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Fe(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await De(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:$n})}catch(n){if(Fe(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=rk(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await De(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:Z_,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Fe(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await De(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:$n})}catch(r){if(Fe(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,s,i,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await De(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:ek});if(u.error)throw u.error;const f=await u.json(),d=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(x=>{const m=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(x.split(";")[1].split("=")[1]);c[`${v}Page`]=m}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(Fe(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){Ya(t);try{return await De(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:$n})}catch(r){if(Fe(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Ya(t);try{return await De(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:$n})}catch(n){if(Fe(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Ya(t);try{return await De(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:$n})}catch(n){if(Fe(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Ya(t.userId);try{const{data:r,error:n}=await De(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Fe(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Ya(t.userId),Ya(t.id);try{return{data:await De(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Fe(r))return{data:null,error:r};throw r}}}function Vh(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function ak(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const qa={debug:!!(globalThis&&Rm()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Im extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class sk extends Im{}async function ik(e,t,r){qa.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),qa.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){qa.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{qa.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw qa.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new sk(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(qa.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}ak();const ok={url:g_,storageKey:v_,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:w_,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Wh(e,t,r){return await r()}const Ja={};class qi{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=qi.nextInstanceID,qi.nextInstanceID+=1,this.instanceID>0&&$r()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},ok),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new nk({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=Dm(a.fetch),this.lock=a.lock||Wh,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:$r()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=ik:this.lock=Wh,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:Rm()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Vh(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Vh(this.memoryStorage)),$r()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=Ja[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Ja[this.storageKey]=Object.assign(Object.assign({},Ja[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Ja[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Ja[this.storageKey]=Object.assign(Object.assign({},Ja[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${bm}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=I_(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),$r()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),T_(s)){const l=(t=s.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Fe(r)?{error:r}:{error:new Om("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const s=await De(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:pn}),{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(Fe(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var r,n,a;try{let s;if("email"in t){const{email:u,password:f,options:d}=t;let p=null,x=null;this.flowType==="pkce"&&([p,x]=await Xa(this.storage,this.storageKey)),s=await De(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:u,password:f,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:p,code_challenge_method:x},xform:pn})}else if("phone"in t){const{phone:u,password:f,options:d}=t;s=await De(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},channel:(a=d==null?void 0:d.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:pn})}else throw new Jo("You must provide either an email or phone number and a password");const{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(Fe(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:i,options:o}=t;r=await De(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Hh})}else if("phone"in t){const{phone:s,password:i,options:o}=t;r=await De(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Hh})}else throw new Jo("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new qo}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Fe(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,a,s,i,o,l,c,u,f,d,p;let x,m;if("message"in t)x=t.message,m=t.signature;else{const{chain:v,wallet:w,statement:y,options:g}=t;let E;if($r())if(typeof w=="object")E=w;else{const T=window;if("solana"in T&&typeof T.solana=="object"&&("signIn"in T.solana&&typeof T.solana.signIn=="function"||"signMessage"in T.solana&&typeof T.solana.signMessage=="function"))E=T.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!(g!=null&&g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=w}const P=new URL((r=g==null?void 0:g.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in E&&E.signIn){const T=await E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},g==null?void 0:g.signInWithSolana),{version:"1",domain:P.host,uri:P.href}),y?{statement:y}:null));let k;if(Array.isArray(T)&&T[0]&&typeof T[0]=="object")k=T[0];else if(T&&typeof T=="object"&&"signedMessage"in T&&"signature"in T)k=T;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)x=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),m=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${P.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${P.href}`,`Issued At: ${(a=(n=g==null?void 0:g.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((s=g==null?void 0:g.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...!((i=g==null?void 0:g.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...!((o=g==null?void 0:g.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...!((l=g==null?void 0:g.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...!((c=g==null?void 0:g.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...!((f=(u=g==null?void 0:g.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",...g.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const T=await E.signMessage(new TextEncoder().encode(x),"utf8");if(!T||!(T instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=T}}try{const{data:v,error:w}=await De(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:P_(m)},!((d=t.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:pn});if(w)throw w;return!v||!v.session||!v.user?{data:{user:null,session:null},error:new qo}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),{data:Object.assign({},v),error:w})}catch(v){if(Fe(v))return{data:{user:null,session:null},error:v};throw v}}async _exchangeCodeForSession(t){const r=await pa(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:s,error:i}=await De(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:pn});if(await Rn(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new qo}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:a??null}),error:i})}catch(s){if(Fe(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:s,nonce:i}=t,o=await De(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:pn}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new qo}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(Fe(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,s,i;try{if("email"in t){const{email:o,options:l}=t;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Xa(this.storage,this.storageKey));const{error:f}=await De(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:u}=await De(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=l==null?void 0:l.data)!==null&&a!==void 0?a:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(i=l==null?void 0:l.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Jo("You must provide either an email or phone number.")}catch(o){if(Fe(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let a,s;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:o}=await De(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:pn});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,c=i.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(a){if(Fe(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let s=null,i=null;return this.flowType==="pkce"&&([s,i]=await Xa(this.storage,this.storageKey)),await De(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:Q_})}catch(s){if(Fe(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new jn;const{error:a}=await De(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(Fe(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:s}=t,{error:i}=await De(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in t){const{phone:n,type:a,options:s}=t,{data:i,error:o}=await De(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new Jo("You must provide either an email or phone number and a type")}catch(r){if(Fe(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await pa(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<pu:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const i=await pa(this.userStorage,this.storageKey+"-user");i!=null&&i.user?t.user=i.user:t.user=gu()}if(this.storage.isServer&&t.user){let i=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,c,u)=>(!i&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:t},error:null}}const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await De(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:$n}):await this._useSession(async r=>{var n,a,s;const{data:i,error:o}=r;if(o)throw o;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new jn}:await De(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0,xform:$n})})}catch(r){if(Fe(r))return S_(r)&&(await this._removeSession(),await Rn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:s}=n;if(s)throw s;if(!a.session)throw new jn;const i=a.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await Xa(this.storage,this.storageKey));const{data:c,error:u}=await De(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:i.access_token,xform:$n});if(u)throw u;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(n){if(Fe(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new jn;const r=Date.now()/1e3;let n=r,a=!0,s=null;const{payload:i}=mu(t.access_token);if(i.exp&&(n=i.exp,a=n<=r),a){const{session:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(Fe(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:i,error:o}=r;if(o)throw o;t=(n=i.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new jn;const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Fe(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!$r())throw new Qo("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Qo(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new jh("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Qo("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new jh("No code detected.");const{data:y,error:g}=await this._exchangeCodeForSession(t.code);if(g)throw g;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:s,refresh_token:i,expires_in:o,expires_at:l,token_type:c}=t;if(!s||!o||!i||!c)throw new Qo("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(o);let d=u+f;l&&(d=parseInt(l));const p=d-u;p*1e3<=Za&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${f}s`);const x=d-f;u-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,d,u):u-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,d,u);const{data:m,error:v}=await this._getUser(s);if(v)throw v;const w={provider_token:n,provider_refresh_token:a,access_token:s,expires_in:f,expires_at:d,refresh_token:i,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:w,redirectType:t.type},error:null}}catch(n){if(Fe(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await pa(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{error:s};const i=(n=a.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:o}=await this.admin.signOut(i,t);if(o&&!(E_(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await Rn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=D_(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:s},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await Xa(this.storage,this.storageKey,!0));try{return await De(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(Fe(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Fe(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:a}=await this._useSession(async s=>{var i,o,l,c,u;const{data:f,error:d}=s;if(d)throw d;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await De(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(c=f.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return $r()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Fe(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)throw i;return await De(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Fe(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await M_(async a=>(a>0&&await L_(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await De(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:pn})),(a,s)=>{const i=200*Math.pow(2,a);return s&&xu(s)&&Date.now()+i-n<Za})}catch(n){if(this._debug(r,"error",n),Fe(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),$r()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await pa(this.storage,this.storageKey);if(a&&this.userStorage){let i=await pa(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:a.user},await es(this.userStorage,this.storageKey+"-user",i)),a.user=(t=i==null?void 0:i.user)!==null&&t!==void 0?t:gu()}else if(a&&!a.user&&!a.user){const i=await pa(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(a.user=i.user,await Rn(this.storage,this.storageKey+"-user"),await es(this.storage,this.storageKey,a)):a.user=gu()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const s=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<pu;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${pu}s`),s){if(this.autoRefreshToken&&a.refresh_token){const{error:i}=await this._callRefreshToken(a.refresh_token);i&&(console.error(i),xu(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:o}=await this._getUser(a.access_token);!o&&(i!=null&&i.user)?(a.user=i.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(n,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new jn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Pc;const{data:s,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!s.session)throw new jn;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(a,"error",s),Fe(s)){const i={session:null,error:s};return xu(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){s.push(l)}});if(await Promise.all(i),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await es(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const s=$h(a);await es(this.storage,this.storageKey,s)}else{const a=$h(r);await es(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await Rn(this.storage,this.storageKey),await Rn(this.storage,this.storageKey+"-code-verifier"),await Rn(this.storage,this.storageKey+"-user"),this.userStorage&&await Rn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&$r()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Za);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/Za);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Za}ms, refresh threshold is ${N0} ticks`),a<=N0&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Im)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!$r()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,i]=await Xa(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});a.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);a.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await De(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Fe(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:c}=await De(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((a=l==null?void 0:l.totp)===null||a===void 0)&&a.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(Fe(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{data:null,error:s};const{data:i,error:o}=await De(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(r){if(Fe(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await De(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Fe(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],a=n.filter(i=>i.factor_type==="totp"&&i.status==="verified"),s=n.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:n,totp:a,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:s}=t;if(s)return{data:null,error:s};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=mu(a.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+__>a)return n;const{data:s,error:i}=await De(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=a,n=s.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:p,error:x}=await this.getSession();if(x||!p.session)return{data:null,error:x};n=p.session.access_token}const{header:a,payload:s,signature:i,raw:{header:o,payload:l}}=mu(n);r!=null&&r.allowExpired||W_(s.exp);const c=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:s,header:a,signature:i},error:null}}const u=G_(a.alg),f=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,i,O_(`${o}.${l}`)))throw new O0("Invalid JWT signature");return{data:{claims:s,header:a,signature:i},error:null}}catch(n){if(Fe(n))return{data:null,error:n};throw n}}}qi.nextInstanceID=0;const lk=qi;class ck extends lk{constructor(t){super(t)}}var uk=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class fk{constructor(t,r,n){var a,s,i;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=x_(t),l=new URL(o);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:o_,realtime:c_,auth:Object.assign(Object.assign({},l_),{storageKey:c}),global:i_},f=m_(n??{},u);this.storageKey=(a=f.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=f.global.headers)!==null&&s!==void 0?s:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(d,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=f.auth)!==null&&i!==void 0?i:{},this.headers,f.global.fetch),this.fetch=h_(r,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new Cy(new URL("rest/v1",l).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),this.storage=new n_(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),f.accessToken||this._listenForAuthEvents()}get functions(){return new ny(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return uk(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,storageKey:s,flowType:i,lock:o,debug:l},c,u){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ck({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),c),storageKey:s,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,flowType:i,lock:o,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new Vy(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const dk=(e,t,r)=>new fk(e,t,r);function hk(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}hk()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const pk="https://evsykrdwgjxndpwzxehu.supabase.co",xk="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImV2c3lrcmR3Z2p4bmRwd3p4ZWh1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU3MTc0NjUsImV4cCI6MjA3MTI5MzQ2NX0.NPTP_WLPzfBpsj-zNtIecW4jaaDABNYZU9zqEpEcGsc",Gh=[];if(Gh.length)throw new Error(`Missing Supabase environment variables: ${Gh.join(", ")}`);const Pe=dk(pk,xk,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}});async function Yl(e){var t,r;if(!e)return e;try{const{data:n,error:a}=await Pe.from("users").select("role, tenant_id").eq("id",e.id).single();if(a||!(n!=null&&n.role))return e;const s=n.role,i=n.tenant_id;return(((t=e.user_metadata)==null?void 0:t.role)!==s||((r=e.user_metadata)==null?void 0:r.tenant_id)!==i)&&await Pe.auth.updateUser({data:{role:s,tenant_id:i}}).catch(()=>{}),{...e,user_metadata:{...e.user_metadata,role:s,tenant_id:i}}}catch(n){return console.error("[Auth] ensureUserRole error",n),e}}async function jm({email:e,password:t}){var n;const r=e==null?void 0:e.split("@")[1];r&&console.log("[Auth] login attempt",{emailDomain:r});try{const a=await Pe.auth.signInWithPassword({email:e,password:t});return!a.error&&((n=a.data)!=null&&n.session)&&await Pe.auth.updateUser({data:{last_login_at:new Date().toISOString()}}).catch(()=>{}),a}catch(a){throw console.error("[Auth] login error",a),a}}async function mk({email:e,password:t,profileUrl:r,phone:n,locale:a,consents:s}){const i=e==null?void 0:e.split("@")[1];i&&console.log("[Auth] signup attempt",{emailDomain:i});try{return await Pe.auth.signUp({email:e,password:t,phone:n,options:{emailRedirectTo:`${window.location.origin}/confirm`,data:{role:"user",profile_url:r,locale:a,consents:s}}})}catch(o){throw console.error("[Auth] signup error",o),o}}async function gk({email:e,password:t,phone:r,locale:n}){const a=e==null?void 0:e.split("@")[1];a&&console.log("[Auth] super admin signup attempt",{emailDomain:a});try{return await Pe.auth.signUp({email:e,password:t,phone:r,options:{emailRedirectTo:`${window.location.origin}/confirm`,data:{role:"super_admin",locale:n}}})}catch(s){throw console.error("[Auth] super admin signup error",s),s}}function xo(){return console.log("[Auth] logout"),Pe.auth.signOut().then(e=>(console.log("[Auth] logout response",e),e)).catch(e=>{throw console.error("[Auth] logout error",e),e})}const Lm=J.createContext({user:void 0,loading:!0});function xa({children:e}){const[t,r]=J.useState(void 0),[n,a]=J.useState(!0);return J.useEffect(()=>{let s=!0;console.log("[AuthContext] initializing"),Pe.auth.getSession().then(({data:o,error:l})=>{var u;const c=l?null:((u=o==null?void 0:o.session)==null?void 0:u.user)??null;l&&l.name!=="AuthSessionMissingError"?console.error("[AuthContext] getSession error",l):l||console.log("[AuthContext] getSession",c),s&&(r(c),a(!1)),Yl(c).then(f=>{s&&r(f)}).catch(f=>{console.error("[AuthContext] ensureUserRole(getSession) error",f)})}).catch(o=>{console.error("[AuthContext] getSession unexpected error",o),s&&(r(null),a(!1))});const{data:{subscription:i}}=Pe.auth.onAuthStateChange((o,l)=>{console.log("[AuthContext] auth state change",{event:o,session:l});const c=(l==null?void 0:l.user)??null;s&&(r(c),a(!1)),Yl(c).then(u=>{s&&r(u)}).catch(u=>{console.error("[AuthContext] ensureUserRole(onAuthStateChange) error",u)})});return()=>{s=!1,console.log("[AuthContext] unsubscribing"),i.unsubscribe()}},[]),h.jsx(Lm.Provider,{value:{user:t,loading:n},children:e})}function Rc(){return J.useContext(Lm)}/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vk=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Mm=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var wk={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yk=J.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:s,iconNode:i,...o},l)=>J.createElement("svg",{ref:l,...wk,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:Mm("lucide",a),...o},[...i.map(([c,u])=>J.createElement(c,u)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=(e,t)=>{const r=J.forwardRef(({className:n,...a},s)=>J.createElement(yk,{ref:s,iconNode:t,className:Mm(`lucide-${vk(e)}`,n),...a}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _k=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Kh=Ke("Check",_k);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kk=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Ek=Ke("CircleCheckBig",kk);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sk=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ql=Ke("CircleHelp",Sk);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tk=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Ak=Ke("CircleX",Tk);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ck=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],Nk=Ke("FileUp",Ck);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bk=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Fk=Ke("History",bk);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ok=[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]],Pk=Ke("KeyRound",Ok);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rk=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Dk=Ke("Key",Rk);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ik=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Hf=Ke("LoaderCircle",Ik);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jk=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],Lk=Ke("LogOut",jk);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mk=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],kl=Ke("Package",Mk);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bk=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],Uk=Ke("Play",Bk);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $k=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Jl=Ke("Plus",$k);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zk=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Zo=Ke("RefreshCw",zk);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hk=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Vk=Ke("Save",Hk);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wk=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],Gk=Ke("Search",Wk);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kk=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Xk=Ke("Send",Kk);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yk=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],qk=Ke("Settings",Yk);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jk=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Qk=Ke("Shield",Jk);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zk=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]],eE=Ke("ToggleLeft",Zk);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tE=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]],rE=Ke("ToggleRight",tE);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nE=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Ql=Ke("Trash2",nE);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aE=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],Vf=Ke("Upload",aE);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sE=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],iE=Ke("User",sE);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oE=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],Bm=Ke("Users",oE);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lE=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],cE=Ke("X",lE);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uE=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Um=Ke("Zap",uE);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var $m=1252,fE=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Wf={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Gf=function(e){fE.indexOf(e)!=-1&&($m=Wf[0]=e)};function dE(){Gf(1252)}var Kr=function(e){Gf(e)};function zm(){Kr(1200),dE()}function Xh(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function hE(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function Hm(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var li=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?hE(e.slice(2)):t==254&&r==255?Hm(e.slice(2)):t==65279?e.slice(1):e},el=function(t){return String.fromCharCode(t)},Yh=function(t){return String.fromCharCode(t)},Ji,Wn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function qh(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),i=(r&3)<<4|n>>4,a=e.charCodeAt(c++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=Wn.charAt(s)+Wn.charAt(i)+Wn.charAt(o)+Wn.charAt(l);return t}function Er(e){var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=Wn.indexOf(e.charAt(c++)),i=Wn.indexOf(e.charAt(c++)),r=s<<2|i>>4,t+=String.fromCharCode(r),o=Wn.indexOf(e.charAt(c++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Wn.indexOf(e.charAt(c++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var Le=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ua=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function sa(e){return Le?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Jh(e){return Le?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Gr=function(t){return Le?Ua(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function $a(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Kf(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Kf(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var zn=Le?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ua(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function pE(e){for(var t=[],r=0,n=e.length+250,a=sa(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++s)&1023;a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|o>>6&15|(i&3)<<4,a[r++]=128|o&63}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|i&63;r>n&&(t.push(a.slice(0,r)),r=0,a=sa(65535),n=65530)}return t.push(a.slice(0,r)),zn(t)}var ir=/\u0000/g,ci=/[\u0001-\u0006]/g;function _s(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Xr(e,t){var r=""+e;return r.length>=t?r:ut("0",t-r.length)+r}function Xf(e,t){var r=""+e;return r.length>=t?r:ut(" ",t-r.length)+r}function Zl(e,t){var r=""+e;return r.length>=t?r:r+ut(" ",t-r.length)}function xE(e,t){var r=""+Math.round(e);return r.length>=t?r:ut("0",t-r.length)+r}function mE(e,t){var r=""+e;return r.length>=t?r:ut("0",t-r.length)+r}var Qh=Math.pow(2,32);function Qa(e,t){if(e>Qh||e<-Qh)return xE(e,t);var r=Math.round(e);return mE(r,t)}function ec(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Zh=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],wu=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function gE(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Oe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},ep={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},vE={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function tc(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,o=0,l=1,c=0,u=0,f=Math.floor(a);c<t&&(f=Math.floor(a),o=f*i+s,u=f*c+l,!(a-f<5e-8));)a=1/(a-f),s=i,i=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=s):(u=c,o=i)),!r)return[0,n*o,u];var d=Math.floor(n*o/u);return[d,n*o-d*u,u]}function Sa(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=SE(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var Vm=new Date(1899,11,31,0,0,0),wE=Vm.getTime(),yE=new Date(1900,2,1,0,0,0);function Wm(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=yE&&(r+=24*60*60*1e3),(r-(wE+(e.getTimezoneOffset()-Vm.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Yf(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function _E(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function kE(e){var t=e<0?12:11,r=Yf(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function EE(e){var t=Yf(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Qi(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=kE(e):t===10?r=e.toFixed(10).substr(0,12):r=EE(e),Yf(_E(r.toUpperCase()))}function Da(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Qi(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return jr(14,Wm(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function SE(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function TE(e,t,r,n){var a="",s=0,i=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return wu[r.m-1][1];case 5:return wu[r.m-1][0];default:return wu[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return Zh[r.q][0];default:return Zh[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Xr(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(a=Xr(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?Xr(l,c):"";return u}function Gn(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Gm=/%/g;function AE(e,t,r){var n=t.replace(Gm,""),a=t.length-n.length;return En(e,n,r*Math.pow(10,2*a))+ut("%",a)}function CE(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return En(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Km(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Km(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+s)%a)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Xm=/# (\?+)( ?)\/( ?)(\d+)/;function NE(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,o=n;return r+(s===0?"":""+s)+" "+(i===0?ut(" ",e[1].length+1+e[4].length):Xf(i,e[1].length)+e[2]+"/"+e[3]+Xr(o,e[4].length))}function bE(e,t,r){return r+(t===0?"":""+t)+ut(" ",e[1].length+2+e[4].length)}var Ym=/^#*0*\.([0#]+)/,qm=/\).*[0#]/,Jm=/\(###\) ###\\?-####/;function rr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function tp(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function rp(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function FE(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function OE(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Cr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(qm)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Cr("n",n,r):"("+Cr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return CE(e,t,r);if(t.indexOf("%")!==-1)return AE(e,t,r);if(t.indexOf("E")!==-1)return Km(t,r);if(t.charCodeAt(0)===36)return"$"+Cr(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Qa(l,t.length);if(t.match(/^[#?]+$/))return a=Qa(r,0),a==="0"&&(a=""),a.length>t.length?a:rr(t.substr(0,t.length-a.length))+a;if(s=t.match(Xm))return NE(s,l,c);if(t.match(/^#+0+$/))return c+Qa(l,t.length-t.indexOf("0"));if(s=t.match(Ym))return a=tp(r,s[1].length).replace(/^([^\.]+)$/,"$1."+rr(s[1])).replace(/\.$/,"."+rr(s[1])).replace(/\.(\d*)$/,function(x,m){return"."+m+ut("0",rr(s[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+tp(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Gn(Qa(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Cr(e,t,-r):Gn(""+(Math.floor(r)+FE(r,s[1].length)))+"."+Xr(rp(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Cr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=_s(Cr(e,t.replace(/[\\-]/g,""),r)),i=0,_s(_s(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<a.length?a.charAt(i++):x==="0"?"0":""}));if(t.match(Jm))return a=Cr(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=tc(l,Math.pow(10,i)-1,!1),a=""+c,u=En("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=Zl(o[2],i),u.length<s[4].length&&(u=rr(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=tc(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Xf(o[1],i)+s[2]+"/"+s[3]+Zl(o[2],i):ut(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=Qa(r,0),t.length<=a.length?a:rr(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var f=t.indexOf(".")-i,d=t.length-a.length-f;return rr(t.substr(0,f)+a+t.substr(t.length-d))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=rp(r,s[1].length),r<0?"-"+Cr(e,t,-r):Gn(OE(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Xr(0,3-x.length):"")+x})+"."+Xr(i,s[1].length);switch(t){case"###,##0.00":return Cr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Gn(Qa(l,0));return p!=="0"?c+p:"";case"###,###.00":return Cr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Cr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function PE(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return En(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function RE(e,t,r){var n=t.replace(Gm,""),a=t.length-n.length;return En(e,n,r*Math.pow(10,2*a))+ut("%",a)}function Qm(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Qm(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+s)%a)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function tn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(qm)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?tn("n",n,r):"("+tn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return PE(e,t,r);if(t.indexOf("%")!==-1)return RE(e,t,r);if(t.indexOf("E")!==-1)return Qm(t,r);if(t.charCodeAt(0)===36)return"$"+tn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Xr(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:rr(t.substr(0,t.length-a.length))+a;if(s=t.match(Xm))return bE(s,l,c);if(t.match(/^#+0+$/))return c+Xr(l,t.length-t.indexOf("0"));if(s=t.match(Ym))return a=(""+r).replace(/^([^\.]+)$/,"$1."+rr(s[1])).replace(/\.$/,"."+rr(s[1])),a=a.replace(/\.(\d*)$/,function(x,m){return"."+m+ut("0",rr(s[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Gn(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+tn(e,t,-r):Gn(""+r)+"."+ut("0",s[1].length);if(s=t.match(/^#,#*,#0/))return tn(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=_s(tn(e,t.replace(/[\\-]/g,""),r)),i=0,_s(_s(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<a.length?a.charAt(i++):x==="0"?"0":""}));if(t.match(Jm))return a=tn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=tc(l,Math.pow(10,i)-1,!1),a=""+c,u=En("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=Zl(o[2],i),u.length<s[4].length&&(u=rr(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=tc(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Xf(o[1],i)+s[2]+"/"+s[3]+Zl(o[2],i):ut(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:rr(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var f=t.indexOf(".")-i,d=t.length-a.length-f;return rr(t.substr(0,f)+a+t.substr(t.length-d))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+tn(e,t,-r):Gn(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Xr(0,3-x.length):"")+x})+"."+Xr(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Gn(""+l);return p!=="0"?c+p:"";default:if(t.match(/\.[0#?]*$/))return tn(e,t.slice(0,t.lastIndexOf(".")),r)+rr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function En(e,t,r){return(r|0)===r?tn(e,t,r):Cr(e,t,r)}function DE(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Zm=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Bs(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":ec(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Zm))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function IE(e,t,r,n){for(var a=[],s="",i=0,o="",l="t",c,u,f,d="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!ec(e,i))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(f=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(f);a[a.length]={t:"t",v:s},++i;break;case"\\":var p=e.charAt(++i),x=p==="("||p===")"?p:"t";a[a.length]={t:x,v:p},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(c==null&&(c=Sa(t,r,e.charAt(i+1)==="2"),c==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=Sa(t,r),c==null))return"";for(s=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),a[a.length]={t:o,v:s},l=o;break;case"A":case"a":case"上":var m={t:o,v:o};if(c==null&&(c=Sa(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",d="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",i+=5,d="h"):e.substr(i,5).toUpperCase()==="上午/下午"?(c!=null&&(m.v=c.H>=12?"下午":"上午"),m.t="T",i+=5,d="h"):(m.t="t",++i),c==null&&m.t==="T")return"";a[a.length]=m,l=o;break;case"[":for(s=o;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Zm)){if(c==null&&(c=Sa(t,r),c==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Bs(e)||(a[a.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++i<e.length&&(o=e.charAt(i))==="0";)s+=o;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)s+=o;a[a.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++i)===o;)s+=o;a[a.length]={t:o,v:s},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:o,v:o},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++i;break}var v=0,w=0,y;for(i=a.length-1,l="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=d,l="h",v<1&&(v=1);break;case"s":(y=a[i].v.match(/\.0+$/))&&(w=Math.max(w,y[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":l=a[i].t;break;case"m":l==="s"&&(a[i].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&a[i].v.match(/[Hh]/)&&(v=1),v<2&&a[i].v.match(/[Mm]/)&&(v=2),v<3&&a[i].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var g="",E;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=TE(a[i].t.charCodeAt(0),a[i].v,c,w),a[i].t="t";break;case"n":case"?":for(E=i+1;a[E]!=null&&((o=a[E].t)==="?"||o==="D"||(o===" "||o==="t")&&a[E+1]!=null&&(a[E+1].t==="?"||a[E+1].t==="t"&&a[E+1].v==="/")||a[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[E].v==="/"||a[E].v===" "&&a[E+1]!=null&&a[E+1].t=="?"));)a[i].v+=a[E].v,a[E]={v:"",t:";"},++E;g+=a[i].v,i=E-1;break;case"G":a[i].t="t",a[i].v=Da(t,r);break}var P="",T,k;if(g.length>0){g.charCodeAt(0)==40?(T=t<0&&g.charCodeAt(0)===45?-t:t,k=En("n",g,T)):(T=t<0&&n>1?-t:t,k=En("n",g,T),T<0&&a[0]&&a[0].t=="t"&&(k=k.substr(1),a[0].v="-"+a[0].v)),E=k.length-1;var I=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){I=i;break}var R=a.length;if(I===a.length&&k.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(E>=a[i].v.length-1?(E-=a[i].v.length,a[i].v=k.substr(E+1,a[i].v.length)):E<0?a[i].v="":(a[i].v=k.substr(0,E+1),E=-1),a[i].t="t",R=i);E>=0&&R<a.length&&(a[R].v=k.substr(0,E+1)+a[R].v)}else if(I!==a.length&&k.indexOf("E")===-1){for(E=k.indexOf(".")-1,i=I;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(u=a[i].v.indexOf(".")>-1&&i===I?a[i].v.indexOf(".")-1:a[i].v.length-1,P=a[i].v.substr(u+1);u>=0;--u)E>=0&&(a[i].v.charAt(u)==="0"||a[i].v.charAt(u)==="#")&&(P=k.charAt(E--)+P);a[i].v=P,a[i].t="t",R=i}for(E>=0&&R<a.length&&(a[R].v=k.substr(0,E+1)+a[R].v),E=k.indexOf(".")+1,i=I;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==I)){for(u=a[i].v.indexOf(".")>-1&&i===I?a[i].v.indexOf(".")+1:0,P=a[i].v.substr(0,u);u<a[i].v.length;++u)E<k.length&&(P+=k.charAt(E++));a[i].v=P,a[i].t="t",R=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(T=n>1&&t<0&&i>0&&a[i-1].v==="-"?-t:t,a[i].v=En(a[i].t,a[i].v,T),a[i].t="t");var U="";for(i=0;i!==a.length;++i)a[i]!=null&&(U+=a[i].v);return U}var np=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ap(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function jE(e,t){var r=DE(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(np),o=r[1].match(np);return ap(t,i)?[n,r[0]]:ap(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,s]}function jr(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Oe)[e],n==null&&(n=r.table&&r.table[ep[e]]||Oe[ep[e]]),n==null&&(n=vE[e]||"General");break}if(ec(n,0))return Da(t,r);t instanceof Date&&(t=Wm(t,r.date1904));var a=jE(n,t);if(ec(a[1]))return Da(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return IE(a[1],t,r,a[0])}function Ca(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Oe[r]==null){t<0&&(t=r);continue}if(Oe[r]==e){t=r;break}}t<0&&(t=391)}return Oe[t]=e,t}function eg(){Oe=gE()}var LE={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},tg=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function ME(e){var t=typeof e=="number"?Oe[e]:e;return t=t.replace(tg,"(\\d+)"),new RegExp("^"+t+"$")}function BE(e,t,r){var n=-1,a=-1,s=-1,i=-1,o=-1,l=-1;(t.match(tg)||[]).forEach(function(f,d){var p=parseInt(r[d+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=p;break;case"d":s=p;break;case"h":i=p;break;case"s":l=p;break;case"m":i>=0?o=p:a=p;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?c:n==-1&&a==-1&&s==-1?u:c+"T"+u}var UE=function(){var e={};e.version="1.2.0";function t(){for(var k=0,I=new Array(256),R=0;R!=256;++R)k=R,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,I[R]=k;return typeof Int32Array<"u"?new Int32Array(I):I}var r=t();function n(k){var I=0,R=0,U=0,z=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(U=0;U!=256;++U)z[U]=k[U];for(U=0;U!=256;++U)for(R=k[U],I=256+U;I<4096;I+=256)R=z[I]=R>>>8^k[R&255];var B=[];for(U=1;U!=16;++U)B[U-1]=typeof Int32Array<"u"?z.subarray(U*256,U*256+256):z.slice(U*256,U*256+256);return B}var a=n(r),s=a[0],i=a[1],o=a[2],l=a[3],c=a[4],u=a[5],f=a[6],d=a[7],p=a[8],x=a[9],m=a[10],v=a[11],w=a[12],y=a[13],g=a[14];function E(k,I){for(var R=I^-1,U=0,z=k.length;U<z;)R=R>>>8^r[(R^k.charCodeAt(U++))&255];return~R}function P(k,I){for(var R=I^-1,U=k.length-15,z=0;z<U;)R=g[k[z++]^R&255]^y[k[z++]^R>>8&255]^w[k[z++]^R>>16&255]^v[k[z++]^R>>>24]^m[k[z++]]^x[k[z++]]^p[k[z++]]^d[k[z++]]^f[k[z++]]^u[k[z++]]^c[k[z++]]^l[k[z++]]^o[k[z++]]^i[k[z++]]^s[k[z++]]^r[k[z++]];for(U+=15;z<U;)R=R>>>8^r[(R^k[z++])&255];return~R}function T(k,I){for(var R=I^-1,U=0,z=k.length,B=0,ae=0;U<z;)B=k.charCodeAt(U++),B<128?R=R>>>8^r[(R^B)&255]:B<2048?(R=R>>>8^r[(R^(192|B>>6&31))&255],R=R>>>8^r[(R^(128|B&63))&255]):B>=55296&&B<57344?(B=(B&1023)+64,ae=k.charCodeAt(U++)&1023,R=R>>>8^r[(R^(240|B>>8&7))&255],R=R>>>8^r[(R^(128|B>>2&63))&255],R=R>>>8^r[(R^(128|ae>>6&15|(B&3)<<4))&255],R=R>>>8^r[(R^(128|ae&63))&255]):(R=R>>>8^r[(R^(224|B>>12&15))&255],R=R>>>8^r[(R^(128|B>>6&63))&255],R=R>>>8^r[(R^(128|B&63))&255]);return~R}return e.table=r,e.bstr=E,e.buf=P,e.str=T,e}(),Be=function(){var t={};t.version="1.2.1";function r(_,C){for(var S=_.split("/"),A=C.split("/"),N=0,O=0,G=Math.min(S.length,A.length);N<G;++N){if(O=S[N].length-A[N].length)return O;if(S[N]!=A[N])return S[N]<A[N]?-1:1}return S.length-A.length}function n(_){if(_.charAt(_.length-1)=="/")return _.slice(0,-1).indexOf("/")===-1?_:n(_.slice(0,-1));var C=_.lastIndexOf("/");return C===-1?_:_.slice(0,C+1)}function a(_){if(_.charAt(_.length-1)=="/")return a(_.slice(0,-1));var C=_.lastIndexOf("/");return C===-1?_:_.slice(C+1)}function s(_,C){typeof C=="string"&&(C=new Date(C));var S=C.getHours();S=S<<6|C.getMinutes(),S=S<<5|C.getSeconds()>>>1,_.write_shift(2,S);var A=C.getFullYear()-1980;A=A<<4|C.getMonth()+1,A=A<<5|C.getDate(),_.write_shift(2,A)}function i(_){var C=_.read_shift(2)&65535,S=_.read_shift(2)&65535,A=new Date,N=S&31;S>>>=5;var O=S&15;S>>>=4,A.setMilliseconds(0),A.setFullYear(S+1980),A.setMonth(O-1),A.setDate(N);var G=C&31;C>>>=5;var ee=C&63;return C>>>=6,A.setHours(C),A.setMinutes(ee),A.setSeconds(G<<1),A}function o(_){Dt(_,0);for(var C={},S=0;_.l<=_.length-4;){var A=_.read_shift(2),N=_.read_shift(2),O=_.l+N,G={};switch(A){case 21589:S=_.read_shift(1),S&1&&(G.mtime=_.read_shift(4)),N>5&&(S&2&&(G.atime=_.read_shift(4)),S&4&&(G.ctime=_.read_shift(4))),G.mtime&&(G.mt=new Date(G.mtime*1e3));break}_.l=O,C[A]=G}return C}var l;function c(){return l||(l={})}function u(_,C){if(_[0]==80&&_[1]==75)return Vs(_,C);if((_[0]|32)==109&&(_[1]|32)==105)return bo(_,C);if(_.length<512)throw new Error("CFB file size "+_.length+" < 512");var S=3,A=512,N=0,O=0,G=0,ee=0,W=0,K=[],X=_.slice(0,512);Dt(X,0);var le=f(X);switch(S=le[0],S){case 3:A=512;break;case 4:A=4096;break;case 0:if(le[1]==0)return Vs(_,C);default:throw new Error("Major Version: Expected 3 or 4 saw "+S)}A!==512&&(X=_.slice(0,A),Dt(X,28));var he=_.slice(0,A);d(X,S);var we=X.read_shift(4,"i");if(S===3&&we!==0)throw new Error("# Directory Sectors: Expected 0 saw "+we);X.l+=4,G=X.read_shift(4,"i"),X.l+=4,X.chk("00100000","Mini Stream Cutoff Size: "),ee=X.read_shift(4,"i"),N=X.read_shift(4,"i"),W=X.read_shift(4,"i"),O=X.read_shift(4,"i");for(var fe=-1,ve=0;ve<109&&(fe=X.read_shift(4,"i"),!(fe<0));++ve)K[ve]=fe;var Ce=p(_,A);v(W,O,Ce,A,K);var nt=y(Ce,G,K,A);nt[G].name="!Directory",N>0&&ee!==ae&&(nt[ee].name="!MiniFAT"),nt[K[0]].name="!FAT",nt.fat_addrs=K,nt.ssz=A;var at={},Ut=[],Ws=[],Gs=[];g(G,nt,Ce,Ut,N,at,Ws,ee),x(Ws,Gs,Ut),Ut.shift();var Ks={FileIndex:Ws,FullPaths:Gs};return C&&C.raw&&(Ks.raw={header:he,sectors:Ce}),Ks}function f(_){if(_[_.l]==80&&_[_.l+1]==75)return[0,0];_.chk(ge,"Header Signature: "),_.l+=16;var C=_.read_shift(2,"u");return[_.read_shift(2,"u"),C]}function d(_,C){var S=9;switch(_.l+=2,S=_.read_shift(2)){case 9:if(C!=3)throw new Error("Sector Shift: Expected 9 saw "+S);break;case 12:if(C!=4)throw new Error("Sector Shift: Expected 12 saw "+S);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+S)}_.chk("0600","Mini Sector Shift: "),_.chk("000000000000","Reserved: ")}function p(_,C){for(var S=Math.ceil(_.length/C)-1,A=[],N=1;N<S;++N)A[N-1]=_.slice(N*C,(N+1)*C);return A[S-1]=_.slice(S*C),A}function x(_,C,S){for(var A=0,N=0,O=0,G=0,ee=0,W=S.length,K=[],X=[];A<W;++A)K[A]=X[A]=A,C[A]=S[A];for(;ee<X.length;++ee)A=X[ee],N=_[A].L,O=_[A].R,G=_[A].C,K[A]===A&&(N!==-1&&K[N]!==N&&(K[A]=K[N]),O!==-1&&K[O]!==O&&(K[A]=K[O])),G!==-1&&(K[G]=A),N!==-1&&A!=K[A]&&(K[N]=K[A],X.lastIndexOf(N)<ee&&X.push(N)),O!==-1&&A!=K[A]&&(K[O]=K[A],X.lastIndexOf(O)<ee&&X.push(O));for(A=1;A<W;++A)K[A]===A&&(O!==-1&&K[O]!==O?K[A]=K[O]:N!==-1&&K[N]!==N&&(K[A]=K[N]));for(A=1;A<W;++A)if(_[A].type!==0){if(ee=A,ee!=K[ee])do ee=K[ee],C[A]=C[ee]+"/"+C[A];while(ee!==0&&K[ee]!==-1&&ee!=K[ee]);K[A]=-1}for(C[0]+="/",A=1;A<W;++A)_[A].type!==2&&(C[A]+="/")}function m(_,C,S){for(var A=_.start,N=_.size,O=[],G=A;S&&N>0&&G>=0;)O.push(C.slice(G*B,G*B+B)),N-=B,G=ya(S,G*4);return O.length===0?kt(0):zn(O).slice(0,_.size)}function v(_,C,S,A,N){var O=ae;if(_===ae){if(C!==0)throw new Error("DIFAT chain shorter than expected")}else if(_!==-1){var G=S[_],ee=(A>>>2)-1;if(!G)return;for(var W=0;W<ee&&(O=ya(G,W*4))!==ae;++W)N.push(O);v(ya(G,A-4),C-1,S,A,N)}}function w(_,C,S,A,N){var O=[],G=[];N||(N=[]);var ee=A-1,W=0,K=0;for(W=C;W>=0;){N[W]=!0,O[O.length]=W,G.push(_[W]);var X=S[Math.floor(W*4/A)];if(K=W*4&ee,A<4+K)throw new Error("FAT boundary crossed: "+W+" 4 "+A);if(!_[X])break;W=ya(_[X],K)}return{nodes:O,data:pp([G])}}function y(_,C,S,A){var N=_.length,O=[],G=[],ee=[],W=[],K=A-1,X=0,le=0,he=0,we=0;for(X=0;X<N;++X)if(ee=[],he=X+C,he>=N&&(he-=N),!G[he]){W=[];var fe=[];for(le=he;le>=0;){fe[le]=!0,G[le]=!0,ee[ee.length]=le,W.push(_[le]);var ve=S[Math.floor(le*4/A)];if(we=le*4&K,A<4+we)throw new Error("FAT boundary crossed: "+le+" 4 "+A);if(!_[ve]||(le=ya(_[ve],we),fe[le]))break}O[he]={nodes:ee,data:pp([W])}}return O}function g(_,C,S,A,N,O,G,ee){for(var W=0,K=A.length?2:0,X=C[_].data,le=0,he=0,we;le<X.length;le+=128){var fe=X.slice(le,le+128);Dt(fe,64),he=fe.read_shift(2),we=ed(fe,0,he-K),A.push(we);var ve={name:we,type:fe.read_shift(1),color:fe.read_shift(1),L:fe.read_shift(4,"i"),R:fe.read_shift(4,"i"),C:fe.read_shift(4,"i"),clsid:fe.read_shift(16),state:fe.read_shift(4,"i"),start:0,size:0},Ce=fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2);Ce!==0&&(ve.ct=E(fe,fe.l-8));var nt=fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2);nt!==0&&(ve.mt=E(fe,fe.l-8)),ve.start=fe.read_shift(4,"i"),ve.size=fe.read_shift(4,"i"),ve.size<0&&ve.start<0&&(ve.size=ve.type=0,ve.start=ae,ve.name=""),ve.type===5?(W=ve.start,N>0&&W!==ae&&(C[W].name="!StreamData")):ve.size>=4096?(ve.storage="fat",C[ve.start]===void 0&&(C[ve.start]=w(S,ve.start,C.fat_addrs,C.ssz)),C[ve.start].name=ve.name,ve.content=C[ve.start].data.slice(0,ve.size)):(ve.storage="minifat",ve.size<0?ve.size=0:W!==ae&&ve.start!==ae&&C[W]&&(ve.content=m(ve,C[W].data,(C[ee]||{}).data))),ve.content&&Dt(ve.content,0),O[we]=ve,G.push(ve)}}function E(_,C){return new Date((vr(_,C+4)/1e7*Math.pow(2,32)+vr(_,C)/1e7-11644473600)*1e3)}function P(_,C){return c(),u(l.readFileSync(_),C)}function T(_,C){var S=C&&C.type;switch(S||Le&&Buffer.isBuffer(_)&&(S="buffer"),S||"base64"){case"file":return P(_,C);case"base64":return u(Gr(Er(_)),C);case"binary":return u(Gr(_),C)}return u(_,C)}function k(_,C){var S=C||{},A=S.root||"Root Entry";if(_.FullPaths||(_.FullPaths=[]),_.FileIndex||(_.FileIndex=[]),_.FullPaths.length!==_.FileIndex.length)throw new Error("inconsistent CFB structure");_.FullPaths.length===0&&(_.FullPaths[0]=A+"/",_.FileIndex[0]={name:A,type:5}),S.CLSID&&(_.FileIndex[0].clsid=S.CLSID),I(_)}function I(_){var C="Sh33tJ5";if(!Be.find(_,"/"+C)){var S=kt(4);S[0]=55,S[1]=S[3]=50,S[2]=54,_.FileIndex.push({name:C,type:2,content:S,size:4,L:69,R:69,C:69}),_.FullPaths.push(_.FullPaths[0]+C),R(_)}}function R(_,C){k(_);for(var S=!1,A=!1,N=_.FullPaths.length-1;N>=0;--N){var O=_.FileIndex[N];switch(O.type){case 0:A?S=!0:(_.FileIndex.pop(),_.FullPaths.pop());break;case 1:case 2:case 5:A=!0,isNaN(O.R*O.L*O.C)&&(S=!0),O.R>-1&&O.L>-1&&O.R==O.L&&(S=!0);break;default:S=!0;break}}if(!(!S&&!C)){var G=new Date(1987,1,19),ee=0,W=Object.create?Object.create(null):{},K=[];for(N=0;N<_.FullPaths.length;++N)W[_.FullPaths[N]]=!0,_.FileIndex[N].type!==0&&K.push([_.FullPaths[N],_.FileIndex[N]]);for(N=0;N<K.length;++N){var X=n(K[N][0]);A=W[X],A||(K.push([X,{name:a(X).replace("/",""),type:1,clsid:pe,ct:G,mt:G,content:null}]),W[X]=!0)}for(K.sort(function(we,fe){return r(we[0],fe[0])}),_.FullPaths=[],_.FileIndex=[],N=0;N<K.length;++N)_.FullPaths[N]=K[N][0],_.FileIndex[N]=K[N][1];for(N=0;N<K.length;++N){var le=_.FileIndex[N],he=_.FullPaths[N];if(le.name=a(he).replace("/",""),le.L=le.R=le.C=-(le.color=1),le.size=le.content?le.content.length:0,le.start=0,le.clsid=le.clsid||pe,N===0)le.C=K.length>1?1:-1,le.size=0,le.type=5;else if(he.slice(-1)=="/"){for(ee=N+1;ee<K.length&&n(_.FullPaths[ee])!=he;++ee);for(le.C=ee>=K.length?-1:ee,ee=N+1;ee<K.length&&n(_.FullPaths[ee])!=n(he);++ee);le.R=ee>=K.length?-1:ee,le.type=1}else n(_.FullPaths[N+1]||"")==n(he)&&(le.R=N+1),le.type=2}}}function U(_,C){var S=C||{};if(S.fileType=="mad")return Fo(_,S);switch(R(_),S.fileType){case"zip":return Eo(_,S)}var A=function(we){for(var fe=0,ve=0,Ce=0;Ce<we.FileIndex.length;++Ce){var nt=we.FileIndex[Ce];if(nt.content){var at=nt.content.length;at>0&&(at<4096?fe+=at+63>>6:ve+=at+511>>9)}}for(var Ut=we.FullPaths.length+3>>2,Ws=fe+7>>3,Gs=fe+127>>7,Ks=Ws+ve+Ut+Gs,da=Ks+127>>7,Bc=da<=109?0:Math.ceil((da-109)/127);Ks+da+Bc+127>>7>da;)Bc=++da<=109?0:Math.ceil((da-109)/127);var hn=[1,Bc,da,Gs,Ut,ve,fe,0];return we.FileIndex[0].size=fe<<6,hn[7]=(we.FileIndex[0].start=hn[0]+hn[1]+hn[2]+hn[3]+hn[4]+hn[5])+(hn[6]+7>>3),hn}(_),N=kt(A[7]<<9),O=0,G=0;{for(O=0;O<8;++O)N.write_shift(1,ue[O]);for(O=0;O<8;++O)N.write_shift(2,0);for(N.write_shift(2,62),N.write_shift(2,3),N.write_shift(2,65534),N.write_shift(2,9),N.write_shift(2,6),O=0;O<3;++O)N.write_shift(2,0);for(N.write_shift(4,0),N.write_shift(4,A[2]),N.write_shift(4,A[0]+A[1]+A[2]+A[3]-1),N.write_shift(4,0),N.write_shift(4,4096),N.write_shift(4,A[3]?A[0]+A[1]+A[2]-1:ae),N.write_shift(4,A[3]),N.write_shift(-4,A[1]?A[0]-1:ae),N.write_shift(4,A[1]),O=0;O<109;++O)N.write_shift(-4,O<A[2]?A[1]+O:-1)}if(A[1])for(G=0;G<A[1];++G){for(;O<236+G*127;++O)N.write_shift(-4,O<A[2]?A[1]+O:-1);N.write_shift(-4,G===A[1]-1?ae:G+1)}var ee=function(we){for(G+=we;O<G-1;++O)N.write_shift(-4,O+1);we&&(++O,N.write_shift(-4,ae))};for(G=O=0,G+=A[1];O<G;++O)N.write_shift(-4,de.DIFSECT);for(G+=A[2];O<G;++O)N.write_shift(-4,de.FATSECT);ee(A[3]),ee(A[4]);for(var W=0,K=0,X=_.FileIndex[0];W<_.FileIndex.length;++W)X=_.FileIndex[W],X.content&&(K=X.content.length,!(K<4096)&&(X.start=G,ee(K+511>>9)));for(ee(A[6]+7>>3);N.l&511;)N.write_shift(-4,de.ENDOFCHAIN);for(G=O=0,W=0;W<_.FileIndex.length;++W)X=_.FileIndex[W],X.content&&(K=X.content.length,!(!K||K>=4096)&&(X.start=G,ee(K+63>>6)));for(;N.l&511;)N.write_shift(-4,de.ENDOFCHAIN);for(O=0;O<A[4]<<2;++O){var le=_.FullPaths[O];if(!le||le.length===0){for(W=0;W<17;++W)N.write_shift(4,0);for(W=0;W<3;++W)N.write_shift(4,-1);for(W=0;W<12;++W)N.write_shift(4,0);continue}X=_.FileIndex[O],O===0&&(X.start=X.size?X.start-1:ae);var he=O===0&&S.root||X.name;if(K=2*(he.length+1),N.write_shift(64,he,"utf16le"),N.write_shift(2,K),N.write_shift(1,X.type),N.write_shift(1,X.color),N.write_shift(-4,X.L),N.write_shift(-4,X.R),N.write_shift(-4,X.C),X.clsid)N.write_shift(16,X.clsid,"hex");else for(W=0;W<4;++W)N.write_shift(4,0);N.write_shift(4,X.state||0),N.write_shift(4,0),N.write_shift(4,0),N.write_shift(4,0),N.write_shift(4,0),N.write_shift(4,X.start),N.write_shift(4,X.size),N.write_shift(4,0)}for(O=1;O<_.FileIndex.length;++O)if(X=_.FileIndex[O],X.size>=4096)if(N.l=X.start+1<<9,Le&&Buffer.isBuffer(X.content))X.content.copy(N,N.l,0,X.size),N.l+=X.size+511&-512;else{for(W=0;W<X.size;++W)N.write_shift(1,X.content[W]);for(;W&511;++W)N.write_shift(1,0)}for(O=1;O<_.FileIndex.length;++O)if(X=_.FileIndex[O],X.size>0&&X.size<4096)if(Le&&Buffer.isBuffer(X.content))X.content.copy(N,N.l,0,X.size),N.l+=X.size+63&-64;else{for(W=0;W<X.size;++W)N.write_shift(1,X.content[W]);for(;W&63;++W)N.write_shift(1,0)}if(Le)N.l=N.length;else for(;N.l<N.length;)N.write_shift(1,0);return N}function z(_,C){var S=_.FullPaths.map(function(W){return W.toUpperCase()}),A=S.map(function(W){var K=W.split("/");return K[K.length-(W.slice(-1)=="/"?2:1)]}),N=!1;C.charCodeAt(0)===47?(N=!0,C=S[0].slice(0,-1)+C):N=C.indexOf("/")!==-1;var O=C.toUpperCase(),G=N===!0?S.indexOf(O):A.indexOf(O);if(G!==-1)return _.FileIndex[G];var ee=!O.match(ci);for(O=O.replace(ir,""),ee&&(O=O.replace(ci,"!")),G=0;G<S.length;++G)if((ee?S[G].replace(ci,"!"):S[G]).replace(ir,"")==O||(ee?A[G].replace(ci,"!"):A[G]).replace(ir,"")==O)return _.FileIndex[G];return null}var B=64,ae=-2,ge="d0cf11e0a1b11ae1",ue=[208,207,17,224,161,177,26,225],pe="00000000000000000000000000000000",de={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ae,FREESECT:-1,HEADER_SIGNATURE:ge,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:pe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ie(_,C,S){c();var A=U(_,S);l.writeFileSync(C,A)}function M(_){for(var C=new Array(_.length),S=0;S<_.length;++S)C[S]=String.fromCharCode(_[S]);return C.join("")}function se(_,C){var S=U(_,C);switch(C&&C.type||"buffer"){case"file":return c(),l.writeFileSync(C.filename,S),S;case"binary":return typeof S=="string"?S:M(S);case"base64":return qh(typeof S=="string"?S:M(S));case"buffer":if(Le)return Buffer.isBuffer(S)?S:Ua(S);case"array":return typeof S=="string"?Gr(S):S}return S}var me;function b(_){try{var C=_.InflateRaw,S=new C;if(S._processChunk(new Uint8Array([3,0]),S._finishFlushFlag),S.bytesRead)me=_;else throw new Error("zlib does not expose bytesRead")}catch(A){console.error("cannot use native zlib: "+(A.message||A))}}function H(_,C){if(!me)return Hs(_,C);var S=me.InflateRaw,A=new S,N=A._processChunk(_.slice(_.l),A._finishFlushFlag);return _.l+=A.bytesRead,N}function L(_){return me?me.deflateRawSync(_):ke(_)}var j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],V=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function q(_){var C=(_<<1|_<<11)&139536|(_<<5|_<<15)&558144;return(C>>16|C>>8|C)&255}for(var Q=typeof Uint8Array<"u",te=Q?new Uint8Array(256):[],Ee=0;Ee<256;++Ee)te[Ee]=q(Ee);function F(_,C){var S=te[_&255];return C<=8?S>>>8-C:(S=S<<8|te[_>>8&255],C<=16?S>>>16-C:(S=S<<8|te[_>>16&255],S>>>24-C))}function Re(_,C){var S=C&7,A=C>>>3;return(_[A]|(S<=6?0:_[A+1]<<8))>>>S&3}function Te(_,C){var S=C&7,A=C>>>3;return(_[A]|(S<=5?0:_[A+1]<<8))>>>S&7}function re(_,C){var S=C&7,A=C>>>3;return(_[A]|(S<=4?0:_[A+1]<<8))>>>S&15}function xe(_,C){var S=C&7,A=C>>>3;return(_[A]|(S<=3?0:_[A+1]<<8))>>>S&31}function ne(_,C){var S=C&7,A=C>>>3;return(_[A]|(S<=1?0:_[A+1]<<8))>>>S&127}function Ne(_,C,S){var A=C&7,N=C>>>3,O=(1<<S)-1,G=_[N]>>>A;return S<8-A||(G|=_[N+1]<<8-A,S<16-A)||(G|=_[N+2]<<16-A,S<24-A)||(G|=_[N+3]<<24-A),G&O}function Me(_,C,S){var A=C&7,N=C>>>3;return A<=5?_[N]|=(S&7)<<A:(_[N]|=S<<A&255,_[N+1]=(S&7)>>8-A),C+3}function Ge(_,C,S){var A=C&7,N=C>>>3;return S=(S&1)<<A,_[N]|=S,C+1}function Qe(_,C,S){var A=C&7,N=C>>>3;return S<<=A,_[N]|=S&255,S>>>=8,_[N+1]=S,C+8}function Ct(_,C,S){var A=C&7,N=C>>>3;return S<<=A,_[N]|=S&255,S>>>=8,_[N+1]=S&255,_[N+2]=S>>>8,C+16}function be(_,C){var S=_.length,A=2*S>C?2*S:C+5,N=0;if(S>=C)return _;if(Le){var O=Jh(A);if(_.copy)_.copy(O);else for(;N<_.length;++N)O[N]=_[N];return O}else if(Q){var G=new Uint8Array(A);if(G.set)G.set(_);else for(;N<S;++N)G[N]=_[N];return G}return _.length=A,_}function $e(_){for(var C=new Array(_),S=0;S<_;++S)C[S]=0;return C}function wt(_,C,S){var A=1,N=0,O=0,G=0,ee=0,W=_.length,K=Q?new Uint16Array(32):$e(32);for(O=0;O<32;++O)K[O]=0;for(O=W;O<S;++O)_[O]=0;W=_.length;var X=Q?new Uint16Array(W):$e(W);for(O=0;O<W;++O)K[N=_[O]]++,A<N&&(A=N),X[O]=0;for(K[0]=0,O=1;O<=A;++O)K[O+16]=ee=ee+K[O-1]<<1;for(O=0;O<W;++O)ee=_[O],ee!=0&&(X[O]=K[ee+16]++);var le=0;for(O=0;O<W;++O)if(le=_[O],le!=0)for(ee=F(X[O],A)>>A-le,G=(1<<A+4-le)-1;G>=0;--G)C[ee|G<<le]=le&15|O<<4;return A}var Bt=Q?new Uint16Array(512):$e(512),Qt=Q?new Uint16Array(32):$e(32);if(!Q){for(var lt=0;lt<512;++lt)Bt[lt]=0;for(lt=0;lt<32;++lt)Qt[lt]=0}(function(){for(var _=[],C=0;C<32;C++)_.push(5);wt(_,Qt,32);var S=[];for(C=0;C<=143;C++)S.push(8);for(;C<=255;C++)S.push(9);for(;C<=279;C++)S.push(7);for(;C<=287;C++)S.push(8);wt(S,Bt,288)})();var je=function(){for(var C=Q?new Uint8Array(32768):[],S=0,A=0;S<V.length-1;++S)for(;A<V[S+1];++A)C[A]=S;for(;A<32768;++A)C[A]=29;var N=Q?new Uint8Array(259):[];for(S=0,A=0;S<Z.length-1;++S)for(;A<Z[S+1];++A)N[A]=S;function O(ee,W){for(var K=0;K<ee.length;){var X=Math.min(65535,ee.length-K),le=K+X==ee.length;for(W.write_shift(1,+le),W.write_shift(2,X),W.write_shift(2,~X&65535);X-- >0;)W[W.l++]=ee[K++]}return W.l}function G(ee,W){for(var K=0,X=0,le=Q?new Uint16Array(32768):[];X<ee.length;){var he=Math.min(65535,ee.length-X);if(he<10){for(K=Me(W,K,+(X+he==ee.length)),K&7&&(K+=8-(K&7)),W.l=K/8|0,W.write_shift(2,he),W.write_shift(2,~he&65535);he-- >0;)W[W.l++]=ee[X++];K=W.l*8;continue}K=Me(W,K,+(X+he==ee.length)+2);for(var we=0;he-- >0;){var fe=ee[X];we=(we<<5^fe)&32767;var ve=-1,Ce=0;if((ve=le[we])&&(ve|=X&-32768,ve>X&&(ve-=32768),ve<X))for(;ee[ve+Ce]==ee[X+Ce]&&Ce<250;)++Ce;if(Ce>2){fe=N[Ce],fe<=22?K=Qe(W,K,te[fe+1]>>1)-1:(Qe(W,K,3),K+=5,Qe(W,K,te[fe-23]>>5),K+=3);var nt=fe<8?0:fe-4>>2;nt>0&&(Ct(W,K,Ce-Z[fe]),K+=nt),fe=C[X-ve],K=Qe(W,K,te[fe]>>3),K-=3;var at=fe<4?0:fe-2>>1;at>0&&(Ct(W,K,X-ve-V[fe]),K+=at);for(var Ut=0;Ut<Ce;++Ut)le[we]=X&32767,we=(we<<5^ee[X])&32767,++X;he-=Ce-1}else fe<=143?fe=fe+48:K=Ge(W,K,1),K=Qe(W,K,te[fe]),le[we]=X&32767,++X}K=Qe(W,K,0)-1}return W.l=(K+7)/8|0,W.l}return function(W,K){return W.length<8?O(W,K):G(W,K)}}();function ke(_){var C=kt(50+Math.floor(_.length*1.1)),S=je(_,C);return C.slice(0,S)}var Ve=Q?new Uint16Array(32768):$e(32768),Nt=Q?new Uint16Array(32768):$e(32768),dt=Q?new Uint16Array(128):$e(128),fn=1,zs=1;function Xe(_,C){var S=xe(_,C)+257;C+=5;var A=xe(_,C)+1;C+=5;var N=re(_,C)+4;C+=4;for(var O=0,G=Q?new Uint8Array(19):$e(19),ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],W=1,K=Q?new Uint8Array(8):$e(8),X=Q?new Uint8Array(8):$e(8),le=G.length,he=0;he<N;++he)G[j[he]]=O=Te(_,C),W<O&&(W=O),K[O]++,C+=3;var we=0;for(K[0]=0,he=1;he<=W;++he)X[he]=we=we+K[he-1]<<1;for(he=0;he<le;++he)(we=G[he])!=0&&(ee[he]=X[we]++);var fe=0;for(he=0;he<le;++he)if(fe=G[he],fe!=0){we=te[ee[he]]>>8-fe;for(var ve=(1<<7-fe)-1;ve>=0;--ve)dt[we|ve<<fe]=fe&7|he<<3}var Ce=[];for(W=1;Ce.length<S+A;)switch(we=dt[ne(_,C)],C+=we&7,we>>>=3){case 16:for(O=3+Re(_,C),C+=2,we=Ce[Ce.length-1];O-- >0;)Ce.push(we);break;case 17:for(O=3+Te(_,C),C+=3;O-- >0;)Ce.push(0);break;case 18:for(O=11+ne(_,C),C+=7;O-- >0;)Ce.push(0);break;default:Ce.push(we),W<we&&(W=we);break}var nt=Ce.slice(0,S),at=Ce.slice(S);for(he=S;he<286;++he)nt[he]=0;for(he=A;he<30;++he)at[he]=0;return fn=wt(nt,Ve,286),zs=wt(at,Nt,30),C}function Mc(_,C){if(_[0]==3&&!(_[1]&3))return[sa(C),2];for(var S=0,A=0,N=Jh(C||1<<18),O=0,G=N.length>>>0,ee=0,W=0;!(A&1);){if(A=Te(_,S),S+=3,A>>>1)A>>1==1?(ee=9,W=5):(S=Xe(_,S),ee=fn,W=zs);else{S&7&&(S+=8-(S&7));var K=_[S>>>3]|_[(S>>>3)+1]<<8;if(S+=32,K>0)for(!C&&G<O+K&&(N=be(N,O+K),G=N.length);K-- >0;)N[O++]=_[S>>>3],S+=8;continue}for(;;){!C&&G<O+32767&&(N=be(N,O+32767),G=N.length);var X=Ne(_,S,ee),le=A>>>1==1?Bt[X]:Ve[X];if(S+=le&15,le>>>=4,!(le>>>8&255))N[O++]=le;else{if(le==256)break;le-=257;var he=le<8?0:le-4>>2;he>5&&(he=0);var we=O+Z[le];he>0&&(we+=Ne(_,S,he),S+=he),X=Ne(_,S,W),le=A>>>1==1?Qt[X]:Nt[X],S+=le&15,le>>>=4;var fe=le<4?0:le-2>>1,ve=V[le];for(fe>0&&(ve+=Ne(_,S,fe),S+=fe),!C&&G<we&&(N=be(N,we+100),G=N.length);O<we;)N[O]=N[O-ve],++O}}}return C?[N,S+7>>>3]:[N.slice(0,O),S+7>>>3]}function Hs(_,C){var S=_.slice(_.l||0),A=Mc(S,C);return _.l+=A[1],A[0]}function ko(_,C){if(_)typeof console<"u"&&console.error(C);else throw new Error(C)}function Vs(_,C){var S=_;Dt(S,0);var A=[],N=[],O={FileIndex:A,FullPaths:N};k(O,{root:C.root});for(var G=S.length-4;(S[G]!=80||S[G+1]!=75||S[G+2]!=5||S[G+3]!=6)&&G>=0;)--G;S.l=G+4,S.l+=4;var ee=S.read_shift(2);S.l+=6;var W=S.read_shift(4);for(S.l=W,G=0;G<ee;++G){S.l+=20;var K=S.read_shift(4),X=S.read_shift(4),le=S.read_shift(2),he=S.read_shift(2),we=S.read_shift(2);S.l+=8;var fe=S.read_shift(4),ve=o(S.slice(S.l+le,S.l+le+he));S.l+=le+he+we;var Ce=S.l;S.l=fe+4,Zt(S,K,X,O,ve),S.l=Ce}return O}function Zt(_,C,S,A,N){_.l+=2;var O=_.read_shift(2),G=_.read_shift(2),ee=i(_);if(O&8257)throw new Error("Unsupported ZIP encryption");for(var W=_.read_shift(4),K=_.read_shift(4),X=_.read_shift(4),le=_.read_shift(2),he=_.read_shift(2),we="",fe=0;fe<le;++fe)we+=String.fromCharCode(_[_.l++]);if(he){var ve=o(_.slice(_.l,_.l+he));(ve[21589]||{}).mt&&(ee=ve[21589].mt),((N||{})[21589]||{}).mt&&(ee=N[21589].mt)}_.l+=he;var Ce=_.slice(_.l,_.l+K);switch(G){case 8:Ce=H(_,X);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+G)}var nt=!1;O&8&&(W=_.read_shift(4),W==134695760&&(W=_.read_shift(4),nt=!0),K=_.read_shift(4),X=_.read_shift(4)),K!=C&&ko(nt,"Bad compressed size: "+C+" != "+K),X!=S&&ko(nt,"Bad uncompressed size: "+S+" != "+X),D(A,we,Ce,{unsafe:!0,mt:ee})}function Eo(_,C){var S=C||{},A=[],N=[],O=kt(1),G=S.compression?8:0,ee=0,W=0,K=0,X=0,le=0,he=_.FullPaths[0],we=he,fe=_.FileIndex[0],ve=[],Ce=0;for(W=1;W<_.FullPaths.length;++W)if(we=_.FullPaths[W].slice(he.length),fe=_.FileIndex[W],!(!fe.size||!fe.content||we=="Sh33tJ5")){var nt=X,at=kt(we.length);for(K=0;K<we.length;++K)at.write_shift(1,we.charCodeAt(K)&127);at=at.slice(0,at.l),ve[le]=UE.buf(fe.content,0);var Ut=fe.content;G==8&&(Ut=L(Ut)),O=kt(30),O.write_shift(4,67324752),O.write_shift(2,20),O.write_shift(2,ee),O.write_shift(2,G),fe.mt?s(O,fe.mt):O.write_shift(4,0),O.write_shift(-4,ve[le]),O.write_shift(4,Ut.length),O.write_shift(4,fe.content.length),O.write_shift(2,at.length),O.write_shift(2,0),X+=O.length,A.push(O),X+=at.length,A.push(at),X+=Ut.length,A.push(Ut),O=kt(46),O.write_shift(4,33639248),O.write_shift(2,0),O.write_shift(2,20),O.write_shift(2,ee),O.write_shift(2,G),O.write_shift(4,0),O.write_shift(-4,ve[le]),O.write_shift(4,Ut.length),O.write_shift(4,fe.content.length),O.write_shift(2,at.length),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(4,0),O.write_shift(4,nt),Ce+=O.l,N.push(O),Ce+=at.length,N.push(at),++le}return O=kt(22),O.write_shift(4,101010256),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,le),O.write_shift(2,le),O.write_shift(4,Ce),O.write_shift(4,X),O.write_shift(2,0),zn([zn(A),zn(N),O])}var dn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function So(_,C){if(_.ctype)return _.ctype;var S=_.name||"",A=S.match(/\.([^\.]+)$/);return A&&dn[A[1]]||C&&(A=(S=C).match(/[\.\\]([^\.\\])+$/),A&&dn[A[1]])?dn[A[1]]:"application/octet-stream"}function To(_){for(var C=qh(_),S=[],A=0;A<C.length;A+=76)S.push(C.slice(A,A+76));return S.join(`\r
`)+`\r
`}function Ao(_){var C=_.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(K){var X=K.charCodeAt(0).toString(16).toUpperCase();return"="+(X.length==1?"0"+X:X)});C=C.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),C.charAt(0)==`
`&&(C="=0D"+C.slice(1)),C=C.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var S=[],A=C.split(`\r
`),N=0;N<A.length;++N){var O=A[N];if(O.length==0){S.push("");continue}for(var G=0;G<O.length;){var ee=76,W=O.slice(G,G+ee);W.charAt(ee-1)=="="?ee--:W.charAt(ee-2)=="="?ee-=2:W.charAt(ee-3)=="="&&(ee-=3),W=O.slice(G,G+ee),G+=ee,G<O.length&&(W+="="),S.push(W)}}return S.join(`\r
`)}function Co(_){for(var C=[],S=0;S<_.length;++S){for(var A=_[S];S<=_.length&&A.charAt(A.length-1)=="=";)A=A.slice(0,A.length-1)+_[++S];C.push(A)}for(var N=0;N<C.length;++N)C[N]=C[N].replace(/[=][0-9A-Fa-f]{2}/g,function(O){return String.fromCharCode(parseInt(O.slice(1),16))});return Gr(C.join(`\r
`))}function No(_,C,S){for(var A="",N="",O="",G,ee=0;ee<10;++ee){var W=C[ee];if(!W||W.match(/^\s*$/))break;var K=W.match(/^(.*?):\s*([^\s].*)$/);if(K)switch(K[1].toLowerCase()){case"content-location":A=K[2].trim();break;case"content-type":O=K[2].trim();break;case"content-transfer-encoding":N=K[2].trim();break}}switch(++ee,N.toLowerCase()){case"base64":G=Gr(Er(C.slice(ee).join("")));break;case"quoted-printable":G=Co(C.slice(ee));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+N)}var X=D(_,A.slice(S.length),G,{unsafe:!0});O&&(X.ctype=O)}function bo(_,C){if(M(_.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var S=C&&C.root||"",A=(Le&&Buffer.isBuffer(_)?_.toString("binary"):M(_)).split(`\r
`),N=0,O="";for(N=0;N<A.length;++N)if(O=A[N],!!/^Content-Location:/i.test(O)&&(O=O.slice(O.indexOf("file")),S||(S=O.slice(0,O.lastIndexOf("/")+1)),O.slice(0,S.length)!=S))for(;S.length>0&&(S=S.slice(0,S.length-1),S=S.slice(0,S.lastIndexOf("/")+1),O.slice(0,S.length)!=S););var G=(A[1]||"").match(/boundary="(.*?)"/);if(!G)throw new Error("MAD cannot find boundary");var ee="--"+(G[1]||""),W=[],K=[],X={FileIndex:W,FullPaths:K};k(X);var le,he=0;for(N=0;N<A.length;++N){var we=A[N];we!==ee&&we!==ee+"--"||(he++&&No(X,A.slice(le,N),S),le=N)}return X}function Fo(_,C){var S=C||{},A=S.boundary||"SheetJS";A="------="+A;for(var N=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+A.slice(2)+'"',"","",""],O=_.FullPaths[0],G=O,ee=_.FileIndex[0],W=1;W<_.FullPaths.length;++W)if(G=_.FullPaths[W].slice(O.length),ee=_.FileIndex[W],!(!ee.size||!ee.content||G=="Sh33tJ5")){G=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ce){return"_x"+Ce.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ce){return"_u"+Ce.charCodeAt(0).toString(16)+"_"});for(var K=ee.content,X=Le&&Buffer.isBuffer(K)?K.toString("binary"):M(K),le=0,he=Math.min(1024,X.length),we=0,fe=0;fe<=he;++fe)(we=X.charCodeAt(fe))>=32&&we<128&&++le;var ve=le>=he*4/5;N.push(A),N.push("Content-Location: "+(S.root||"file:///C:/SheetJS/")+G),N.push("Content-Transfer-Encoding: "+(ve?"quoted-printable":"base64")),N.push("Content-Type: "+So(ee,G)),N.push(""),N.push(ve?Ao(X):To(X))}return N.push(A+`--\r
`),N.join(`\r
`)}function Oo(_){var C={};return k(C,_),C}function D(_,C,S,A){var N=A&&A.unsafe;N||k(_);var O=!N&&Be.find(_,C);if(!O){var G=_.FullPaths[0];C.slice(0,G.length)==G?G=C:(G.slice(-1)!="/"&&(G+="/"),G=(G+C).replace("//","/")),O={name:a(C),type:2},_.FileIndex.push(O),_.FullPaths.push(G),N||Be.utils.cfb_gc(_)}return O.content=S,O.size=S?S.length:0,A&&(A.CLSID&&(O.clsid=A.CLSID),A.mt&&(O.mt=A.mt),A.ct&&(O.ct=A.ct)),O}function Y(_,C){k(_);var S=Be.find(_,C);if(S){for(var A=0;A<_.FileIndex.length;++A)if(_.FileIndex[A]==S)return _.FileIndex.splice(A,1),_.FullPaths.splice(A,1),!0}return!1}function oe(_,C,S){k(_);var A=Be.find(_,C);if(A){for(var N=0;N<_.FileIndex.length;++N)if(_.FileIndex[N]==A)return _.FileIndex[N].name=a(S),_.FullPaths[N]=S,!0}return!1}function ye(_){R(_,!0)}return t.find=z,t.read=T,t.parse=u,t.write=se,t.writeFile=ie,t.utils={cfb_new:Oo,cfb_add:D,cfb_del:Y,cfb_mov:oe,cfb_gc:ye,ReadShift:Si,CheckField:Eg,prep_blob:Dt,bconcat:zn,use_zlib:b,_deflateRaw:ke,_inflateRaw:Hs,consts:de},t}();function $E(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function ln(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function qf(e){for(var t=[],r=ln(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var rc=new Date(1899,11,30,0,0,0);function or(e,t){var r=e.getTime(),n=rc.getTime()+(e.getTimezoneOffset()-rc.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var rg=new Date,zE=rc.getTime()+(rg.getTimezoneOffset()-rc.getTimezoneOffset())*6e4,sp=rg.getTimezoneOffset();function Dc(e){var t=new Date;return t.setTime(e*24*60*60*1e3+zE),t.getTimezoneOffset()!==sp&&t.setTime(t.getTime()+(t.getTimezoneOffset()-sp)*6e4),t}function HE(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var ip=new Date("2017-02-19T19:06:09.000Z"),ng=isNaN(ip.getFullYear())?new Date("2/19/17"):ip,VE=ng.getFullYear()==2017;function Pt(e,t){var r=new Date(e);if(VE)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(ng.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Ia(e,t){if(Le&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return fi(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return fi(Hm(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return fi(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return fi(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function jt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=jt(e[r]));return t}function ut(e,t){for(var r="";r.length<t;)r+=e;return r}function Jr(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var WE=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ps(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&WE.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var GE=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),i=[s[0]],o=1;o<s.length;++o)i.push(a),i.push(s[o]);return i}}();function ag(e){return e?e.content&&e.type?Ia(e.content,!0):e.data?li(e.data):e.asNodeBuffer&&Le?li(e.asNodeBuffer().toString("binary")):e.asBinary?li(e.asBinary()):e._data&&e._data.getContent?li(Ia(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function sg(e){if(!e)return null;if(e.data)return Xh(e.data);if(e.asNodeBuffer&&Le)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Xh(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function KE(e){return e&&e.name.slice(-4)===".bin"?sg(e):ag(e)}function Nr(e,t){for(var r=e.FullPaths||ln(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Jf(e,t){var r=Nr(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function mt(e,t,r){if(!r)return KE(Jf(e,t));if(!t)return null;try{return mt(e,t)}catch{return null}}function wr(e,t,r){if(!r)return ag(Jf(e,t));if(!t)return null;try{return wr(e,t)}catch{return null}}function XE(e,t,r){return sg(Jf(e,t))}function op(e){for(var t=e.FullPaths||ln(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function YE(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Le?n=Ua(r):n=pE(r),Be.utils.cfb_add(e,t,n)}Be.utils.cfb_add(e,t,r)}else e.file(t,r)}function ig(e,t){switch(t.type){case"base64":return Be.read(e,{type:"base64"});case"binary":return Be.read(e,{type:"binary"});case"buffer":case"array":return Be.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function ui(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var og=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,qE=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,lp=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,JE=/<[^>]*>/g,Jt=og.match(lp)?lp:JE,QE=/<\w*:/,ZE=/<(\/?)\w+:/;function Se(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(qE),o=0,l="",c=0,u="",f="",d=1;if(i)for(c=0;c!=i.length;++c){for(f=i[c],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(u=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(d=(a=f.charCodeAt(s+1))==34||a==39?1:0,l=f.slice(s+1+d,f.length-d),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var p=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[p]&&u.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function cn(e){return e.replace(ZE,"<$1")}var lg={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},eS=qf(lg),He=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(o,l){return lg[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,i)+r(a.slice(i+3))}}(),tS=/[&<>'"]/g,rS=/[\u0000-\u001f]/g;function Qf(e){var t=e+"";return t.replace(tS,function(r){return eS[r]}).replace(/\n/g,"<br/>").replace(rS,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var cp=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function tt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function yu(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=a&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function up(e){var t=sa(2*e.length),r,n,a=1,s=0,i=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function fp(e){return Ua(e,"binary").toString("utf8")}var tl="foo bar bazâð£",Je=Le&&(fp(tl)==yu(tl)&&fp||up(tl)==yu(tl)&&up)||yu,fi=Le?function(e){return Ua(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Zi=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),cg=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),nS=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),aS=/<\/?(?:vt:)?variant>/g,sS=/<(?:vt:)([^>]*)>([\s\S]*)</;function dp(e,t){var r=Se(e),n=e.match(nS(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var i=s.replace(aS,"").match(sS);i&&a.push({v:Je(i[2]),t:i[1]})}),a}var iS=/(^\s|\s$|\n)/;function oS(e){return ln(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function lS(e,t,r){return"<"+e+(r!=null?oS(r):"")+(t!=null?(t.match(iS)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Zf(e){if(Le&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Je($a(Kf(e)));throw new Error("Bad input format: expected Buffer or string")}var eo=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,cS={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},uS=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function fS(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function dS(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var hp=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},pp=Le?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ua(t)})):hp(e)}:hp,xp=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(_n(e,a)));return n.join("").replace(ir,"")},ed=Le?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(ir,""):xp(e,t,r)}:xp,mp=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},ug=Le?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):mp(e,t,r)}:mp,gp=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(ts(e,a)));return n.join("")},mo=Le?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):gp(t,r,n)}:gp,fg=function(e,t){var r=vr(e,t);return r>0?mo(e,t+4,t+4+r-1):""},dg=fg,hg=function(e,t){var r=vr(e,t);return r>0?mo(e,t+4,t+4+r-1):""},pg=hg,xg=function(e,t){var r=2*vr(e,t);return r>0?mo(e,t+4,t+4+r-1):""},mg=xg,gg=function(t,r){var n=vr(t,r);return n>0?ed(t,r+4,r+4+n):""},vg=gg,wg=function(e,t){var r=vr(e,t);return r>0?mo(e,t+4,t+4+r):""},yg=wg,_g=function(e,t){return fS(e,t)},nc=_g,kg=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Le&&(dg=function(t,r){if(!Buffer.isBuffer(t))return fg(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},pg=function(t,r){if(!Buffer.isBuffer(t))return hg(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},mg=function(t,r){if(!Buffer.isBuffer(t))return xg(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},vg=function(t,r){if(!Buffer.isBuffer(t))return gg(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},yg=function(t,r){if(!Buffer.isBuffer(t))return wg(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},nc=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):_g(t,r)},kg=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var ts=function(e,t){return e[t]},_n=function(e,t){return e[t+1]*256+e[t]},hS=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},vr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ya=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},pS=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Si(e,t){var r="",n,a,s=[],i,o,l,c;switch(t){case"dbcs":if(c=this.l,Le&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(_n(this,c)),c+=2;e*=2;break;case"utf8":r=mo(this,this.l,this.l+e);break;case"utf16le":e*=2,r=ed(this,this.l,this.l+e);break;case"wstr":return Si.call(this,e,"dbcs");case"lpstr-ansi":r=dg(this,this.l),e=4+vr(this,this.l);break;case"lpstr-cp":r=pg(this,this.l),e=4+vr(this,this.l);break;case"lpwstr":r=mg(this,this.l),e=4+2*vr(this,this.l);break;case"lpp4":e=4+vr(this,this.l),r=vg(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+vr(this,this.l),r=yg(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=ts(this,this.l+e++))!==0;)s.push(el(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=_n(this,this.l+e))!==0;)s.push(el(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=ts(this,c),this.l=c+1,o=Si.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(el(_n(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=ts(this,c),this.l=c+1,o=Si.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(el(ts(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=ts(this,this.l),this.l++,n;case 2:return n=(t==="i"?hS:_n)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?ya:pS)(this,this.l),this.l+=4,n):(a=vr(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=nc(this,this.l):a=nc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=ug(this,this.l,e);break}}return this.l+=e,r}var xS=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},mS=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},gS=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function vS(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)gS(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var i=t.charCodeAt(a);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,xS(this,t,this.l);break;case 8:if(n=8,r==="f"){dS(this,t,this.l);break}case 16:break;case-4:n=4,mS(this,t,this.l);break}return this.l+=n,this}function Eg(e,t){var r=ug(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Dt(e,t){e.l=t,e.read_shift=Si,e.chk=Eg,e.write_shift=vS}function qt(e,t){e.l+=t}function kt(e){var t=sa(e);return Dt(t,0),t}function On(e,t,r){if(e){var n,a,s;Dt(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=cc[o]||cc[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;l=e.l+s;var u=c.f&&c.f(e,s,r);if(e.l=l,t(u,c,o))return}}}function P0(){var e=[],t=Le?256:2048,r=function(c){var u=kt(c);return Dt(u,0),u},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(a(),n=r(Math.max(c+1,t)))},i=function(){return a(),zn(e)},o=function(c){a(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:i,_bufs:e}}function Ti(e,t,r){var n=jt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function vp(e,t,r){var n=jt(e);return n.s=Ti(n.s,t.s,r),n.e=Ti(n.e,t.s,r),n}function Ai(e,t){if(e.cRel&&e.c<0)for(e=jt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=jt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ae(e);return!e.cRel&&e.cRel!=null&&(r=_S(r)),!e.rRel&&e.rRel!=null&&(r=wS(r)),r}function _u(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Tt(e.s.c)+":"+(e.e.cRel?"":"$")+Tt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Lt(e.s.r)+":"+(e.e.rRel?"":"$")+Lt(e.e.r):Ai(e.s,t.biff)+":"+Ai(e.e,t.biff)}function td(e){return parseInt(yS(e),10)-1}function Lt(e){return""+(e+1)}function wS(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function yS(e){return e.replace(/\$(\d+)$/,"$1")}function rd(e){for(var t=kS(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Tt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function _S(e){return e.replace(/^([A-Z])/,"$$$1")}function kS(e){return e.replace(/^\$([A-Z])/,"$1")}function ES(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ar(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Ae(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Us(e){var t=e.indexOf(":");return t==-1?{s:ar(e),e:ar(e)}:{s:ar(e.slice(0,t)),e:ar(e.slice(t+1))}}function Ue(e,t){return typeof t>"u"||typeof t=="number"?Ue(e.s,e.e):(typeof e!="string"&&(e=Ae(e)),typeof t!="string"&&(t=Ae(t)),e==t?e:e+":"+t)}function ft(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function wp(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=jr(e.z,r?or(t):t)}catch{}try{return e.w=jr((e.XF||{}).numFmtId||(r?14:0),r?or(t):t)}catch{return""+t}}function bn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Va[e.v]||e.v:t==null?wp(e,e.v):wp(e,t))}function fa(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Sg(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?ar(n.origin):n.origin;i=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=ft(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),i==-1&&(c.e.r=i=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[f].length;++d)if(!(typeof t[f][d]>"u")){var p={v:t[f][d]},x=i+f,m=o+d;if(c.s.r>x&&(c.s.r=x),c.s.c>m&&(c.s.c=m),c.e.r<x&&(c.e.r=x),c.e.c<m&&(c.e.c=m),t[f][d]&&typeof t[f][d]=="object"&&!Array.isArray(t[f][d])&&!(t[f][d]instanceof Date))p=t[f][d];else if(Array.isArray(p.v)&&(p.f=t[f][d][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Oe[14],n.cellDates?(p.t="d",p.w=jr(p.z,or(p.v))):(p.t="n",p.v=or(p.v),p.w=jr(p.z,p.v))):p.t="s";if(a)s[x]||(s[x]=[]),s[x][m]&&s[x][m].z&&(p.z=s[x][m].z),s[x][m]=p;else{var v=Ae({c:m,r:x});s[v]&&s[v].z&&(p.z=s[v].z),s[v]=p}}}return c.s.c<1e7&&(s["!ref"]=Ue(c)),s}function $s(e,t){return Sg(null,e,t)}function SS(e){return e.read_shift(4,"i")}function Xt(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function TS(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function nd(e,t){var r=e.l,n=e.read_shift(1),a=Xt(e),s=[],i={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(TS(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var AS=nd;function Lr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function za(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var CS=Xt;function ad(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var NS=Xt,R0=ad;function sd(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?nc([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ya(t,0)>>2;return r?a/100:a}function Tg(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Ha=Tg;function Gt(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function bS(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var c=Na[a];c&&(t.rgb=ro(c));break;case 2:t.rgb=ro([i,o,l]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function FS(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Ag(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function OS(e){return Ag(e,1)}function PS(e){return Ag(e,2)}var id=2,ur=3,rl=11,yp=12,ac=19,nl=64,RS=65,DS=71,IS=4108,jS=4126,bt=80,Cg=81,LS=[bt,Cg],MS={1:{n:"CodePage",t:id},2:{n:"Category",t:bt},3:{n:"PresentationFormat",t:bt},4:{n:"ByteCount",t:ur},5:{n:"LineCount",t:ur},6:{n:"ParagraphCount",t:ur},7:{n:"SlideCount",t:ur},8:{n:"NoteCount",t:ur},9:{n:"HiddenCount",t:ur},10:{n:"MultimediaClipCount",t:ur},11:{n:"ScaleCrop",t:rl},12:{n:"HeadingPairs",t:IS},13:{n:"TitlesOfParts",t:jS},14:{n:"Manager",t:bt},15:{n:"Company",t:bt},16:{n:"LinksUpToDate",t:rl},17:{n:"CharacterCount",t:ur},19:{n:"SharedDoc",t:rl},22:{n:"HyperlinksChanged",t:rl},23:{n:"AppVersion",t:ur,p:"version"},24:{n:"DigSig",t:RS},26:{n:"ContentType",t:bt},27:{n:"ContentStatus",t:bt},28:{n:"Language",t:bt},29:{n:"Version",t:bt},255:{},2147483648:{n:"Locale",t:ac},2147483651:{n:"Behavior",t:ac},1919054434:{}},BS={1:{n:"CodePage",t:id},2:{n:"Title",t:bt},3:{n:"Subject",t:bt},4:{n:"Author",t:bt},5:{n:"Keywords",t:bt},6:{n:"Comments",t:bt},7:{n:"Template",t:bt},8:{n:"LastAuthor",t:bt},9:{n:"RevNumber",t:bt},10:{n:"EditTime",t:nl},11:{n:"LastPrinted",t:nl},12:{n:"CreatedDate",t:nl},13:{n:"ModifiedDate",t:nl},14:{n:"PageCount",t:ur},15:{n:"WordCount",t:ur},16:{n:"CharCount",t:ur},17:{n:"Thumbnail",t:DS},18:{n:"Application",t:bt},19:{n:"DocSecurity",t:ur},255:{},2147483648:{n:"Locale",t:ac},2147483651:{n:"Behavior",t:ac},1919054434:{}},_p={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},US=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function $S(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var zS=$S([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Na=jt(zS),Va={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Ng={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},kp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function HS(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function VS(e){var t=HS();if(!e||!e.match)return t;var r={};if((e.match(Jt)||[]).forEach(function(n){var a=Se(n);switch(a[0].replace(QE,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[kp[a.ContentType]]!==void 0&&t[kp[a.ContentType]].push(a.PartName);break}}),t.xmlns!==cS.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var ps={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function D0(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ci(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Jt)||[]).forEach(function(a){var s=Se(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:ui(s.Target,t);r[o]=i,n[s.Id]=i}}),r["!id"]=n,r}var WS="application/vnd.oasis.opendocument.spreadsheet";function GS(e,t){for(var r=Zf(e),n,a;n=eo.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Se(n[0],!1),a.path=="/"&&a.type!==WS)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var Ni=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],KS=function(){for(var e=new Array(Ni.length),t=0;t<Ni.length;++t){var r=Ni[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function bg(e){var t={};e=Je(e);for(var r=0;r<Ni.length;++r){var n=Ni[r],a=e.match(KS[r]);a!=null&&a.length>0&&(t[n[1]]=He(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Pt(t[n[1]]))}return t}var XS=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Fg(e,t,r,n){var a=[];if(typeof e=="string")a=dp(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(u){return{v:u}}));var i=typeof t=="string"?dp(t,n).map(function(u){return u.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function YS(e,t,r){var n={};return t||(t={}),e=Je(e),XS.forEach(function(a){var s=(e.match(Zi(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=He(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Fg(n.HeadingPairs,n.TitlesOfParts,t,r),t}var qS=/<[^>]+>[^<]*/g;function JS(e,t){var r={},n="",a=e.match(qS);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=Se(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=He(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=He(u);break;case"bool":r[n]=tt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=Pt(u);break;case"cy":case"error":r[n]=He(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,c,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}var QS={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ku;function ZS(e,t,r){ku||(ku=qf(QS)),t=ku[t]||t,e[t]=r}function od(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Og(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function Pg(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Rg(e,t,r){return t===31?Pg(e):Og(e,t,r)}function I0(e,t,r){return Rg(e,t,r===!1?0:4)}function eT(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Rg(e,t,0)}function tT(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(ir,""),e.l-a&2&&(e.l+=2)}return r}function rT(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(ir,"");return r}function nT(e){var t=e.l,r=sc(e,Cg);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=sc(e,ur);return[r,n]}function aT(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(nT(e));return r}function Ep(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(ir,"").replace(ci,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Dg(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function sT(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function sc(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==yp&&n!==t&&LS.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===yp?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return Og(e,n,4).replace(ir,"");case 31:return Pg(e);case 64:return od(e);case 65:return Dg(e);case 71:return sT(e);case 80:return I0(e,n,!s.raw).replace(ir,"");case 81:return eT(e,n).replace(ir,"");case 4108:return aT(e);case 4126:case 4127:return n==4127?tT(e):rT(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Sp(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,o=0,l=-1,c={};for(i=0;i!=a;++i){var u=e.read_shift(4),f=e.read_shift(4);s[i]=[u,f+r]}s.sort(function(y,g){return y[1]-g[1]});var d={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var p=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,p=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],p=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],p=!1);break}if((!t||i==0)&&e.l<=s[i][1]&&(p=!1,e.l=s[i][1]),p)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var x=t[s[i][0]];if(d[x.n]=sc(e,x.t,{raw:!0}),x.p==="version"&&(d[x.n]=String(d[x.n]>>16)+"."+("0000"+String(d[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(d[x.n]){case 0:d[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Kr(o=d[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[x.n])}}else if(s[i][0]===1){if(o=d.CodePage=sc(e,id),Kr(o),l!==-1){var m=e.l;e.l=s[l][1],c=Ep(e,o),e.l=m}}else if(s[i][0]===0){if(o===0){l=i,e.l=s[i+1][1];continue}c=Ep(e,o)}else{var v=c[s[i][0]],w;switch(e[e.l]){case 65:e.l+=4,w=Dg(e);break;case 30:e.l+=4,w=I0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,w=I0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,w=e.read_shift(4,"i");break;case 19:e.l+=4,w=e.read_shift(4);break;case 5:e.l+=4,w=e.read_shift(8,"f");break;case 11:e.l+=4,w=ht(e,4);break;case 64:e.l+=4,w=Pt(od(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[v]=w}}return e.l=r+n,d}function Tp(e,t,r){var n=e.content;if(!n)return{};Dt(n,0);var a,s,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==Be.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(i=n.read_shift(16),l=n.read_shift(4));var f=Sp(n,t),d={SystemIdentifier:c};for(var p in f)d[p]=f[p];if(d.FMTID=s,a===1)return d;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var x;try{x=Sp(n,null)}catch{}for(p in x)d[p]=x[p];return d.FMTID=[s,i],d}function Dn(e,t){return e.read_shift(t),null}function iT(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function ht(e,t){return e.read_shift(t)===1}function gt(e){return e.read_shift(2,"u")}function Ig(e,t){return iT(e,t,gt)}function oT(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function go(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return i}function lT(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,s=1+(r&1),i=0,o,l={};a&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,c);return a&&(e.l+=4*i),n&&(e.l+=o),l.t=u,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function ja(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function vo(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):ja(e,n,r)}function Wa(e,t,r){if(r.biff>5)return vo(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function cT(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function uT(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(ir,"");return n&&(e.l+=24),a}function fT(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(ir,"");return r+i}function dT(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return uT(e);case"0303000000000000c000000000000046":return fT(e);default:throw new Error("Unsupported Moniker "+r)}}function al(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(ir,""):"";return r}function hT(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,o,l,c="",u,f;a&16&&(s=al(e,r-e.l)),a&128&&(i=al(e,r-e.l)),(a&257)===257&&(o=al(e,r-e.l)),(a&257)===1&&(l=dT(e,r-e.l)),a&8&&(c=al(e,r-e.l)),a&32&&(u=e.read_shift(16)),a&64&&(f=od(e)),e.l=r;var d=i||o||l||"";d&&c&&(d+="#"+c),d||(d="#"+c),a&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var p={Target:d};return u&&(p.guid=u),f&&(p.time=f),s&&(p.Tooltip=s),p}function jg(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function Lg(e,t){var r=jg(e);return r[3]=0,r}function un(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function pT(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function xT(e,t,r){return t===0?"":Wa(e,t,r)}function mT(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function Mg(e){var t=e.read_shift(2),r=sd(e);return[t,r]}function gT(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=go(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function Ic(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function Bg(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var vT=Bg;function Ug(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function wT(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function yT(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Ht(e){e.l+=2,e.l+=e.read_shift(2)}var _T={0:Ht,4:Ht,5:Ht,6:Ht,7:yT,8:Ht,9:Ht,10:Ht,11:Ht,12:Ht,13:wT,14:Ht,15:Ht,16:Ht,17:Ht,18:Ht,19:Ht,20:Ht,21:Ug};function kT(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(_T[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function sl(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function ET(e,t){return t===0||e.read_shift(2),1200}function ST(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Wa(e,0,r);return e.read_shift(t+n-e.l),a}function TT(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function AT(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=go(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function CT(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<r;++i)s.push(lT(e));return s.Count=n,s.Unique=a,s}function NT(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function bT(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function FT(e){var t=pT(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function OT(e){return e.read_shift(2),e.read_shift(4)}function Ap(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function PT(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:i,FirstTab:o,Selected:l,TabRatio:c}}function RT(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function DT(){}function IT(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=go(e,0,r),n}function jT(e){var t=un(e);return t.isst=e.read_shift(4),t}function LT(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=un(e);r.biff==2&&e.l++;var s=vo(e,n-e.l,r);return a.val=s,a}function MT(e,t,r){var n=e.read_shift(2),a=Wa(e,0,r);return[n,a]}var BT=Wa;function Cp(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:i,c:l}}}function UT(e){var t=e.read_shift(2),r=e.read_shift(2),n=Mg(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function $T(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(Mg(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function zT(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function HT(e,t,r,n){var a={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=US[o>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function VT(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=HT(e,t,n.fStyle,r),n}function WT(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Np(e,t,r){var n=un(e);(r.biff==2||t==9)&&++e.l;var a=oT(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function GT(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=un(e),a=Gt(e);return n.val=a,n}var bp=xT;function KT(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=ja(e,s),o=[];n>e.l;)o.push(vo(e));return[s,a,i,o]}function Fp(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=gT(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var XT=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Op(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=ja(e,i,r);a&32&&(c=XT[c.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var f=n==e.l||o===0||!(u>0)?[]:bC(e,u,r,o);return{chKey:s,Name:c,itab:l,rgce:f}}function $g(e,t,r){if(r.biff<8)return YT(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(mT(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function YT(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=go(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function qT(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=ja(e,n,r),i=ja(e,a,r);return[s,i]}function JT(e,t,r){var n=Bg(e);e.l++;var a=e.read_shift(1);return t-=8,[FC(e,t,r),a,n]}function Pp(e,t,r){var n=vT(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,CC(e,t,r)]}function QT(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function ZT(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=Wa(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,i,s]}}function e4(e,t,r){return ZT(e,t,r)}function t4(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Ic(e));return r}function r4(e,t,r){if(r&&r.biff<8)return a4(e,t,r);var n=Ug(e),a=kT(e,t-22,n[1]);return{cmo:n,ft:a}}var n4={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function a4(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((n4[n]||qt)(e,t,r)),{cmo:[a,n,s],ft:i}}function s4(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=cT(e,6,r);var o=e.read_shift(2);e.read_shift(2),gt(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],f=ja(e,e.lens[c+1]-e.lens[c]-1);if(a+=f,a.length>=(u?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function i4(e,t){var r=Ic(e);e.l+=16;var n=hT(e,t-24);return[r,n]}function o4(e,t){e.read_shift(2);var r=Ic(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(ir,""),[r,n]}function l4(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=_p[r]||r,r=e.read_shift(2),t[1]=_p[r]||r,t}function c4(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Lg(e));return r}function u4(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Lg(e));return r}function f4(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function zg(e,t,r){if(!r.cellStyles)return qt(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:a,e:s,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function d4(e,t){var r={};return t<32||(e.l+=16,r.header=Gt(e),r.footer=Gt(e),e.l+=2),r}function h4(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var p4=un,x4=Ig,m4=vo;function g4(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function v4(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=un(e);++e.l;var a=Wa(e,t-7,r);return n.t="str",n.val=a,n}function w4(e){var t=un(e);++e.l;var r=Gt(e);return t.t="n",t.val=r,t}function y4(e){var t=un(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function _4(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function k4(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function E4(e,t,r){var n=e.l+t,a=un(e),s=e.read_shift(2),i=ja(e,s,r);return e.l=n,a.t="str",a.val=i,a}var S4=[2,3,48,49,131,139,140,245],Rp=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=qf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=sa(1);switch(l.type){case"base64":u=Gr(Er(o));break;case"binary":u=Gr(o);break;case"buffer":case"array":u=o;break}Dt(u,0);var f=u.read_shift(1),d=!!(f&136),p=!1,x=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,d=!0;break;case 49:p=!0,d=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var m=0,v=521;f==2&&(m=u.read_shift(2)),u.l+=3,f!=2&&(m=u.read_shift(4)),m>1048576&&(m=1e6),f!=2&&(v=u.read_shift(2));var w=u.read_shift(2),y=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(y=e[u[u.l]]),u.l+=1,u.l+=2),x&&(u.l+=36);for(var g=[],E={},P=Math.min(u.length,f==2?521:v-10-(p?264:0)),T=x?32:11;u.l<P&&u[u.l]!=13;)switch(E={},E.name=Ji.utils.decode(y,u.slice(u.l,u.l+T)).replace(/[\u0000\r\n].*$/g,""),u.l+=T,E.type=String.fromCharCode(u.read_shift(1)),f!=2&&!x&&(E.offset=u.read_shift(4)),E.len=u.read_shift(1),f==2&&(E.offset=u.read_shift(2)),E.dec=u.read_shift(1),E.name.length&&g.push(E),f!=2&&(u.l+=x?13:14),E.type){case"B":(!p||E.len!=8)&&l.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+E.type)}if(u[u.l]!==13&&(u.l=v-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=v;var k=0,I=0;for(c[0]=[],I=0;I!=g.length;++I)c[0][I]=g[I].name;for(;m-- >0;){if(u[u.l]===42){u.l+=w;continue}for(++u.l,c[++k]=[],I=0,I=0;I!=g.length;++I){var R=u.slice(u.l,u.l+g[I].len);u.l+=g[I].len,Dt(R,0);var U=Ji.utils.decode(y,R);switch(g[I].type){case"C":U.trim().length&&(c[k][I]=U.replace(/\s+$/,""));break;case"D":U.length===8?c[k][I]=new Date(+U.slice(0,4),+U.slice(4,6)-1,+U.slice(6,8)):c[k][I]=U;break;case"F":c[k][I]=parseFloat(U.trim());break;case"+":case"I":c[k][I]=x?R.read_shift(-4,"i")^2147483648:R.read_shift(4,"i");break;case"L":switch(U.trim().toUpperCase()){case"Y":case"T":c[k][I]=!0;break;case"N":case"F":c[k][I]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+U+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[k][I]="##MEMO##"+(x?parseInt(U.trim(),10):R.read_shift(4));break;case"N":U=U.replace(/\u0000/g,"").trim(),U&&U!="."&&(c[k][I]=+U||0);break;case"@":c[k][I]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":c[k][I]=new Date((R.read_shift(4)-2440588)*864e5+R.read_shift(4));break;case"Y":c[k][I]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[k][I]=-R.read_shift(-8,"f");break;case"B":if(p&&g[I].len==8){c[k][I]=R.read_shift(8,"f");break}case"G":case"P":R.l+=g[I].len;break;case"0":if(g[I].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+g[I].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=g,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=$s(r(o,c),c);return u["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,u}function a(o,l){try{return fa(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var c=l||{};if(+c.codepage>=0&&Kr(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=P0(),f=z0(o,{header:1,raw:!0,cellDates:!0}),d=f[0],p=f.slice(1),x=o["!cols"]||[],m=0,v=0,w=0,y=1;for(m=0;m<d.length;++m){if(((x[m]||{}).DBF||{}).name){d[m]=x[m].DBF.name,++w;continue}if(d[m]!=null){if(++w,typeof d[m]=="number"&&(d[m]=d[m].toString(10)),typeof d[m]!="string")throw new Error("DBF Invalid column name "+d[m]+" |"+typeof d[m]+"|");if(d.indexOf(d[m])!==m){for(v=0;v<1024;++v)if(d.indexOf(d[m]+"_"+v)==-1){d[m]+="_"+v;break}}}}var g=ft(o["!ref"]),E=[],P=[],T=[];for(m=0;m<=g.e.c-g.s.c;++m){var k="",I="",R=0,U=[];for(v=0;v<p.length;++v)p[v][m]!=null&&U.push(p[v][m]);if(U.length==0||d[m]==null){E[m]="?";continue}for(v=0;v<U.length;++v){switch(typeof U[v]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=U[v]instanceof Date?"D":"C";break;default:I="C"}R=Math.max(R,String(U[v]).length),k=k&&k!=I?"C":I}R>250&&(R=250),I=((x[m]||{}).DBF||{}).type,I=="C"&&x[m].DBF.len>R&&(R=x[m].DBF.len),k=="B"&&I=="N"&&(k="N",T[m]=x[m].DBF.dec,R=x[m].DBF.len),P[m]=k=="C"||I=="N"?R:s[k]||0,y+=P[m],E[m]=k}var z=u.next(32);for(z.write_shift(4,318902576),z.write_shift(4,p.length),z.write_shift(2,296+32*w),z.write_shift(2,y),m=0;m<4;++m)z.write_shift(4,0);for(z.write_shift(4,0|(+t[$m]||3)<<8),m=0,v=0;m<d.length;++m)if(d[m]!=null){var B=u.next(32),ae=(d[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);B.write_shift(1,ae,"sbcs"),B.write_shift(1,E[m]=="?"?"C":E[m],"sbcs"),B.write_shift(4,v),B.write_shift(1,P[m]||s[E[m]]||0),B.write_shift(1,T[m]||0),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(1,0),B.write_shift(4,0),B.write_shift(4,0),v+=P[m]||s[E[m]]||0}var ge=u.next(264);for(ge.write_shift(4,13),m=0;m<65;++m)ge.write_shift(4,0);for(m=0;m<p.length;++m){var ue=u.next(y);for(ue.write_shift(1,0),v=0;v<d.length;++v)if(d[v]!=null)switch(E[v]){case"L":ue.write_shift(1,p[m][v]==null?63:p[m][v]?84:70);break;case"B":ue.write_shift(8,p[m][v]||0,"f");break;case"N":var pe="0";for(typeof p[m][v]=="number"&&(pe=p[m][v].toFixed(T[v]||0)),w=0;w<P[v]-pe.length;++w)ue.write_shift(1,32);ue.write_shift(1,pe,"sbcs");break;case"D":p[m][v]?(ue.write_shift(4,("0000"+p[m][v].getFullYear()).slice(-4),"sbcs"),ue.write_shift(2,("00"+(p[m][v].getMonth()+1)).slice(-2),"sbcs"),ue.write_shift(2,("00"+p[m][v].getDate()).slice(-2),"sbcs")):ue.write_shift(8,"00000000","sbcs");break;case"C":var de=String(p[m][v]!=null?p[m][v]:"").slice(0,P[v]);for(ue.write_shift(1,de,"sbcs"),w=0;w<P[v]-de.length;++w)ue.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}}(),T4=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+ln(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,p){var x=e[p];return typeof x=="number"?Yh(x):x},n=function(d,p,x){var m=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return m==59?d:Yh(m)};e["|"]=254;function a(d,p){switch(p.type){case"base64":return s(Er(d),p);case"binary":return s(d,p);case"buffer":return s(Le&&Buffer.isBuffer(d)?d.toString("binary"):$a(d),p);case"array":return s(Ia(d),p)}throw new Error("Unrecognized type "+p.type)}function s(d,p){var x=d.split(/[\n\r]+/),m=-1,v=-1,w=0,y=0,g=[],E=[],P=null,T={},k=[],I=[],R=[],U=0,z;for(+p.codepage>=0&&Kr(+p.codepage);w!==x.length;++w){U=0;var B=x[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),ae=B.replace(/;;/g,"\0").split(";").map(function(j){return j.replace(/\u0000/g,";")}),ge=ae[0],ue;if(B.length>0)switch(ge){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ae[1].charAt(0)=="P"&&E.push(B.slice(3).replace(/;;/g,";"));break;case"C":var pe=!1,de=!1,ie=!1,M=!1,se=-1,me=-1;for(y=1;y<ae.length;++y)switch(ae[y].charAt(0)){case"A":break;case"X":v=parseInt(ae[y].slice(1))-1,de=!0;break;case"Y":for(m=parseInt(ae[y].slice(1))-1,de||(v=0),z=g.length;z<=m;++z)g[z]=[];break;case"K":ue=ae[y].slice(1),ue.charAt(0)==='"'?ue=ue.slice(1,ue.length-1):ue==="TRUE"?ue=!0:ue==="FALSE"?ue=!1:isNaN(Jr(ue))?isNaN(Ps(ue).getDate())||(ue=Pt(ue)):(ue=Jr(ue),P!==null&&Bs(P)&&(ue=Dc(ue))),pe=!0;break;case"E":M=!0;var b=ks(ae[y].slice(1),{r:m,c:v});g[m][v]=[g[m][v],b];break;case"S":ie=!0,g[m][v]=[g[m][v],"S5S"];break;case"G":break;case"R":se=parseInt(ae[y].slice(1))-1;break;case"C":me=parseInt(ae[y].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+B)}if(pe&&(g[m][v]&&g[m][v].length==2?g[m][v][0]=ue:g[m][v]=ue,P=null),ie){if(M)throw new Error("SYLK shared formula cannot have own formula");var H=se>-1&&g[se][me];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");g[m][v][1]=Qg(H[1],{r:m-se,c:v-me})}break;case"F":var L=0;for(y=1;y<ae.length;++y)switch(ae[y].charAt(0)){case"X":v=parseInt(ae[y].slice(1))-1,++L;break;case"Y":for(m=parseInt(ae[y].slice(1))-1,z=g.length;z<=m;++z)g[z]=[];break;case"M":U=parseInt(ae[y].slice(1))/20;break;case"F":break;case"G":break;case"P":P=E[parseInt(ae[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(R=ae[y].slice(1).split(" "),z=parseInt(R[0],10);z<=parseInt(R[1],10);++z)U=parseInt(R[2],10),I[z-1]=U===0?{hidden:!0}:{wch:U},Rs(I[z-1]);break;case"C":v=parseInt(ae[y].slice(1))-1,I[v]||(I[v]={});break;case"R":m=parseInt(ae[y].slice(1))-1,k[m]||(k[m]={}),U>0?(k[m].hpt=U,k[m].hpx=no(U)):U===0&&(k[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+B)}L<1&&(P=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+B)}}return k.length>0&&(T["!rows"]=k),I.length>0&&(T["!cols"]=I),p&&p.sheetRows&&(g=g.slice(0,p.sheetRows)),[g,T]}function i(d,p){var x=a(d,p),m=x[0],v=x[1],w=$s(m,p);return ln(v).forEach(function(y){w[y]=v[y]}),w}function o(d,p){return fa(i(d,p),p)}function l(d,p,x,m){var v="C;Y"+(x+1)+";X"+(m+1)+";K";switch(d.t){case"n":v+=d.v||0,d.f&&!d.F&&(v+=";E"+fA(d.f,{r:x,c:m}));break;case"b":v+=d.v?"TRUE":"FALSE";break;case"e":v+=d.w||d.v;break;case"d":v+='"'+(d.w||d.v)+'"';break;case"s":v+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return v}function c(d,p){p.forEach(function(x,m){var v="F;W"+(m+1)+" "+(m+1)+" ";x.hidden?v+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=oc(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=lc(x.wpx)),typeof x.wch=="number"&&(v+=Math.round(x.wch))),v.charAt(v.length-1)!=" "&&d.push(v)})}function u(d,p){p.forEach(function(x,m){var v="F;";x.hidden?v+="M0;":x.hpt?v+="M"+20*x.hpt+";":x.hpx&&(v+="M"+20*Yg(x.hpx)+";"),v.length>2&&d.push(v+"R"+(m+1))})}function f(d,p){var x=["ID;PWXL;N;E"],m=[],v=ft(d["!ref"]),w,y=Array.isArray(d),g=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),d["!cols"]&&c(x,d["!cols"]),d["!rows"]&&u(x,d["!rows"]),x.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var E=v.s.r;E<=v.e.r;++E)for(var P=v.s.c;P<=v.e.c;++P){var T=Ae({r:E,c:P});w=y?(d[E]||[])[P]:d[T],!(!w||w.v==null&&(!w.f||w.F))&&m.push(l(w,d,E,P))}return x.join(g)+g+m.join(g)+g+"E"+g}return{to_workbook:o,to_sheet:i,from_sheet:f}}(),A4=function(){function e(s,i){switch(i.type){case"base64":return t(Er(s),i);case"binary":return t(s,i);case"buffer":return t(Le&&Buffer.isBuffer(s)?s.toString("binary"):$a(s),i);case"array":return t(Ia(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var o=s.split(`
`),l=-1,c=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var d=o[u].trim().split(","),p=d[0],x=d[1];++u;for(var m=o[u]||"";(m.match(/["]/g)||[]).length&1&&u<o.length-1;)m+=`
`+o[++u];switch(m=m.trim(),+p){case-1:if(m==="BOT"){f[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?f[l][c]=!0:m==="FALSE"?f[l][c]=!1:isNaN(Jr(x))?isNaN(Ps(x).getDate())?f[l][c]=x:f[l][c]=Pt(x):f[l][c]=Jr(x),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),f[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return i&&i.sheetRows&&(f=f.slice(0,i.sheetRows)),f}function r(s,i){return $s(e(s,i),i)}function n(s,i){return fa(r(s,i),i)}var a=function(){var s=function(l,c,u,f,d){l.push(c),l.push(u+","+f),l.push('"'+d.replace(/"/g,'""')+'"')},i=function(l,c,u,f){l.push(c+","+u),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],u=ft(l["!ref"]),f,d=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){i(c,-1,0,"BOT");for(var x=u.s.c;x<=u.e.c;++x){var m=Ae({r:p,c:x});if(f=d?(l[p]||[])[x]:l[m],!f){i(c,1,0,"");continue}switch(f.t){case"n":var v=f.w;!v&&f.v!=null&&(v=f.v),v==null?f.f&&!f.F?i(c,1,0,"="+f.f):i(c,1,0,""):i(c,0,v,"V");break;case"b":i(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":i(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=jr(f.z||Oe[14],or(Pt(f.v)))),i(c,0,f.w,"V");break;default:i(c,1,0,"")}}}i(c,-1,0,"EOD");var w=`\r
`,y=c.join(w);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),C4=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,d){for(var p=f.split(`
`),x=-1,m=-1,v=0,w=[];v!==p.length;++v){var y=p[v].trim().split(":");if(y[0]==="cell"){var g=ar(y[1]);if(w.length<=g.r)for(x=w.length;x<=g.r;++x)w[x]||(w[x]=[]);switch(x=g.r,m=g.c,y[2]){case"t":w[x][m]=e(y[3]);break;case"v":w[x][m]=+y[3];break;case"vtf":var E=y[y.length-1];case"vtc":switch(y[3]){case"nl":w[x][m]=!!+y[4];break;default:w[x][m]=+y[4];break}y[2]=="vtf"&&(w[x][m]=[w[x][m],E])}}}return d&&d.sheetRows&&(w=w.slice(0,d.sheetRows)),w}function n(f,d){return $s(r(f,d),d)}function a(f,d){return fa(n(f,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var d=[],p=[],x,m="",v=Us(f["!ref"]),w=Array.isArray(f),y=v.s.r;y<=v.e.r;++y)for(var g=v.s.c;g<=v.e.c;++g)if(m=Ae({r:y,c:g}),x=w?(f[y]||[])[g]:f[m],!(!x||x.v==null||x.t==="z")){switch(p=["cell",m,"t"],x.t){case"s":case"str":p.push(t(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=t(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var E=or(Pt(x.v));p[2]="vtc",p[3]="nd",p[4]=""+E,p[5]=x.w||jr(x.z||Oe[14],E);break;case"e":continue}d.push(p.join(":"))}return d.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function u(f){return[s,i,o,i,c(f),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}}(),to=function(){function e(u,f,d,p,x){x.raw?f[d][p]=u:u===""||(u==="TRUE"?f[d][p]=!0:u==="FALSE"?f[d][p]=!1:isNaN(Jr(u))?isNaN(Ps(u).getDate())?f[d][p]=u:f[d][p]=Pt(u):f[d][p]=Jr(u))}function t(u,f){var d=f||{},p=[];if(!u||u.length===0)return p;for(var x=u.split(/[\r\n]/),m=x.length-1;m>=0&&x[m].length===0;)--m;for(var v=10,w=0,y=0;y<=m;++y)w=x[y].indexOf(" "),w==-1?w=x[y].length:w++,v=Math.max(v,w);for(y=0;y<=m;++y){p[y]=[];var g=0;for(e(x[y].slice(0,v).trim(),p,y,g,d),g=1;g<=(x[y].length-v)/10+1;++g)e(x[y].slice(v+(g-1)*10,v+g*10).trim(),p,y,g,d)}return d.sheetRows&&(p=p.slice(0,d.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var f={},d=!1,p=0,x=0;p<u.length;++p)(x=u.charCodeAt(p))==34?d=!d:!d&&x in r&&(f[x]=(f[x]||0)+1);x=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&x.push([f[p],p]);if(!x.length){f=n;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&x.push([f[p],p])}return x.sort(function(m,v){return m[0]-v[0]||n[m[1]]-n[v[1]]}),r[x.pop()[1]]||44}function s(u,f){var d=f||{},p="",x=d.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=a(u.slice(0,1024)):d&&d.FS?p=d.FS:p=a(u.slice(0,1024));var v=0,w=0,y=0,g=0,E=0,P=p.charCodeAt(0),T=!1,k=0,I=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var R=d.dateNF!=null?ME(d.dateNF):null;function U(){var z=u.slice(g,E),B={};if(z.charAt(0)=='"'&&z.charAt(z.length-1)=='"'&&(z=z.slice(1,-1).replace(/""/g,'"')),z.length===0)B.t="z";else if(d.raw)B.t="s",B.v=z;else if(z.trim().length===0)B.t="s",B.v=z;else if(z.charCodeAt(0)==61)z.charCodeAt(1)==34&&z.charCodeAt(z.length-1)==34?(B.t="s",B.v=z.slice(2,-1).replace(/""/g,'"')):hA(z)?(B.t="n",B.f=z.slice(1)):(B.t="s",B.v=z);else if(z=="TRUE")B.t="b",B.v=!0;else if(z=="FALSE")B.t="b",B.v=!1;else if(!isNaN(y=Jr(z)))B.t="n",d.cellText!==!1&&(B.w=z),B.v=y;else if(!isNaN(Ps(z).getDate())||R&&z.match(R)){B.z=d.dateNF||Oe[14];var ae=0;R&&z.match(R)&&(z=BE(z,d.dateNF,z.match(R)||[]),ae=1),d.cellDates?(B.t="d",B.v=Pt(z,ae)):(B.t="n",B.v=or(Pt(z,ae))),d.cellText!==!1&&(B.w=jr(B.z,B.v instanceof Date?or(B.v):B.v)),d.cellNF||delete B.z}else B.t="s",B.v=z;if(B.t=="z"||(d.dense?(x[v]||(x[v]=[]),x[v][w]=B):x[Ae({c:w,r:v})]=B),g=E+1,I=u.charCodeAt(g),m.e.c<w&&(m.e.c=w),m.e.r<v&&(m.e.r=v),k==P)++w;else if(w=0,++v,d.sheetRows&&d.sheetRows<=v)return!0}e:for(;E<u.length;++E)switch(k=u.charCodeAt(E)){case 34:I===34&&(T=!T);break;case P:case 10:case 13:if(!T&&U())break e;break}return E-g>0&&U(),x["!ref"]=Ue(m),x}function i(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,f):$s(t(u,f),f)}function o(u,f){var d="",p=f.type=="string"?[0,0,0,0]:xd(u,f);switch(f.type){case"base64":d=Er(u);break;case"binary":d=u;break;case"buffer":f.codepage==65001?d=u.toString("utf8"):f.codepage&&typeof Ji<"u"||(d=Le&&Buffer.isBuffer(u)?u.toString("binary"):$a(u));break;case"array":d=Ia(u);break;case"string":d=u;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?d=Je(d.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?d=Je(d):f.type=="binary"&&typeof Ji<"u",d.slice(0,19)=="socialcalc:version:"?C4.to_sheet(f.type=="string"?d:Je(d),f):i(d,f)}function l(u,f){return fa(o(u,f),f)}function c(u){for(var f=[],d=ft(u["!ref"]),p,x=Array.isArray(u),m=d.s.r;m<=d.e.r;++m){for(var v=[],w=d.s.c;w<=d.e.c;++w){var y=Ae({r:m,c:w});if(p=x?(u[m]||[])[w]:u[y],!p||p.v==null){v.push("          ");continue}for(var g=(p.w||(bn(p),p.w)||"").slice(0,10);g.length<10;)g+=" ";v.push(g+(w===0?" ":""))}f.push(v.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function N4(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=T4.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return to.to_workbook(e,t)}}var bi=function(){function e(b,H,L){if(b){Dt(b,b.l||0);for(var j=L.Enum||se;b.l<b.length;){var Z=b.read_shift(2),V=j[Z]||j[65535],q=b.read_shift(2),Q=b.l+q,te=V.f&&V.f(b,q,L);if(b.l=Q,H(te,V,Z))return}}}function t(b,H){switch(H.type){case"base64":return r(Gr(Er(b)),H);case"binary":return r(Gr(b),H);case"buffer":case"array":return r(b,H)}throw"Unsupported type "+H.type}function r(b,H){if(!b)return b;var L=H||{},j=L.dense?[]:{},Z="Sheet1",V="",q=0,Q={},te=[],Ee=[],F={s:{r:0,c:0},e:{r:0,c:0}},Re=L.sheetRows||0;if(b[2]==0&&(b[3]==8||b[3]==9)&&b.length>=16&&b[14]==5&&b[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(b[2]==2)L.Enum=se,e(b,function(ne,Ne,Me){switch(Me){case 0:L.vers=ne,ne>=4096&&(L.qpro=!0);break;case 6:F=ne;break;case 204:ne&&(V=ne);break;case 222:V=ne;break;case 15:case 51:L.qpro||(ne[1].v=ne[1].v.slice(1));case 13:case 14:case 16:Me==14&&(ne[2]&112)==112&&(ne[2]&15)>1&&(ne[2]&15)<15&&(ne[1].z=L.dateNF||Oe[14],L.cellDates&&(ne[1].t="d",ne[1].v=Dc(ne[1].v))),L.qpro&&ne[3]>q&&(j["!ref"]=Ue(F),Q[Z]=j,te.push(Z),j=L.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},q=ne[3],Z=V||"Sheet"+(q+1),V="");var Ge=L.dense?(j[ne[0].r]||[])[ne[0].c]:j[Ae(ne[0])];if(Ge){Ge.t=ne[1].t,Ge.v=ne[1].v,ne[1].z!=null&&(Ge.z=ne[1].z),ne[1].f!=null&&(Ge.f=ne[1].f);break}L.dense?(j[ne[0].r]||(j[ne[0].r]=[]),j[ne[0].r][ne[0].c]=ne[1]):j[Ae(ne[0])]=ne[1];break}},L);else if(b[2]==26||b[2]==14)L.Enum=me,b[2]==14&&(L.qpro=!0,b.l=0),e(b,function(ne,Ne,Me){switch(Me){case 204:Z=ne;break;case 22:ne[1].v=ne[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ne[3]>q&&(j["!ref"]=Ue(F),Q[Z]=j,te.push(Z),j=L.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},q=ne[3],Z="Sheet"+(q+1)),Re>0&&ne[0].r>=Re)break;L.dense?(j[ne[0].r]||(j[ne[0].r]=[]),j[ne[0].r][ne[0].c]=ne[1]):j[Ae(ne[0])]=ne[1],F.e.c<ne[0].c&&(F.e.c=ne[0].c),F.e.r<ne[0].r&&(F.e.r=ne[0].r);break;case 27:ne[14e3]&&(Ee[ne[14e3][0]]=ne[14e3][1]);break;case 1537:Ee[ne[0]]=ne[1],ne[0]==q&&(Z=ne[1]);break}},L);else throw new Error("Unrecognized LOTUS BOF "+b[2]);if(j["!ref"]=Ue(F),Q[V||Z]=j,te.push(V||Z),!Ee.length)return{SheetNames:te,Sheets:Q};for(var Te={},re=[],xe=0;xe<Ee.length;++xe)Q[te[xe]]?(re.push(Ee[xe]||te[xe]),Te[Ee[xe]]=Q[Ee[xe]]||Q[te[xe]]):(re.push(Ee[xe]),Te[Ee[xe]]={"!ref":"A1"});return{SheetNames:re,Sheets:Te}}function n(b,H){var L=H||{};if(+L.codepage>=0&&Kr(+L.codepage),L.type=="string")throw new Error("Cannot write WK1 to JS string");var j=P0(),Z=ft(b["!ref"]),V=Array.isArray(b),q=[];Ur(j,0,s(1030)),Ur(j,6,l(Z));for(var Q=Math.min(Z.e.r,8191),te=Z.s.r;te<=Q;++te)for(var Ee=Lt(te),F=Z.s.c;F<=Z.e.c;++F){te===Z.s.r&&(q[F]=Tt(F));var Re=q[F]+Ee,Te=V?(b[te]||[])[F]:b[Re];if(!(!Te||Te.t=="z"))if(Te.t=="n")(Te.v|0)==Te.v&&Te.v>=-32768&&Te.v<=32767?Ur(j,13,p(te,F,Te.v)):Ur(j,14,m(te,F,Te.v));else{var re=bn(Te);Ur(j,15,f(te,F,re.slice(0,239)))}}return Ur(j,1),j.end()}function a(b,H){var L=H||{};if(+L.codepage>=0&&Kr(+L.codepage),L.type=="string")throw new Error("Cannot write WK3 to JS string");var j=P0();Ur(j,0,i(b));for(var Z=0,V=0;Z<b.SheetNames.length;++Z)(b.Sheets[b.SheetNames[Z]]||{})["!ref"]&&Ur(j,27,M(b.SheetNames[Z],V++));var q=0;for(Z=0;Z<b.SheetNames.length;++Z){var Q=b.Sheets[b.SheetNames[Z]];if(!(!Q||!Q["!ref"])){for(var te=ft(Q["!ref"]),Ee=Array.isArray(Q),F=[],Re=Math.min(te.e.r,8191),Te=te.s.r;Te<=Re;++Te)for(var re=Lt(Te),xe=te.s.c;xe<=te.e.c;++xe){Te===te.s.r&&(F[xe]=Tt(xe));var ne=F[xe]+re,Ne=Ee?(Q[Te]||[])[xe]:Q[ne];if(!(!Ne||Ne.t=="z"))if(Ne.t=="n")Ur(j,23,U(Te,xe,q,Ne.v));else{var Me=bn(Ne);Ur(j,22,k(Te,xe,q,Me.slice(0,239)))}}++q}}return Ur(j,1),j.end()}function s(b){var H=kt(2);return H.write_shift(2,b),H}function i(b){var H=kt(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var L=0,j=0,Z=0,V=0;V<b.SheetNames.length;++V){var q=b.SheetNames[V],Q=b.Sheets[q];if(!(!Q||!Q["!ref"])){++Z;var te=Us(Q["!ref"]);L<te.e.r&&(L=te.e.r),j<te.e.c&&(j=te.e.c)}}return L>8191&&(L=8191),H.write_shift(2,L),H.write_shift(1,Z),H.write_shift(1,j),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function o(b,H,L){var j={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&L.qpro?(j.s.c=b.read_shift(1),b.l++,j.s.r=b.read_shift(2),j.e.c=b.read_shift(1),b.l++,j.e.r=b.read_shift(2),j):(j.s.c=b.read_shift(2),j.s.r=b.read_shift(2),H==12&&L.qpro&&(b.l+=2),j.e.c=b.read_shift(2),j.e.r=b.read_shift(2),H==12&&L.qpro&&(b.l+=2),j.s.c==65535&&(j.s.c=j.e.c=j.s.r=j.e.r=0),j)}function l(b){var H=kt(8);return H.write_shift(2,b.s.c),H.write_shift(2,b.s.r),H.write_shift(2,b.e.c),H.write_shift(2,b.e.r),H}function c(b,H,L){var j=[{c:0,r:0},{t:"n",v:0},0,0];return L.qpro&&L.vers!=20768?(j[0].c=b.read_shift(1),j[3]=b.read_shift(1),j[0].r=b.read_shift(2),b.l+=2):(j[2]=b.read_shift(1),j[0].c=b.read_shift(2),j[0].r=b.read_shift(2)),j}function u(b,H,L){var j=b.l+H,Z=c(b,H,L);if(Z[1].t="s",L.vers==20768){b.l++;var V=b.read_shift(1);return Z[1].v=b.read_shift(V,"utf8"),Z}return L.qpro&&b.l++,Z[1].v=b.read_shift(j-b.l,"cstr"),Z}function f(b,H,L){var j=kt(7+L.length);j.write_shift(1,255),j.write_shift(2,H),j.write_shift(2,b),j.write_shift(1,39);for(var Z=0;Z<j.length;++Z){var V=L.charCodeAt(Z);j.write_shift(1,V>=128?95:V)}return j.write_shift(1,0),j}function d(b,H,L){var j=c(b,H,L);return j[1].v=b.read_shift(2,"i"),j}function p(b,H,L){var j=kt(7);return j.write_shift(1,255),j.write_shift(2,H),j.write_shift(2,b),j.write_shift(2,L,"i"),j}function x(b,H,L){var j=c(b,H,L);return j[1].v=b.read_shift(8,"f"),j}function m(b,H,L){var j=kt(13);return j.write_shift(1,255),j.write_shift(2,H),j.write_shift(2,b),j.write_shift(8,L,"f"),j}function v(b,H,L){var j=b.l+H,Z=c(b,H,L);if(Z[1].v=b.read_shift(8,"f"),L.qpro)b.l=j;else{var V=b.read_shift(2);E(b.slice(b.l,b.l+V),Z),b.l+=V}return Z}function w(b,H,L){var j=H&32768;return H&=-32769,H=(j?b:0)+(H>=8192?H-16384:H),(j?"":"$")+(L?Tt(H):Lt(H))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},g=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function E(b,H){Dt(b,0);for(var L=[],j=0,Z="",V="",q="",Q="";b.l<b.length;){var te=b[b.l++];switch(te){case 0:L.push(b.read_shift(8,"f"));break;case 1:V=w(H[0].c,b.read_shift(2),!0),Z=w(H[0].r,b.read_shift(2),!1),L.push(V+Z);break;case 2:{var Ee=w(H[0].c,b.read_shift(2),!0),F=w(H[0].r,b.read_shift(2),!1);V=w(H[0].c,b.read_shift(2),!0),Z=w(H[0].r,b.read_shift(2),!1),L.push(Ee+F+":"+V+Z)}break;case 3:if(b.l<b.length){console.error("WK1 premature formula end");return}break;case 4:L.push("("+L.pop()+")");break;case 5:L.push(b.read_shift(2));break;case 6:{for(var Re="";te=b[b.l++];)Re+=String.fromCharCode(te);L.push('"'+Re.replace(/"/g,'""')+'"')}break;case 8:L.push("-"+L.pop());break;case 23:L.push("+"+L.pop());break;case 22:L.push("NOT("+L.pop()+")");break;case 20:case 21:Q=L.pop(),q=L.pop(),L.push(["AND","OR"][te-20]+"("+q+","+Q+")");break;default:if(te<32&&g[te])Q=L.pop(),q=L.pop(),L.push(q+g[te]+Q);else if(y[te]){if(j=y[te][1],j==69&&(j=b[b.l++]),j>L.length){console.error("WK1 bad formula parse 0x"+te.toString(16)+":|"+L.join("|")+"|");return}var Te=L.slice(-j);L.length-=j,L.push(y[te][0]+"("+Te.join(",")+")")}else return te<=7?console.error("WK1 invalid opcode "+te.toString(16)):te<=24?console.error("WK1 unsupported op "+te.toString(16)):te<=30?console.error("WK1 invalid opcode "+te.toString(16)):te<=115?console.error("WK1 unsupported function opcode "+te.toString(16)):console.error("WK1 unrecognized opcode "+te.toString(16))}}L.length==1?H[1].f=""+L[0]:console.error("WK1 bad formula parse |"+L.join("|")+"|")}function P(b){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=b.read_shift(2),H[3]=b[b.l++],H[0].c=b[b.l++],H}function T(b,H){var L=P(b);return L[1].t="s",L[1].v=b.read_shift(H-4,"cstr"),L}function k(b,H,L,j){var Z=kt(6+j.length);Z.write_shift(2,b),Z.write_shift(1,L),Z.write_shift(1,H),Z.write_shift(1,39);for(var V=0;V<j.length;++V){var q=j.charCodeAt(V);Z.write_shift(1,q>=128?95:q)}return Z.write_shift(1,0),Z}function I(b,H){var L=P(b);L[1].v=b.read_shift(2);var j=L[1].v>>1;if(L[1].v&1)switch(j&7){case 0:j=(j>>3)*5e3;break;case 1:j=(j>>3)*500;break;case 2:j=(j>>3)/20;break;case 3:j=(j>>3)/200;break;case 4:j=(j>>3)/2e3;break;case 5:j=(j>>3)/2e4;break;case 6:j=(j>>3)/16;break;case 7:j=(j>>3)/64;break}return L[1].v=j,L}function R(b,H){var L=P(b),j=b.read_shift(4),Z=b.read_shift(4),V=b.read_shift(2);if(V==65535)return j===0&&Z===3221225472?(L[1].t="e",L[1].v=15):j===0&&Z===3489660928?(L[1].t="e",L[1].v=42):L[1].v=0,L;var q=V&32768;return V=(V&32767)-16446,L[1].v=(1-q*2)*(Z*Math.pow(2,V+32)+j*Math.pow(2,V)),L}function U(b,H,L,j){var Z=kt(14);if(Z.write_shift(2,b),Z.write_shift(1,L),Z.write_shift(1,H),j==0)return Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(2,65535),Z;var V=0,q=0,Q=0,te=0;return j<0&&(V=1,j=-j),q=Math.log2(j)|0,j/=Math.pow(2,q-31),te=j>>>0,te&2147483648||(j/=2,++q,te=j>>>0),j-=te,te|=2147483648,te>>>=0,j*=Math.pow(2,32),Q=j>>>0,Z.write_shift(4,Q),Z.write_shift(4,te),q+=16383+(V?32768:0),Z.write_shift(2,q),Z}function z(b,H){var L=R(b);return b.l+=H-14,L}function B(b,H){var L=P(b),j=b.read_shift(4);return L[1].v=j>>6,L}function ae(b,H){var L=P(b),j=b.read_shift(8,"f");return L[1].v=j,L}function ge(b,H){var L=ae(b);return b.l+=H-10,L}function ue(b,H){return b[b.l+H-1]==0?b.read_shift(H,"cstr"):""}function pe(b,H){var L=b[b.l++];L>H-1&&(L=H-1);for(var j="";j.length<L;)j+=String.fromCharCode(b[b.l++]);return j}function de(b,H,L){if(!(!L.qpro||H<21)){var j=b.read_shift(1);b.l+=17,b.l+=1,b.l+=2;var Z=b.read_shift(H-21,"cstr");return[j,Z]}}function ie(b,H){for(var L={},j=b.l+H;b.l<j;){var Z=b.read_shift(2);if(Z==14e3){for(L[Z]=[0,""],L[Z][0]=b.read_shift(2);b[b.l];)L[Z][1]+=String.fromCharCode(b[b.l]),b.l++;b.l++}}return L}function M(b,H){var L=kt(5+b.length);L.write_shift(2,14e3),L.write_shift(2,H);for(var j=0;j<b.length;++j){var Z=b.charCodeAt(j);L[L.l++]=Z>127?95:Z}return L[L.l++]=0,L}var se={0:{n:"BOF",f:gt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:v},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ue},222:{n:"SHEETNAMELP",f:pe},65535:{n:""}},me={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:T},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:I},25:{n:"FORMULA19",f:z},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ie},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:B},38:{n:"??"},39:{n:"NUMBER27",f:ae},40:{n:"FORMULA28",f:ge},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ue},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:de},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function b4(e){var t={},r=e.match(Jt),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Se(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=Wf[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var F4=function(){var e=Zi("t"),t=Zi("rPr");function r(s){var i=s.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:He(i[1])},l=s.match(t);return l&&(o.s=b4(l[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),O4=function(){var t=/(\r\n|\n)/g;function r(a,s,i){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),a.b&&(s.push("<b>"),i.push("</b>")),a.i&&(s.push("<i>"),i.push("</i>")),a.strike&&(s.push("<s>"),i.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),P4=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,R4=/<(?:\w+:)?r>/,D4=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ld(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=He(Je(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Je(e),r&&(n.h=Qf(n.t))):e.match(R4)&&(n.r=Je(e),n.t=He(Je((e.replace(D4,"").match(P4)||[]).join("").replace(Jt,""))),r&&(n.h=O4(F4(n.r)))),n):{t:""}}var I4=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,j4=/<(?:\w+:)?(?:si|sstItem)>/g,L4=/<\/(?:\w+:)?(?:si|sstItem)>/;function M4(e,t){var r=[],n="";if(!e)return r;var a=e.match(I4);if(a){n=a[2].replace(j4,"").split(L4);for(var s=0;s!=n.length;++s){var i=ld(n[s].trim(),t);i!=null&&(r[r.length]=i)}a=Se(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}function B4(e){return[e.read_shift(4),e.read_shift(4)]}function U4(e,t){var r=[],n=!1;return On(e,function(s,i,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function Hg(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Sn(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function $4(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Sn(e,4),t.U=Sn(e,4),t.W=Sn(e,4),t}function z4(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function H4(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(z4(e));return t}function V4(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function W4(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Sn(e,4),t.U=Sn(e,4),t.W=Sn(e,4),t}function G4(e){var t=W4(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Vg(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function Wg(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function K4(e){var t=Sn(e);switch(t.Minor){case 2:return[t.Minor,X4(e)];case 3:return[t.Minor,Y4()];case 4:return[t.Minor,q4(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function X4(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=Vg(e,r),a=Wg(e,e.length-e.l);return{t:"Std",h:n,v:a}}function Y4(){throw new Error("File is password-protected: ECMA-376 Extensible")}function q4(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Jt,function(s){var i=Se(s);switch(cn(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function J4(e,t){var r={},n=r.EncryptionVersionInfo=Sn(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=Vg(e,a),t-=a,r.EncryptionVerifier=Wg(e,t),r}function Q4(e){var t={},r=t.EncryptionVersionInfo=Sn(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Z4(e){var t=0,r,n=Hg(e),a=n.length+1,s,i,o,l,c;for(r=sa(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)i=r[s],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^i;return t^52811}var Gg=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,o){return n(i^o)},s=function(i){for(var o=t[i.length-1],l=104,c=i.length-1;c>=0;--c)for(var u=i[c],f=0;f!=7;++f)u&64&&(o^=r[l]),u*=2,--l;return o};return function(i){for(var o=Hg(i),l=s(o),c=o.length,u=sa(16),f=0;f!=16;++f)u[f]=0;var d,p,x;for((c&1)===1&&(d=l>>8,u[c]=a(e[0],d),--c,d=l&255,p=o[o.length-1],u[c]=a(p,d));c>0;)--c,d=l>>8,u[c]=a(o[c],d),--c,d=l&255,u[c]=a(o[c],d);for(c=15,x=15-o.length;x>0;)d=l>>8,u[c]=a(e[x],d),--c,--x,d=l&255,u[c]=a(o[c],d),--c,--x;return u}}(),e3=function(e,t,r,n,a){a||(a=t),n||(n=Gg(e));var s,i;for(s=0;s!=t.length;++s)i=t[s],i^=n[r],i=(i>>5|i<<3)&255,a[s]=i,++r;return[a,r,n]},t3=function(e){var t=0,r=Gg(e);return function(n){var a=e3("",n,t,r);return t=a[1],a[0]}};function r3(e,t,r,n){var a={key:gt(e),verificationBytes:gt(e)};return r.password&&(a.verifier=Z4(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=t3(r.password)),a}function n3(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Q4(e):n.Data=J4(e,t),n}function a3(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?n3(e,t-2,n):r3(e,r.biff>=8?t:t-2,r,n),n}var s3=function(){function e(a,s){switch(s.type){case"base64":return t(Er(a),s);case"binary":return t(a,s);case"buffer":return t(Le&&Buffer.isBuffer(a)?a.toString("binary"):$a(a),s);case"array":return t(Ia(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var i=s||{},o=i.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var d=/\\\w+\b/g,p=0,x,m=-1;x=d.exec(u);){switch(x[0]){case"\\cell":var v=u.slice(p,d.lastIndex-x[0].length);if(v[0]==" "&&(v=v.slice(1)),++m,v.length){var w={v,t:"s"};Array.isArray(o)?o[f][m]=w:o[Ae({r:f,c:m})]=w}break}p=d.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=Ue(c),o}function r(a,s){return fa(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=ft(a["!ref"]),o,l=Array.isArray(a),c=i.s.r;c<=i.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=i.s.c;u<=i.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=i.s.c;u<=i.e.c;++u){var f=Ae({r:c,c:u});o=l?(a[c]||[])[u]:a[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(bn(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function i3(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function ro(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function o3(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=a-s;if(i===0)return[0,0,t];var o=0,l=0,c=a+s;switch(l=i/(c>1?2-c:c),a){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,l,c/2]}function l3(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=a*o,i[0]+=a,i[1]+=l;break;case 1:l=a*(2-o),i[0]+=l,i[1]+=a;break;case 2:l=a*(o-2),i[1]+=a,i[2]+=l;break;case 3:l=a*(4-o),i[1]+=l,i[2]+=a;break;case 4:l=a*(o-4),i[2]+=a,i[0]+=l;break;case 5:l=a*(6-o),i[2]+=l,i[0]+=a;break}for(var c=0;c!=3;++c)i[c]=Math.round(i[c]*255);return i}function ic(e,t){if(t===0)return e;var r=o3(i3(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),ro(l3(r))}var Kg=6,c3=15,u3=1,nr=Kg;function oc(e){return Math.floor((e+Math.round(128/nr)/256)*nr)}function lc(e){return Math.floor((e-5)/nr*100+.5)/100}function j0(e){return Math.round((e*nr+5)/nr*256)/256}function Eu(e){return j0(lc(oc(e)))}function cd(e){var t=Math.abs(e-Eu(e)),r=nr;if(t>.005)for(nr=u3;nr<c3;++nr)Math.abs(e-Eu(e))<=t&&(t=Math.abs(e-Eu(e)),r=nr);nr=r}function Rs(e){e.width?(e.wpx=oc(e.width),e.wch=lc(e.wpx),e.MDW=nr):e.wpx?(e.wch=lc(e.wpx),e.width=j0(e.wch),e.MDW=nr):typeof e.wch=="number"&&(e.width=j0(e.wch),e.wpx=oc(e.width),e.MDW=nr),e.customWidth&&delete e.customWidth}var f3=96,Xg=f3;function Yg(e){return e*96/Xg}function no(e){return e*Xg/96}var d3={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function h3(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(Jt)||[]).forEach(function(i){var o=Se(i);switch(cn(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=tt(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=tt(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function p3(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(Jt)||[]).forEach(function(i){var o=Se(i);switch(cn(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function x3(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(Jt)||[]).forEach(function(i){var o=Se(i);switch(cn(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=Je(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?tt(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?tt(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?tt(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?tt(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?tt(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?tt(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?tt(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Wf[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=tt(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var l=Na[a.color.index];a.color.index==81&&(l=Na[1]),l||(l=Na[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=ic(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function m3(e,t,r){t.NumberFmt=[];for(var n=ln(Oe),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Oe[n[a]];var s=e[0].match(Jt);if(s)for(a=0;a<s.length;++a){var i=Se(s[a]);switch(cn(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=He(Je(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}Ca(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var il=["numFmtId","fillId","fontId","borderId","xfId"],ol=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function g3(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Jt)||[]).forEach(function(s){var i=Se(s),o=0;switch(cn(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<il.length;++o)n[il[o]]&&(n[il[o]]=parseInt(n[il[o]],10));for(o=0;o<ol.length;++o)n[ol[o]]&&(n[ol[o]]=tt(n[ol[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=tt(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var v3=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&m3(f,u,c),(f=o.match(a))&&x3(f,u,l,c),(f=o.match(n))&&p3(f,u,l,c),(f=o.match(s))&&h3(f,u,l,c),(f=o.match(r))&&g3(f,u,c),u}}();function w3(e,t){var r=e.read_shift(2),n=Xt(e);return[r,n]}function y3(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=FS(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=bS(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Xt(e),n}var _3=qt;function k3(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}var E3=qt;function S3(e,t,r){var n={};n.NumberFmt=[];for(var a in Oe)n.NumberFmt[a]=Oe[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return On(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],Ca(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=ic(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(u),i=!0;break;case 38:s.pop(),i=!1;break;default:if(c.T>0)s.push(u);else if(c.T<0)s.pop();else if(!i||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var T3=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function A3(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Jt)||[]).forEach(function(a){var s=Se(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[T3.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function C3(){}function N3(){}var b3=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,F3=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,O3=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function P3(e,t,r){t.themeElements={};var n;[["clrScheme",b3,A3],["fontScheme",F3,C3],["fmtScheme",O3,N3]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var R3=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function qg(e,t){(!e||e.length===0)&&(e=D3());var r,n={};if(!(r=e.match(R3)))throw new Error("themeElements not found in theme");return P3(r[0],n,t),n.raw=e,n}function D3(e,t){var r=[og];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function I3(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var i;try{i=ig(s,{type:"array"})}catch{return}var o=wr(i,"theme/theme/theme1.xml",!0);if(o)return qg(o,r)}}function j3(e){return e.read_shift(4)}function L3(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=M3(e,4);break;case 2:t.xclrValue=jg(e);break;case 3:t.xclrValue=j3(e);break;case 4:e.l+=4;break}return e.l+=8,t}function M3(e,t){return qt(e,t)}function B3(e,t){return qt(e,t)}function U3(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=L3(e);break;case 6:n[1]=B3(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function $3(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(U3(e,r-e.l));return{ixfe:n,ext:s}}function z3(e,t){t.forEach(function(r){switch(r[0]){}})}function H3(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Xt(e)}}function V3(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function W3(e){return e.l+=4,e.read_shift(4)!=0}function G3(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],i=!1,o=2;return On(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(u),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!c.T){if(!i||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function K3(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,i;return e.replace(Jt,function(o){var l=Se(o);switch(cn(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(i=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function X3(e){var t=[];if(!e)return t;var r=1;return(e.match(Jt)||[]).forEach(function(n){var a=Se(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function Y3(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ae(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function q3(e,t,r){var n=[];return On(e,function(s,i,o){switch(o){case 63:n.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function J3(e,t,r,n){if(!e)return e;var a=n||{},s=!1;On(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},a)}function Q3(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function Dp(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(i){var o=ar(i.ref);if(a?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[i.ref],!s){s={t:"z"},a?e[o.r][o.c]=s:e[i.ref]=s;var l=ft(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Ue(l);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var u={a:i.author,t:i.t,r:i.r,T:r};i.h&&(u.h=i.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(u.a==n[f].id){u.a=n[f].name||u.a;break}}s.c.push(u)})}function Z3(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Se(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=ar(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var f=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!f&&!!f[1]&&ld(f[1])||{r:"",t:"",h:""};c.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),c.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=d.h),n.push(c)}}}}),n}function eA(e,t){var r=[],n=!1,a={},s=0;return e.replace(Jt,function(o,l){var c=Se(o);switch(cn(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":a.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function tA(e,t){var r=[],n=!1;return e.replace(Jt,function(s){var i=Se(s);switch(cn(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),r}function rA(e){var t={};t.iauthor=e.read_shift(4);var r=Ha(e);return t.rfx=r.s,t.ref=Ae(r.s),e.l+=16,t}var nA=Xt;function aA(e,t){var r=[],n=[],a={},s=!1;return On(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var sA="application/vnd.ms-office.vbaProject";function iA(e){var t=Be.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Be.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Be.write(t)}function oA(){return{"!type":"dialog"}}function lA(){return{"!type":"dialog"}}function cA(){return{"!type":"macro"}}function uA(){return{"!type":"macro"}}var ks=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,i){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=i.length>0?parseInt(i,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,a+(o?"":"$")+Tt(u)+(l?"":"$")+Lt(c)}return function(a,s){return t=s,a.replace(e,r)}}(),Jg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,fA=function(){return function(t,r){return t.replace(Jg,function(n,a,s,i,o,l){var c=rd(i)-(s?0:r.c),u=td(l)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",d=c==0?"":s?c+1:"["+c+"]";return a+"R"+f+"C"+d})}}();function Qg(e,t){return e.replace(Jg,function(r,n,a,s,i,o){return n+(a=="$"?a+s:Tt(rd(s)+t.c))+(i=="$"?i+o:Lt(td(o)+t.r))})}function dA(e,t,r){var n=Us(t),a=n.s,s=ar(r),i={r:s.r-a.r,c:s.c-a.c};return Qg(e,i)}function hA(e){return e.length!=1}function Ip(e){return e.replace(/_xlfn\./g,"")}function xt(e){e.l+=1}function ia(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Zg(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return ev(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=ia(e),o=ia(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function ev(e){var t=ia(e),r=ia(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function pA(e,t,r){if(r.biff<8)return ev(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=ia(e),i=ia(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function tv(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return xA(e);var n=e.read_shift(r&&r.biff==12?4:2),a=ia(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function xA(e){var t=ia(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function mA(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function gA(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return vA(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:o}}function vA(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function wA(e,t,r){var n=(e[e.l++]&96)>>5,a=Zg(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function yA(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=Zg(e,s,r);return[n,a,i]}function _A(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function kA(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function EA(e,t,r){var n=(e[e.l++]&96)>>5,a=pA(e,t-1,r);return[n,a]}function SA(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function jp(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function TA(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function AA(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function CA(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function NA(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function bA(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function rv(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function FA(e){return e.read_shift(2),rv(e)}function OA(e){return e.read_shift(2),rv(e)}function PA(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=tv(e,0,r);return[n,a]}function RA(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=gA(e,0,r);return[n,a]}function DA(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=tv(e,0,r);return[n,a,s]}function IA(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[jC[a],sv[a],n]}function jA(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:LA(e);return[a,(s[0]===0?sv:IC)[s[1]]]}function LA(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function MA(e,t,r){e.l+=r&&r.biff==2?3:4}function BA(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function UA(e){return e.l++,Va[e.read_shift(1)]}function $A(e){return e.l++,e.read_shift(2)}function zA(e){return e.l++,e.read_shift(1)!==0}function HA(e){return e.l++,Gt(e)}function VA(e,t,r){return e.l++,go(e,t-1,r)}function WA(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=ht(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Va[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Gt(e);break;case 2:r[1]=Wa(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function GA(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?Ha:Ic)(e));return a}function KA(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=WA(e,r.biff);return i}function XA(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function YA(e,t,r){if(r.biff==5)return qA(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function qA(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function JA(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function QA(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function ZA(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function eC(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var tC=qt,rC=qt,nC=qt;function wo(e,t,r){return e.l+=2,[mA(e)]}function ud(e){return e.l+=6,[]}var aC=wo,sC=ud,iC=ud,oC=wo;function nv(e){return e.l+=2,[gt(e),e.read_shift(2)&1]}var lC=wo,cC=nv,uC=ud,fC=wo,dC=wo,hC=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function pC(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=hC[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:a,C:s}}function xC(e){return e.l+=2,[e.read_shift(4)]}function mC(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function gC(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function vC(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function wC(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function yC(e){return e.l+=4,[0,0]}var Lp={1:{n:"PtgExp",f:BA},2:{n:"PtgTbl",f:nC},3:{n:"PtgAdd",f:xt},4:{n:"PtgSub",f:xt},5:{n:"PtgMul",f:xt},6:{n:"PtgDiv",f:xt},7:{n:"PtgPower",f:xt},8:{n:"PtgConcat",f:xt},9:{n:"PtgLt",f:xt},10:{n:"PtgLe",f:xt},11:{n:"PtgEq",f:xt},12:{n:"PtgGe",f:xt},13:{n:"PtgGt",f:xt},14:{n:"PtgNe",f:xt},15:{n:"PtgIsect",f:xt},16:{n:"PtgUnion",f:xt},17:{n:"PtgRange",f:xt},18:{n:"PtgUplus",f:xt},19:{n:"PtgUminus",f:xt},20:{n:"PtgPercent",f:xt},21:{n:"PtgParen",f:xt},22:{n:"PtgMissArg",f:xt},23:{n:"PtgStr",f:VA},26:{n:"PtgSheet",f:mC},27:{n:"PtgEndSheet",f:gC},28:{n:"PtgErr",f:UA},29:{n:"PtgBool",f:zA},30:{n:"PtgInt",f:$A},31:{n:"PtgNum",f:HA},32:{n:"PtgArray",f:SA},33:{n:"PtgFunc",f:IA},34:{n:"PtgFuncVar",f:jA},35:{n:"PtgName",f:XA},36:{n:"PtgRef",f:PA},37:{n:"PtgArea",f:wA},38:{n:"PtgMemArea",f:JA},39:{n:"PtgMemErr",f:tC},40:{n:"PtgMemNoMem",f:rC},41:{n:"PtgMemFunc",f:QA},42:{n:"PtgRefErr",f:ZA},43:{n:"PtgAreaErr",f:_A},44:{n:"PtgRefN",f:RA},45:{n:"PtgAreaN",f:EA},46:{n:"PtgMemAreaN",f:vC},47:{n:"PtgMemNoMemN",f:wC},57:{n:"PtgNameX",f:YA},58:{n:"PtgRef3d",f:DA},59:{n:"PtgArea3d",f:yA},60:{n:"PtgRefErr3d",f:eC},61:{n:"PtgAreaErr3d",f:kA},255:{}},_C={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},kC={1:{n:"PtgElfLel",f:nv},2:{n:"PtgElfRw",f:fC},3:{n:"PtgElfCol",f:aC},6:{n:"PtgElfRwV",f:dC},7:{n:"PtgElfColV",f:oC},10:{n:"PtgElfRadical",f:lC},11:{n:"PtgElfRadicalS",f:uC},13:{n:"PtgElfColS",f:sC},15:{n:"PtgElfColSV",f:iC},16:{n:"PtgElfRadicalLel",f:cC},25:{n:"PtgList",f:pC},29:{n:"PtgSxName",f:xC},255:{}},EC={0:{n:"PtgAttrNoop",f:yC},1:{n:"PtgAttrSemi",f:bA},2:{n:"PtgAttrIf",f:CA},4:{n:"PtgAttrChoose",f:TA},8:{n:"PtgAttrGoto",f:AA},16:{n:"PtgAttrSum",f:MA},32:{n:"PtgAttrBaxcel",f:jp},33:{n:"PtgAttrBaxcel",f:jp},64:{n:"PtgAttrSpace",f:FA},65:{n:"PtgAttrSpaceSemi",f:OA},128:{n:"PtgAttrIfError",f:NA},255:{}};function yo(e,t,r,n){if(n.biff<8)return qt(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=KA(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=GA(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=a-e.l,t!==0&&s.push(qt(e,t)),s}function _o(e,t,r){for(var n=e.l+t,a,s,i=[];n!=e.l;)t=n-e.l,s=e[e.l],a=Lp[s]||Lp[_C[s]],(s===24||s===25)&&(a=(s===24?kC:EC)[e[e.l+1]]),!a||!a.f?qt(e,t):i.push([a.n,a.f(e,t,r)]);return i}function SC(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var TC={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function AC(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function av(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Mp(e,t,r){var n=av(e,t,r);return n=="#REF"?n:AC(n,r)}function Vt(e,t,r,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0}},o=[],l,c,u,f=0,d=0,p,x="";if(!e[0]||!e[0][0])return"";for(var m=-1,v="",w=0,y=e[0].length;w<y;++w){var g=e[0][w];switch(g[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:v=ut(" ",e[0][m][1][1]);break;case 1:v=ut("\r",e[0][m][1][1]);break;default:if(v="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}c=c+v,m=-1}o.push(c+TC[g[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Ti(g[1][1],i,a),o.push(Ai(u,s));break;case"PtgRefN":u=r?Ti(g[1][1],r,a):g[1][1],o.push(Ai(u,s));break;case"PtgRef3d":f=g[1][1],u=Ti(g[1][2],i,a),x=Mp(n,f,a),o.push(x+"!"+Ai(u,s));break;case"PtgFunc":case"PtgFuncVar":var E=g[1][0],P=g[1][1];E||(E=0),E&=127;var T=E==0?[]:o.slice(-E);o.length-=E,P==="User"&&(P=T.shift()),o.push(P+"("+T.join(",")+")");break;case"PtgBool":o.push(g[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(g[1]);break;case"PtgNum":o.push(String(g[1]));break;case"PtgStr":o.push('"'+g[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(g[1]);break;case"PtgAreaN":p=vp(g[1][1],r?{s:r}:i,a),o.push(_u(p,a));break;case"PtgArea":p=vp(g[1][1],i,a),o.push(_u(p,a));break;case"PtgArea3d":f=g[1][1],p=g[1][2],x=Mp(n,f,a),o.push(x+"!"+_u(p,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=g[1][2];var k=(n.names||[])[d-1]||(n[0]||[])[d],I=k?k.Name:"SH33TJSNAME"+String(d);I&&I.slice(0,6)=="_xlfn."&&!a.xlfn&&(I=I.slice(6)),o.push(I);break;case"PtgNameX":var R=g[1][1];d=g[1][2];var U;if(a.biff<=5)R<0&&(R=-R),n[R]&&(U=n[R][d]);else{var z="";if(((n[R]||[])[0]||[])[0]==14849||(((n[R]||[])[0]||[])[0]==1025?n[R][d]&&n[R][d].itab>0&&(z=n.SheetNames[n[R][d].itab-1]+"!"):z=n.SheetNames[d-1]+"!"),n[R]&&n[R][d])z+=n[R][d].Name;else if(n[0]&&n[0][d])z+=n[0][d].Name;else{var B=(av(n,R,a)||"").split(";;");B[d-1]?z=B[d-1]:z+="SH33TJSERRX"}o.push(z);break}U||(U={Name:"SH33TJSERRY"}),o.push(U.Name);break;case"PtgParen":var ae="(",ge=")";if(m>=0){switch(v="",e[0][m][1][0]){case 2:ae=ut(" ",e[0][m][1][1])+ae;break;case 3:ae=ut("\r",e[0][m][1][1])+ae;break;case 4:ge=ut(" ",e[0][m][1][1])+ge;break;case 5:ge=ut("\r",e[0][m][1][1])+ge;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(ae+o.pop()+ge);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:g[1][1],r:g[1][0]};var ue={c:r.c,r:r.r};if(n.sharedf[Ae(u)]){var pe=n.sharedf[Ae(u)];o.push(Vt(pe,i,ue,n,a))}else{var de=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Vt(c[1],i,ue,n,a)),de=!0;break}de||o.push(g[1])}break;case"PtgArray":o.push("{"+SC(g[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+g[1].idx+"[#"+g[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(g));default:throw new Error("Unrecognized Formula Token: "+String(g))}var ie=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&m>=0&&ie.indexOf(e[0][w][0])==-1){g=e[0][m];var M=!0;switch(g[1][0]){case 4:M=!1;case 0:v=ut(" ",g[1][1]);break;case 5:M=!1;case 1:v=ut("\r",g[1][1]);break;default:if(v="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+g[1][0])}o.push((M?v:"")+o.pop()+(M?"":v)),m=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function CC(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],qt(e,t-2)];var o=_o(e,i,r);return t!==i+a&&(s=yo(e,t-i-a,o,r)),e.l=n,[o,s]}function NC(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],qt(e,t-2)];var o=_o(e,i,r);return t!==i+a&&(s=yo(e,t-i-a,o,r)),e.l=n,[o,s]}function bC(e,t,r,n){var a=e.l+t,s=_o(e,n,r),i;return a!==e.l&&(i=yo(e,a-e.l,s,r)),[s,i]}function FC(e,t,r){var n=e.l+t,a,s=e.read_shift(2),i=_o(e,s,r);return s==65535?[[],qt(e,t-2)]:(t!==s+2&&(a=yo(e,n-s-2,i,r)),[i,a])}function OC(e){var t;if(_n(e,e.l+6)!==65535)return[Gt(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Su(e,t,r){var n=e.l+t,a=un(e);r.biff==2&&++e.l;var s=OC(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=NC(e,n-e.l,r);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function jc(e,t,r){var n=e.read_shift(4),a=_o(e,n,r),s=e.read_shift(4),i=s>0?yo(e,s,a,r):null;return[a,i]}var PC=jc,Lc=jc,RC=jc,DC=jc,IC={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},sv={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},jC={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Bp(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Tu(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Fi={},Es={};function Oi(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function iv(e,t,r,n,a,s){try{n.cellNF&&(e.z=Oe[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Pt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Oe[t]==null&&Ca(LE[t]||"General",t),e.t==="e")e.w=e.w||Va[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Qi(e.v);else if(e.t==="d"){var i=or(e.v);(i|0)===i?e.w=i.toString(10):e.w=Qi(i)}else{if(e.v===void 0)return"";e.w=Da(e.v,Es)}else e.t==="d"?e.w=jr(t,or(e.v),Es):e.w=jr(t,e.v,Es)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=ic(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=ic(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function LC(e,t){var r=ft(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ue(r))}var MC=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,BC=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,UC=/<(?:\w:)?hyperlink [^>]*>/mg,$C=/"(\w*:\w*)"/,zC=/<(?:\w:)?col\b[^>]*[\/]?>/g,HC=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,VC=/<(?:\w:)?pageMargins[^>]*\/>/g,ov=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,WC=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,GC=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function KC(e,t,r,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",f=e.match(BC);f?(c=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):c=u=e;var d=c.match(ov);d?fd(d[0],o,a,r):(d=c.match(WC))&&XC(d[0],d[1]||"",o,a,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var x=c.slice(p,p+50).match($C);x&&LC(o,x[1])}var m=c.match(GC);m&&m[1]&&eN(m[1],a);var v=[];if(t.cellStyles){var w=c.match(zC);w&&JC(v,w)}f&&tN(f[1],o,t,l,s,i);var y=u.match(HC);y&&(o["!autofilter"]=QC(y[0]));var g=[],E=u.match(MC);if(E)for(p=0;p!=E.length;++p)g[p]=ft(E[p].slice(E[p].indexOf('"')+1));var P=u.match(UC);P&&YC(o,P,n);var T=u.match(VC);if(T&&(o["!margins"]=qC(Se(T[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Ue(l)),t.sheetRows>0&&o["!ref"]){var k=ft(o["!ref"]);t.sheetRows<=+k.e.r&&(k.e.r=t.sheetRows-1,k.e.r>l.e.r&&(k.e.r=l.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>l.e.c&&(k.e.c=l.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ue(k))}return v.length>0&&(o["!cols"]=v),g.length>0&&(o["!merges"]=g),o}function fd(e,t,r,n){var a=Se(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=He(Je(a.codeName)))}function XC(e,t,r,n,a){fd(e.slice(0,e.indexOf(">")),r,n,a)}function YC(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=Se(Je(t[a]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+He(s.location))):(s.Target="#"+He(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=ft(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=Ae({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}function qC(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function JC(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Se(t[n],!0);a.hidden&&(a.hidden=tt(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,cd(a.width)),Rs(a);s<=i;)e[s++]=jt(a)}}function QC(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var ZC=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function eN(e,t){t.Views||(t.Views=[{}]),(e.match(ZC)||[]).forEach(function(r,n){var a=Se(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),tt(a.rightToLeft)&&(t.Views[n].RTL=!0)})}var tN=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=Zi("v"),i=Zi("f");return function(l,c,u,f,d,p){for(var x=0,m="",v=[],w=[],y=0,g=0,E=0,P="",T,k,I=0,R=0,U,z,B=0,ae=0,ge=Array.isArray(p.CellXf),ue,pe=[],de=[],ie=Array.isArray(c),M=[],se={},me=!1,b=!!u.sheetStubs,H=l.split(t),L=0,j=H.length;L!=j;++L){m=H[L].trim();var Z=m.length;if(Z!==0){var V=0;e:for(x=0;x<Z;++x)switch(m[x]){case">":if(m[x-1]!="/"){++x;break e}if(u&&u.cellStyles){if(k=Se(m.slice(V,x),!0),I=k.r!=null?parseInt(k.r,10):I+1,R=-1,u.sheetRows&&u.sheetRows<I)continue;se={},me=!1,k.ht&&(me=!0,se.hpt=parseFloat(k.ht),se.hpx=no(se.hpt)),k.hidden=="1"&&(me=!0,se.hidden=!0),k.outlineLevel!=null&&(me=!0,se.level=+k.outlineLevel),me&&(M[I-1]=se)}break;case"<":V=x;break}if(V>=x)break;if(k=Se(m.slice(V,x),!0),I=k.r!=null?parseInt(k.r,10):I+1,R=-1,!(u.sheetRows&&u.sheetRows<I)){f.s.r>I-1&&(f.s.r=I-1),f.e.r<I-1&&(f.e.r=I-1),u&&u.cellStyles&&(se={},me=!1,k.ht&&(me=!0,se.hpt=parseFloat(k.ht),se.hpx=no(se.hpt)),k.hidden=="1"&&(me=!0,se.hidden=!0),k.outlineLevel!=null&&(me=!0,se.level=+k.outlineLevel),me&&(M[I-1]=se)),v=m.slice(x).split(e);for(var q=0;q!=v.length&&v[q].trim().charAt(0)=="<";++q);for(v=v.slice(q),x=0;x!=v.length;++x)if(m=v[x].trim(),m.length!==0){if(w=m.match(r),y=x,g=0,E=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,w!=null&&w.length===2){for(y=0,P=w[1],g=0;g!=P.length&&!((E=P.charCodeAt(g)-64)<1||E>26);++g)y=26*y+E;--y,R=y}else++R;for(g=0;g!=m.length&&m.charCodeAt(g)!==62;++g);if(++g,k=Se(m.slice(0,g),!0),k.r||(k.r=Ae({r:I-1,c:R})),P=m.slice(g),T={t:""},(w=P.match(s))!=null&&w[1]!==""&&(T.v=He(w[1])),u.cellFormula){if((w=P.match(i))!=null&&w[1]!==""){if(T.f=He(Je(w[1])).replace(/\r\n/g,`
`),u.xlfn||(T.f=Ip(T.f)),w[0].indexOf('t="array"')>-1)T.F=(P.match(a)||[])[1],T.F.indexOf(":")>-1&&pe.push([ft(T.F),T.F]);else if(w[0].indexOf('t="shared"')>-1){z=Se(w[0]);var Q=He(Je(w[1]));u.xlfn||(Q=Ip(Q)),de[parseInt(z.si,10)]=[z,Q,k.r]}}else(w=P.match(/<f[^>]*\/>/))&&(z=Se(w[0]),de[z.si]&&(T.f=dA(de[z.si][1],de[z.si][2],k.r)));var te=ar(k.r);for(g=0;g<pe.length;++g)te.r>=pe[g][0].s.r&&te.r<=pe[g][0].e.r&&te.c>=pe[g][0].s.c&&te.c<=pe[g][0].e.c&&(T.F=pe[g][1])}if(k.t==null&&T.v===void 0)if(T.f||T.F)T.v=0,T.t="n";else if(b)T.t="z";else continue;else T.t=k.t||"n";switch(f.s.c>R&&(f.s.c=R),f.e.c<R&&(f.e.c=R),T.t){case"n":if(T.v==""||T.v==null){if(!b)continue;T.t="z"}else T.v=parseFloat(T.v);break;case"s":if(typeof T.v>"u"){if(!b)continue;T.t="z"}else U=Fi[parseInt(T.v,10)],T.v=U.t,T.r=U.r,u.cellHTML&&(T.h=U.h);break;case"str":T.t="s",T.v=T.v!=null?Je(T.v):"",u.cellHTML&&(T.h=Qf(T.v));break;case"inlineStr":w=P.match(n),T.t="s",w!=null&&(U=ld(w[1]))?(T.v=U.t,u.cellHTML&&(T.h=U.h)):T.v="";break;case"b":T.v=tt(T.v);break;case"d":u.cellDates?T.v=Pt(T.v,1):(T.v=or(Pt(T.v,1)),T.t="n");break;case"e":(!u||u.cellText!==!1)&&(T.w=T.v),T.v=Ng[T.v];break}if(B=ae=0,ue=null,ge&&k.s!==void 0&&(ue=p.CellXf[k.s],ue!=null&&(ue.numFmtId!=null&&(B=ue.numFmtId),u.cellStyles&&ue.fillId!=null&&(ae=ue.fillId))),iv(T,B,ae,u,d,p),u.cellDates&&ge&&T.t=="n"&&Bs(Oe[B])&&(T.t="d",T.v=Dc(T.v)),k.cm&&u.xlmeta){var Ee=(u.xlmeta.Cell||[])[+k.cm-1];Ee&&Ee.type=="XLDAPR"&&(T.D=!0)}if(ie){var F=ar(k.r);c[F.r]||(c[F.r]=[]),c[F.r][F.c]=T}else c[k.r]=T}}}}M.length>0&&(c["!rows"]=M)}}();function rN(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}var nN=Ha;function aN(){}function sN(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=CS(e),r}function iN(e){var t=Lr(e);return[t]}function oN(e){var t=za(e);return[t]}function lN(e){var t=Lr(e),r=e.read_shift(1);return[t,r,"b"]}function cN(e){var t=za(e),r=e.read_shift(1);return[t,r,"b"]}function uN(e){var t=Lr(e),r=e.read_shift(1);return[t,r,"e"]}function fN(e){var t=za(e),r=e.read_shift(1);return[t,r,"e"]}function dN(e){var t=Lr(e),r=e.read_shift(4);return[t,r,"s"]}function hN(e){var t=za(e),r=e.read_shift(4);return[t,r,"s"]}function pN(e){var t=Lr(e),r=Gt(e);return[t,r,"n"]}function lv(e){var t=za(e),r=Gt(e);return[t,r,"n"]}function xN(e){var t=Lr(e),r=sd(e);return[t,r,"n"]}function mN(e){var t=za(e),r=sd(e);return[t,r,"n"]}function gN(e){var t=Lr(e),r=nd(e);return[t,r,"is"]}function vN(e){var t=Lr(e),r=Xt(e);return[t,r,"str"]}function wN(e){var t=za(e),r=Xt(e);return[t,r,"str"]}function yN(e,t,r){var n=e.l+t,a=Lr(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(r.cellFormula){e.l+=2;var o=Lc(e,n-e.l,r);i[3]=Vt(o,null,a,r.supbooks,r)}else e.l=n;return i}function _N(e,t,r){var n=e.l+t,a=Lr(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(r.cellFormula){e.l+=2;var o=Lc(e,n-e.l,r);i[3]=Vt(o,null,a,r.supbooks,r)}else e.l=n;return i}function kN(e,t,r){var n=e.l+t,a=Lr(e);a.r=r["!row"];var s=Gt(e),i=[a,s,"n"];if(r.cellFormula){e.l+=2;var o=Lc(e,n-e.l,r);i[3]=Vt(o,null,a,r.supbooks,r)}else e.l=n;return i}function EN(e,t,r){var n=e.l+t,a=Lr(e);a.r=r["!row"];var s=Xt(e),i=[a,s,"str"];if(r.cellFormula){e.l+=2;var o=Lc(e,n-e.l,r);i[3]=Vt(o,null,a,r.supbooks,r)}else e.l=n;return i}var SN=Ha;function TN(e,t){var r=e.l+t,n=Ha(e),a=ad(e),s=Xt(e),i=Xt(e),o=Xt(e);e.l=r;var l={rfx:n,relId:a,loc:s,display:o};return i&&(l.Tooltip=i),l}function AN(){}function CN(e,t,r){var n=e.l+t,a=Tg(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var o=PC(e,n-e.l,r);i[1]=o}else e.l=n;return i}function NN(e,t,r){var n=e.l+t,a=Ha(e),s=[a];if(r.cellFormula){var i=DC(e,n-e.l,r);s[1]=i,e.l=n}else e.l=n;return s}var bN=["left","right","top","bottom","header","footer"];function FN(e){var t={};return bN.forEach(function(r){t[r]=Gt(e)}),t}function ON(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function PN(){}function RN(){}function DN(e,t,r,n,a,s,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,d=!1,p,x,m,v,w,y,g,E,P,T=[];o.biff=12,o["!row"]=0;var k=0,I=!1,R=[],U={},z=o.supbooks||a.supbooks||[[]];if(z.sharedf=U,z.arrayf=R,z.SheetNames=a.SheetNames||a.Sheets.map(function(ie){return ie.name}),!o.supbooks&&(o.supbooks=z,a.Names))for(var B=0;B<a.Names.length;++B)z[0][B+1]=a.Names[B];var ae=[],ge=[],ue=!1;cc[16]={n:"BrtShortReal",f:lv};var pe;if(On(e,function(M,se,me){if(!d)switch(me){case 148:c=M;break;case 0:p=M,o.sheetRows&&o.sheetRows<=p.r&&(d=!0),E=Lt(v=p.r),o["!row"]=p.r,(M.hidden||M.hpt||M.level!=null)&&(M.hpt&&(M.hpx=no(M.hpt)),ge[M.r]=M);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:M[2]},M[2]){case"n":x.v=M[1];break;case"s":g=Fi[M[1]],x.v=g.t,x.r=g.r;break;case"b":x.v=!!M[1];break;case"e":x.v=M[1],o.cellText!==!1&&(x.w=Va[x.v]);break;case"str":x.t="s",x.v=M[1];break;case"is":x.t="s",x.v=M[1].t;break}if((m=i.CellXf[M[0].iStyleRef])&&iv(x,m.numFmtId,null,o,s,i),w=M[0].c==-1?w+1:M[0].c,o.dense?(l[v]||(l[v]=[]),l[v][w]=x):l[Tt(w)+E]=x,o.cellFormula){for(I=!1,k=0;k<R.length;++k){var b=R[k];p.r>=b[0].s.r&&p.r<=b[0].e.r&&w>=b[0].s.c&&w<=b[0].e.c&&(x.F=Ue(b[0]),I=!0)}!I&&M.length>3&&(x.f=M[3])}if(u.s.r>p.r&&(u.s.r=p.r),u.s.c>w&&(u.s.c=w),u.e.r<p.r&&(u.e.r=p.r),u.e.c<w&&(u.e.c=w),o.cellDates&&m&&x.t=="n"&&Bs(Oe[m.numFmtId])){var H=Sa(x.v);H&&(x.t="d",x.v=new Date(H.y,H.m-1,H.d,H.H,H.M,H.S,H.u))}pe&&(pe.type=="XLDAPR"&&(x.D=!0),pe=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;x={t:"z",v:void 0},w=M[0].c==-1?w+1:M[0].c,o.dense?(l[v]||(l[v]=[]),l[v][w]=x):l[Tt(w)+E]=x,u.s.r>p.r&&(u.s.r=p.r),u.s.c>w&&(u.s.c=w),u.e.r<p.r&&(u.e.r=p.r),u.e.c<w&&(u.e.c=w),pe&&(pe.type=="XLDAPR"&&(x.D=!0),pe=void 0);break;case 176:T.push(M);break;case 49:pe=((o.xlmeta||{}).Cell||[])[M-1];break;case 494:var L=n["!id"][M.relId];for(L?(M.Target=L.Target,M.loc&&(M.Target+="#"+M.loc),M.Rel=L):M.relId==""&&(M.Target="#"+M.loc),v=M.rfx.s.r;v<=M.rfx.e.r;++v)for(w=M.rfx.s.c;w<=M.rfx.e.c;++w)o.dense?(l[v]||(l[v]=[]),l[v][w]||(l[v][w]={t:"z",v:void 0}),l[v][w].l=M):(y=Ae({c:w,r:v}),l[y]||(l[y]={t:"z",v:void 0}),l[y].l=M);break;case 426:if(!o.cellFormula)break;R.push(M),P=o.dense?l[v][w]:l[Tt(w)+E],P.f=Vt(M[1],u,{r:p.r,c:w},z,o),P.F=Ue(M[0]);break;case 427:if(!o.cellFormula)break;U[Ae(M[0].s)]=M[1],P=o.dense?l[v][w]:l[Tt(w)+E],P.f=Vt(M[1],u,{r:p.r,c:w},z,o);break;case 60:if(!o.cellStyles)break;for(;M.e>=M.s;)ae[M.e--]={width:M.w/256,hidden:!!(M.flags&1),level:M.level},ue||(ue=!0,cd(M.w/256)),Rs(ae[M.e+1]);break;case 161:l["!autofilter"]={ref:Ue(M)};break;case 476:l["!margins"]=M;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),M.name&&(a.Sheets[r].CodeName=M.name),(M.above||M.left)&&(l["!outline"]={above:M.above,left:M.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),M.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!se.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+me.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Ue(c||u)),o.sheetRows&&l["!ref"]){var de=ft(l["!ref"]);o.sheetRows<=+de.e.r&&(de.e.r=o.sheetRows-1,de.e.r>u.e.r&&(de.e.r=u.e.r),de.e.r<de.s.r&&(de.s.r=de.e.r),de.e.c>u.e.c&&(de.e.c=u.e.c),de.e.c<de.s.c&&(de.s.c=de.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Ue(de))}return T.length>0&&(l["!merges"]=T),ae.length>0&&(l["!cols"]=ae),ge.length>0&&(l["!rows"]=ge),l}function IN(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var a=He((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function jN(e,t,r,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var d=IN(f);u.s.r=u.s.c=0,u.e.c=o,c=Tt(o),d[0].forEach(function(p,x){i[c+Lt(x)]={t:"n",v:p,z:d[1]},l=x}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(i["!ref"]=Ue(u)),i}function LN(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(ov);return o&&fd(o[0],s,a,r),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function MN(e,t){e.l+=10;var r=Xt(e);return{name:r}}function BN(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return On(e,function(l,c,u){switch(u){case 550:s["!rel"]=l;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),l.name&&(a.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var cv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],UN=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],$N=[],zN=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Up(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=tt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function $p(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=tt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function uv(e){$p(e.WBProps,cv),$p(e.CalcPr,zN),Up(e.WBView,UN),Up(e.Sheets,$N),Es.date1904=tt(e.WBProps.date1904)}var HN="][*?/\\".split("");function VN(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return HN.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var WN=/<\w+:workbook/;function GN(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(Jt,function(l,c){var u=Se(l);switch(cn(u[0])){case"<?xml":break;case"<workbook":l.match(WN)&&(a="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[a];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":cv.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=tt(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=Je(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=He(Je(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Je(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),tt(u.hidden||"0")&&(s.Hidden=!0),i=c+l.length;break;case"</definedName>":s.Ref=He(Je(e.slice(i,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),uS.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return uv(r),r}function KN(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=R0(e),r.name=Xt(e),r}function XN(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Xt(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function YN(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function qN(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=NS(e),i=RC(e,0,r),o=ad(e);e.l=n;var l={Name:s,Ptg:i};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function JN(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],cc[16]={n:"BrtFRTArchID$",f:YN},On(e,function(l,c,u){switch(u){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Vt(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([u,l]):i[0]=[u,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(u),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!c.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),uv(r),r.Names=s,r.supbooks=i,r}function QN(e,t,r){return t.slice(-4)===".bin"?JN(e,r):GN(e,r)}function ZN(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?DN(e,n,r,a,s,i,o):KC(e,n,r,a,s,i,o)}function eb(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?BN(e,n,r,a,s):LN(e,n,r,a,s)}function tb(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?cA():uA()}function rb(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?oA():lA()}function nb(e,t,r,n){return t.slice(-4)===".bin"?S3(e,r,n):v3(e,r,n)}function ab(e,t,r){return qg(e,r)}function sb(e,t,r){return t.slice(-4)===".bin"?U4(e,r):M4(e,r)}function ib(e,t,r){return t.slice(-4)===".bin"?aA(e,r):Z3(e,r)}function ob(e,t,r){return t.slice(-4)===".bin"?q3(e):X3(e)}function lb(e,t,r,n){return r.slice(-4)===".bin"?J3(e,t,r,n):void 0}function cb(e,t,r){return t.slice(-4)===".bin"?G3(e,t,r):K3(e,t,r)}var fv=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,dv=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Br(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(fv),s,i,o,l;if(a)for(l=0;l!=a.length;++l)s=a[l].match(dv),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),n[o]=s[2].slice(1,s[2].length-1));return n}function ub(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(fv),a,s,i,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(dv),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),r[i]=a[2].slice(1,a[2].length-1));return r}var Pi;function fb(e,t){var r=Pi[e]||He(e);return r==="General"?Da(t):jr(r,t)}function db(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=tt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Pt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[He(t)]=a}function hb(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Va[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Qi(e.v):e.w=Da(e.v):e.w=fb(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=Pi[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Bs(n)){var a=Sa(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function pb(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=d3[n.Pattern]||n.Pattern)}e[t.ID]=t}function xb(e,t,r,n,a,s,i,o,l,c){var u="General",f=n.StyleID,d={};c=c||{};var p=[],x=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&i&&(f=i.StyleID);s[f]!==void 0&&(s[f].nf&&(u=s[f].nf),s[f].Interior&&p.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=tt(e);break;case"String":n.t="s",n.r=cp(He(e)),n.v=e.indexOf("<")>-1?He(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Pt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=He(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Ng[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=cp(t||e));break}if(hb(n,u,c),c.cellFormula!==!1)if(n.Formula){var m=He(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=ks(m,a),delete n.Formula,n.ArrayRange=="RC"?n.F=ks("RC:RC",a):n.ArrayRange&&(n.F=ks(n.ArrayRange,a),l.push([ft(n.F),n.F]))}else for(x=0;x<l.length;++x)a.r>=l[x][0].s.r&&a.r<=l[x][0].e.r&&a.c>=l[x][0].s.c&&a.c<=l[x][0].e.c&&(n.F=l[x][1]);c.cellStyles&&(p.forEach(function(v){!d.patternType&&v.patternType&&(d.patternType=v.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function mb(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Au(e,t){var r=t||{};eg();var n=li(Zf(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Je(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=jt(r);return i.type="string",to.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ne){a.indexOf("<"+Ne)>=0&&(s=!0)}),s)return Tb(n,r);Pi={"General Number":"General","General Date":Oe[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Oe[15],"Short Date":Oe[14],"Long Time":Oe[19],"Medium Time":Oe[18],"Short Time":Oe[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Oe[2],Standard:Oe[4],Percent:Oe[10],Scientific:Oe[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},f=[],d=r.dense?[]:{},p="",x={},m={},v=Br('<Data ss:Type="String">'),w=0,y=0,g=0,E={s:{r:2e6,c:2e6},e:{r:0,c:0}},P={},T={},k="",I=0,R=[],U={},z={},B=0,ae=[],ge=[],ue={},pe=[],de,ie=!1,M=[],se=[],me={},b=0,H=0,L={Sheets:[],WBProps:{date1904:!1}},j={};eo.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Z="";o=eo.exec(n);)switch(o[3]=(Z=o[3]).toLowerCase()){case"data":if(Z=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?xb(n.slice(w,o.index),k,v,l[l.length-1][0]=="comment"?ue:x,{c:y,r:g},P,pe[y],m,M,r):(k="",v=Br(o[0]),w=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ge.length>0&&(x.c=ge),(!r.sheetRows||r.sheetRows>g)&&x.v!==void 0&&(r.dense?(d[g]||(d[g]=[]),d[g][y]=x):d[Tt(y)+Lt(g)]=x),x.HRef&&(x.l={Target:He(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(b=y+(parseInt(x.MergeAcross,10)|0),H=g+(parseInt(x.MergeDown,10)|0),R.push({s:{c:y,r:g},e:{c:b,r:H}})),!r.sheetStubs)x.MergeAcross?y=b+1:++y;else if(x.MergeAcross||x.MergeDown){for(var V=y;V<=b;++V)for(var q=g;q<=H;++q)(V>y||q>g)&&(r.dense?(d[q]||(d[q]=[]),d[q][V]={t:"z"}):d[Tt(V)+Lt(q)]={t:"z"});y=b+1}else++y;else x=ub(o[0]),x.Index&&(y=+x.Index-1),y<E.s.c&&(E.s.c=y),y>E.e.c&&(E.e.c=y),o[0].slice(-2)==="/>"&&++y,ge=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(g<E.s.r&&(E.s.r=g),g>E.e.r&&(E.e.r=g),o[0].slice(-2)==="/>"&&(m=Br(o[0]),m.Index&&(g=+m.Index-1)),y=0,++g):(m=Br(o[0]),m.Index&&(g=+m.Index-1),me={},(m.AutoFitHeight=="0"||m.Height)&&(me.hpx=parseInt(m.Height,10),me.hpt=Yg(me.hpx),se[g]=me),m.Hidden=="1"&&(me.hidden=!0,se[g]=me));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));f.push(p),E.s.r<=E.e.r&&E.s.c<=E.e.c&&(d["!ref"]=Ue(E),r.sheetRows&&r.sheetRows<=E.e.r&&(d["!fullref"]=d["!ref"],E.e.r=r.sheetRows-1,d["!ref"]=Ue(E))),R.length&&(d["!merges"]=R),pe.length>0&&(d["!cols"]=pe),se.length>0&&(d["!rows"]=se),u[p]=d}else E={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=y=0,l.push([o[3],!1]),c=Br(o[0]),p=He(c.Name),d=r.dense?[]:{},R=[],M=[],se=[],j={name:p,Hidden:0},L.Sheets.push(j);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),pe=[],ie=!1}break;case"style":o[1]==="/"?pb(P,T,r):T=Br(o[0]);break;case"numberformat":T.nf=He(Br(o[0]).Format||"General"),Pi[T.nf]&&(T.nf=Pi[T.nf]);for(var Q=0;Q!=392&&Oe[Q]!=T.nf;++Q);if(Q==392){for(Q=57;Q!=392;++Q)if(Oe[Q]==null){Ca(T.nf,Q);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(de=Br(o[0]),de.Hidden&&(de.hidden=!0,delete de.Hidden),de.Width&&(de.wpx=parseInt(de.Width,10)),!ie&&de.wpx>10){ie=!0,nr=Kg;for(var te=0;te<pe.length;++te)pe[te]&&Rs(pe[te])}ie&&Rs(de),pe[de.Index-1||pe.length]=de;for(var Ee=0;Ee<+de.Span;++Ee)pe[pe.length]=jt(de);break;case"namedrange":if(o[1]==="/")break;L.Names||(L.Names=[]);var F=Se(o[0]),Re={Name:F.Name,Ref:ks(F.RefersTo.slice(1),{r:0,c:0})};L.Sheets.length>0&&(Re.Sheet=L.Sheets.length-1),L.Names.push(Re);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?k+=n.slice(I,o.index):I=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;T.Interior=Br(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?ZS(U,Z,n.slice(B,o.index)):B=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));mb(ue),ge.push(ue)}else l.push([o[3],!1]),c=Br(o[0]),ue={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Te=Br(o[0]);d["!autofilter"]={ref:ks(Te.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Kp(n,r);var re=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:re=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:re=!1}break;case"excelworkbook":switch(o[3]){case"date1904":L.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:re=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:re=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(B,o.index)){case"SheetHidden":j.Hidden=1;break;case"SheetVeryHidden":j.Hidden=2;break}else B=o.index+o[0].length;break;case"header":d["!margins"]||Oi(d["!margins"]={},"xlml"),isNaN(+Se(o[0]).Margin)||(d["!margins"].header=+Se(o[0]).Margin);break;case"footer":d["!margins"]||Oi(d["!margins"]={},"xlml"),isNaN(+Se(o[0]).Margin)||(d["!margins"].footer=+Se(o[0]).Margin);break;case"pagemargins":var xe=Se(o[0]);d["!margins"]||Oi(d["!margins"]={},"xlml"),isNaN(+xe.Top)||(d["!margins"].top=+xe.Top),isNaN(+xe.Left)||(d["!margins"].left=+xe.Left),isNaN(+xe.Right)||(d["!margins"].right=+xe.Right),isNaN(+xe.Bottom)||(d["!margins"].bottom=+xe.Bottom);break;case"displayrighttoleft":L.Views||(L.Views=[]),L.Views[0]||(L.Views[0]={}),L.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:re=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:re=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:re=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:re=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:re=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:re=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:re=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:re=!1}break;case"smarttags":break;default:re=!1;break}if(re||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?db(z,Z,ae,n.slice(B,o.index)):(ae=o,B=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var ne={};return!r.bookSheets&&!r.bookProps&&(ne.Sheets=u),ne.SheetNames=f,ne.Workbook=L,ne.SSF=jt(Oe),ne.Props=U,ne.Custprops=z,ne}function L0(e,t){switch(pd(t=t||{}),t.type||"base64"){case"base64":return Au(Er(e),t);case"binary":case"buffer":case"file":return Au(e,t);case"array":return Au($a(e),t)}}function gb(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=OS(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=PS(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var vb=[60,1084,2066,2165,2175];function wb(e,t,r,n,a){var s=n,i=[],o=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}i.push(o),r.l+=s;for(var l=_n(r,r.l),c=M0[l],u=0;c!=null&&vb.indexOf(l)>-1;)s=_n(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+s),i.push(o),r.l+=4+s,c=M0[l=_n(r,r.l)];var f=zn(i);Dt(f,0);var d=0;f.lens=[];for(var p=0;p<i.length;++p)f.lens.push(d),d+=i[p].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,a)}function en(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Oe[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Va[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Qi(e.v):e.w=Da(e.v):e.w=jr(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&Bs(Oe[n]||String(n))){var a=Sa(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function ll(e,t,r){return{v:e,ixfe:t,t:r}}function yb(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},i={},o=null,l=[],c="",u={},f,d="",p,x,m,v,w={},y=[],g,E,P=[],T=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},I={},R=function(ke){return ke<8?Na[ke]:ke<64&&T[ke-8]||Na[ke]},U=function(ke,Ve,Nt){var dt=Ve.XF.data;if(!(!dt||!dt.patternType||!Nt||!Nt.cellStyles)){Ve.s={},Ve.s.patternType=dt.patternType;var fn;(fn=ro(R(dt.icvFore)))&&(Ve.s.fgColor={rgb:fn}),(fn=ro(R(dt.icvBack)))&&(Ve.s.bgColor={rgb:fn})}},z=function(ke,Ve,Nt){if(!(me>1)&&!(Nt.sheetRows&&ke.r>=Nt.sheetRows)){if(Nt.cellStyles&&Ve.XF&&Ve.XF.data&&U(ke,Ve,Nt),delete Ve.ixfe,delete Ve.XF,f=ke,d=Ae(ke),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),ke.r<i.s.r&&(i.s.r=ke.r),ke.c<i.s.c&&(i.s.c=ke.c),ke.r+1>i.e.r&&(i.e.r=ke.r+1),ke.c+1>i.e.c&&(i.e.c=ke.c+1),Nt.cellFormula&&Ve.f){for(var dt=0;dt<y.length;++dt)if(!(y[dt][0].s.c>ke.c||y[dt][0].s.r>ke.r)&&!(y[dt][0].e.c<ke.c||y[dt][0].e.r<ke.r)){Ve.F=Ue(y[dt][0]),(y[dt][0].s.c!=ke.c||y[dt][0].s.r!=ke.r)&&delete Ve.f,Ve.f&&(Ve.f=""+Vt(y[dt][1],i,ke,M,B));break}}Nt.dense?(a[ke.r]||(a[ke.r]=[]),a[ke.r][ke.c]=Ve):a[d]=Ve}},B={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(B.password=t.password);var ae,ge=[],ue=[],pe=[],de=[],ie=!1,M=[];M.SheetNames=B.snames,M.sharedf=B.sharedf,M.arrayf=B.arrayf,M.names=[],M.XTI=[];var se=0,me=0,b=0,H=[],L=[],j;B.codepage=1200,Kr(1200);for(var Z=!1;e.l<e.length-1;){var V=e.l,q=e.read_shift(2);if(q===0&&se===10)break;var Q=e.l===e.length?0:e.read_shift(2),te=M0[q];if(te&&te.f){if(t.bookSheets&&se===133&&q!==133)break;if(se=q,te.r===2||te.r==12){var Ee=e.read_shift(2);if(Q-=2,!B.enc&&Ee!==q&&((Ee&255)<<8|Ee>>8)!==q)throw new Error("rt mismatch: "+Ee+"!="+q);te.r==12&&(e.l+=10,Q-=10)}var F={};if(q===10?F=te.f(e,Q,B):F=wb(q,te,e,Q,B),me==0&&[9,521,1033,2057].indexOf(se)===-1)continue;switch(q){case 34:r.opts.Date1904=k.WBProps.date1904=F;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(B.enc||(e.l=0),B.enc=F,!t.password)throw new Error("File is password-protected");if(F.valid==null)throw new Error("Encryption scheme unsupported");if(!F.valid)throw new Error("Password is incorrect");break;case 92:B.lastuser=F;break;case 66:var Re=Number(F);switch(Re){case 21010:Re=1200;break;case 32768:Re=1e4;break;case 32769:Re=1252;break}Kr(B.codepage=Re),Z=!0;break;case 317:B.rrtabid=F;break;case 25:B.winlocked=F;break;case 439:r.opts.RefreshAll=F;break;case 12:r.opts.CalcCount=F;break;case 16:r.opts.CalcDelta=F;break;case 17:r.opts.CalcIter=F;break;case 13:r.opts.CalcMode=F;break;case 14:r.opts.CalcPrecision=F;break;case 95:r.opts.CalcSaveRecalc=F;break;case 15:B.CalcRefMode=F;break;case 2211:r.opts.FullCalc=F;break;case 129:F.fDialog&&(a["!type"]="dialog"),F.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),F.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:P.push(F);break;case 430:M.push([F]),M[M.length-1].XTI=[];break;case 35:case 547:M[M.length-1].push(F);break;case 24:case 536:j={Name:F.Name,Ref:Vt(F.rgce,i,null,M,B)},F.itab>0&&(j.Sheet=F.itab-1),M.names.push(j),M[0]||(M[0]=[],M[0].XTI=[]),M[M.length-1].push(F),F.Name=="_xlnm._FilterDatabase"&&F.itab>0&&F.rgce&&F.rgce[0]&&F.rgce[0][0]&&F.rgce[0][0][0]=="PtgArea3d"&&(L[F.itab-1]={ref:Ue(F.rgce[0][0][1][2])});break;case 22:B.ExternCount=F;break;case 23:M.length==0&&(M[0]=[],M[0].XTI=[]),M[M.length-1].XTI=M[M.length-1].XTI.concat(F),M.XTI=M.XTI.concat(F);break;case 2196:if(B.biff<8)break;j!=null&&(j.Comment=F[1]);break;case 18:a["!protect"]=F;break;case 19:F!==0&&B.WTF&&console.error("Password verifier: "+F);break;case 133:s[F.pos]=F,B.snames.push(F.name);break;case 10:{if(--me)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=Ue(i),t.sheetRows&&t.sheetRows<=i.e.r){var Te=i.e.r;i.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Ue(i),i.e.r=Te}i.e.r++,i.e.c++}ge.length>0&&(a["!merges"]=ge),ue.length>0&&(a["!objects"]=ue),pe.length>0&&(a["!cols"]=pe),de.length>0&&(a["!rows"]=de),k.Sheets.push(I)}c===""?u=a:n[c]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(B.biff===8&&(B.biff={9:2,521:3,1033:4}[q]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[F.BIFFVer]||8),B.biffguess=F.BIFFVer==0,F.BIFFVer==0&&F.dt==4096&&(B.biff=5,Z=!0,Kr(B.codepage=28591)),B.biff==8&&F.BIFFVer==0&&F.dt==16&&(B.biff=2),me++)break;if(a=t.dense?[]:{},B.biff<8&&!Z&&(Z=!0,Kr(B.codepage=t.codepage||1252)),B.biff<5||F.BIFFVer==0&&F.dt==4096){c===""&&(c="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var re={pos:e.l-Q,name:c};s[re.pos]=re,B.snames.push(c)}else c=(s[V]||{name:""}).name;F.dt==32&&(a["!type"]="chart"),F.dt==64&&(a["!type"]="macro"),ge=[],ue=[],B.arrayf=y=[],pe=[],de=[],ie=!1,I={Hidden:(s[V]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[F.r]||[])[F.c]:a[Ae({c:F.c,r:F.r})])&&++F.c,g={ixfe:F.ixfe,XF:P[F.ixfe]||{},v:F.val,t:"n"},b>0&&(g.z=H[g.ixfe>>8&63]),en(g,t,r.opts.Date1904),z({c:F.c,r:F.r},g,t);break;case 5:case 517:g={ixfe:F.ixfe,XF:P[F.ixfe],v:F.val,t:F.t},b>0&&(g.z=H[g.ixfe>>8&63]),en(g,t,r.opts.Date1904),z({c:F.c,r:F.r},g,t);break;case 638:g={ixfe:F.ixfe,XF:P[F.ixfe],v:F.rknum,t:"n"},b>0&&(g.z=H[g.ixfe>>8&63]),en(g,t,r.opts.Date1904),z({c:F.c,r:F.r},g,t);break;case 189:for(var xe=F.c;xe<=F.C;++xe){var ne=F.rkrec[xe-F.c][0];g={ixfe:ne,XF:P[ne],v:F.rkrec[xe-F.c][1],t:"n"},b>0&&(g.z=H[g.ixfe>>8&63]),en(g,t,r.opts.Date1904),z({c:xe,r:F.r},g,t)}break;case 6:case 518:case 1030:{if(F.val=="String"){o=F;break}if(g=ll(F.val,F.cell.ixfe,F.tt),g.XF=P[g.ixfe],t.cellFormula){var Ne=F.formula;if(Ne&&Ne[0]&&Ne[0][0]&&Ne[0][0][0]=="PtgExp"){var Me=Ne[0][0][1][0],Ge=Ne[0][0][1][1],Qe=Ae({r:Me,c:Ge});w[Qe]?g.f=""+Vt(F.formula,i,F.cell,M,B):g.F=((t.dense?(a[Me]||[])[Ge]:a[Qe])||{}).F}else g.f=""+Vt(F.formula,i,F.cell,M,B)}b>0&&(g.z=H[g.ixfe>>8&63]),en(g,t,r.opts.Date1904),z(F.cell,g,t),o=F}break;case 7:case 519:if(o)o.val=F,g=ll(F,o.cell.ixfe,"s"),g.XF=P[g.ixfe],t.cellFormula&&(g.f=""+Vt(o.formula,i,o.cell,M,B)),b>0&&(g.z=H[g.ixfe>>8&63]),en(g,t,r.opts.Date1904),z(o.cell,g,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(F);var Ct=Ae(F[0].s);if(p=t.dense?(a[F[0].s.r]||[])[F[0].s.c]:a[Ct],t.cellFormula&&p){if(!o||!Ct||!p)break;p.f=""+Vt(F[1],i,F[0],M,B),p.F=Ue(F[0])}}break;case 1212:{if(!t.cellFormula)break;if(d){if(!o)break;w[Ae(o.cell)]=F[0],p=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[Ae(o.cell)],(p||{}).f=""+Vt(F[0],i,f,M,B)}}break;case 253:g=ll(l[F.isst].t,F.ixfe,"s"),l[F.isst].h&&(g.h=l[F.isst].h),g.XF=P[g.ixfe],b>0&&(g.z=H[g.ixfe>>8&63]),en(g,t,r.opts.Date1904),z({c:F.c,r:F.r},g,t);break;case 513:t.sheetStubs&&(g={ixfe:F.ixfe,XF:P[F.ixfe],t:"z"},b>0&&(g.z=H[g.ixfe>>8&63]),en(g,t,r.opts.Date1904),z({c:F.c,r:F.r},g,t));break;case 190:if(t.sheetStubs)for(var be=F.c;be<=F.C;++be){var $e=F.ixfe[be-F.c];g={ixfe:$e,XF:P[$e],t:"z"},b>0&&(g.z=H[g.ixfe>>8&63]),en(g,t,r.opts.Date1904),z({c:be,r:F.r},g,t)}break;case 214:case 516:case 4:g=ll(F.val,F.ixfe,"s"),g.XF=P[g.ixfe],b>0&&(g.z=H[g.ixfe>>8&63]),en(g,t,r.opts.Date1904),z({c:F.c,r:F.r},g,t);break;case 0:case 512:me===1&&(i=F);break;case 252:l=F;break;case 1054:if(B.biff==4){H[b++]=F[1];for(var wt=0;wt<b+163&&Oe[wt]!=F[1];++wt);wt>=163&&Ca(F[1],b+163)}else Ca(F[1],F[0]);break;case 30:{H[b++]=F;for(var Bt=0;Bt<b+163&&Oe[Bt]!=F;++Bt);Bt>=163&&Ca(F,b+163)}break;case 229:ge=ge.concat(F);break;case 93:ue[F.cmo[0]]=B.lastobj=F;break;case 438:B.lastobj.TxO=F;break;case 127:B.lastobj.ImData=F;break;case 440:for(v=F[0].s.r;v<=F[0].e.r;++v)for(m=F[0].s.c;m<=F[0].e.c;++m)p=t.dense?(a[v]||[])[m]:a[Ae({c:m,r:v})],p&&(p.l=F[1]);break;case 2048:for(v=F[0].s.r;v<=F[0].e.r;++v)for(m=F[0].s.c;m<=F[0].e.c;++m)p=t.dense?(a[v]||[])[m]:a[Ae({c:m,r:v})],p&&p.l&&(p.l.Tooltip=F[1]);break;case 28:{if(B.biff<=5&&B.biff>=2)break;p=t.dense?(a[F[0].r]||[])[F[0].c]:a[Ae(F[0])];var Qt=ue[F[2]];p||(t.dense?(a[F[0].r]||(a[F[0].r]=[]),p=a[F[0].r][F[0].c]={t:"z"}):p=a[Ae(F[0])]={t:"z"},i.e.r=Math.max(i.e.r,F[0].r),i.s.r=Math.min(i.s.r,F[0].r),i.e.c=Math.max(i.e.c,F[0].c),i.s.c=Math.min(i.s.c,F[0].c)),p.c||(p.c=[]),x={a:F[1],t:Qt.TxO.t},p.c.push(x)}break;case 2173:z3(P[F.ixfe],F.ext);break;case 125:{if(!B.cellStyles)break;for(;F.e>=F.s;)pe[F.e--]={width:F.w/256,level:F.level||0,hidden:!!(F.flags&1)},ie||(ie=!0,cd(F.w/256)),Rs(pe[F.e+1])}break;case 520:{var lt={};F.level!=null&&(de[F.r]=lt,lt.level=F.level),F.hidden&&(de[F.r]=lt,lt.hidden=!0),F.hpt&&(de[F.r]=lt,lt.hpt=F.hpt,lt.hpx=no(F.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Oi(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[q]]=F;break;case 161:a["!margins"]||Oi(a["!margins"]={}),a["!margins"].header=F.header,a["!margins"].footer=F.footer;break;case 574:F.RTL&&(k.Views[0].RTL=!0);break;case 146:T=F;break;case 2198:ae=F;break;case 140:E=F;break;case 442:c?I.CodeName=F||I.name:k.WBProps.CodeName=F||"ThisWorkbook";break}}else te||console.error("Missing Info for XLS Record 0x"+q.toString(16)),e.l+=Q}return r.SheetNames=ln(s).sort(function(je,ke){return Number(je)-Number(ke)}).map(function(je){return s[je].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&L.forEach(function(je,ke){r.Sheets[r.SheetNames[ke]]["!autofilter"]=je}),r.Strings=l,r.SSF=jt(Oe),B.enc&&(r.Encryption=B.enc),ae&&(r.Themes=ae),r.Metadata={},E!==void 0&&(r.Metadata.Country=E),M.names.length>0&&(k.Names=M.names),r.Workbook=k,r}var zp={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function _b(e,t,r){var n=Be.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Tp(n,MS,zp.DSI);for(var s in a)t[s]=a[s]}catch(c){if(r.WTF)throw c}var i=Be.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=Tp(i,BS,zp.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(Fg(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function hv(e,t){t||(t={}),pd(t),zm(),t.codepage&&Gf(t.codepage);var r,n;if(e.FullPaths){if(Be.find(e,"/encryption"))throw new Error("File is password-protected");r=Be.find(e,"!CompObj"),n=Be.find(e,"/Workbook")||Be.find(e,"/Book")}else{switch(t.type){case"base64":e=Gr(Er(e));break;case"binary":e=Gr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Dt(e,0),n={content:e}}var a,s;if(r&&gb(r),t.bookProps&&!t.bookSheets)a={};else{var i=Le?"buffer":"array";if(n&&n.content)a=yb(n.content,t);else if((s=Be.find(e,"PerfectOffice_MAIN"))&&s.content)a=bi.to_workbook(s.content,(t.type=i,t));else if((s=Be.find(e,"NativeContent_MAIN"))&&s.content)a=bi.to_workbook(s.content,(t.type=i,t));else throw(s=Be.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Be.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=iA(e))}var o={};return e.FullPaths&&_b(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}var cc={0:{f:rN},1:{f:iN},2:{f:xN},3:{f:uN},4:{f:lN},5:{f:pN},6:{f:vN},7:{f:dN},8:{f:EN},9:{f:kN},10:{f:yN},11:{f:_N},12:{f:oN},13:{f:mN},14:{f:fN},15:{f:cN},16:{f:lv},17:{f:wN},18:{f:hN},19:{f:nd},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:qN},40:{},42:{},43:{f:y3},44:{f:w3},45:{f:_3},46:{f:E3},47:{f:k3},48:{},49:{f:SS},50:{},51:{f:V3},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:zg},62:{f:gN},63:{f:Y3},64:{f:PN},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:qt,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:ON},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:sN},148:{f:nN,p:16},151:{f:AN},152:{},153:{f:XN},154:{},155:{},156:{f:KN},157:{},158:{},159:{T:1,f:B4},160:{T:-1},161:{T:1,f:Ha},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:SN},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:H3},336:{T:-1},337:{f:W3,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:R0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:$g},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:CN},427:{f:NN},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:FN},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:aN},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:TN},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:R0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:nA},633:{T:1},634:{T:-1},635:{T:1,f:rA},636:{T:-1},637:{f:AS},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:MN},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:RN},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},M0={6:{f:Su},10:{f:Dn},12:{f:gt},13:{f:gt},14:{f:ht},15:{f:ht},16:{f:Gt},17:{f:ht},18:{f:ht},19:{f:gt},20:{f:bp},21:{f:bp},23:{f:$g},24:{f:Op},25:{f:ht},26:{},27:{},28:{f:e4},29:{},34:{f:ht},35:{f:Fp},38:{f:Gt},39:{f:Gt},40:{f:Gt},41:{f:Gt},42:{f:ht},43:{f:ht},47:{f:a3},49:{f:IT},51:{f:gt},60:{},61:{f:PT},64:{f:ht},65:{f:DT},66:{f:gt},77:{},80:{},81:{},82:{},85:{f:gt},89:{},90:{},91:{},92:{f:ST},93:{f:r4},94:{},95:{f:ht},96:{},97:{},99:{f:ht},125:{f:zg},128:{f:WT},129:{f:TT},130:{f:gt},131:{f:ht},132:{f:ht},133:{f:AT},134:{},140:{f:l4},141:{f:gt},144:{},146:{f:u4},151:{},152:{},153:{},154:{},155:{},156:{f:gt},157:{},158:{},160:{f:x4},161:{f:d4},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:$T},190:{f:zT},193:{f:Dn},197:{},198:{},199:{},200:{},201:{},202:{f:ht},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:gt},220:{},221:{f:ht},222:{},224:{f:VT},225:{f:ET},226:{f:Dn},227:{},229:{f:t4},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:CT},253:{f:jT},255:{f:NT},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Ig},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ht},353:{f:Dn},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:KT},431:{f:ht},432:{},433:{},434:{},437:{},438:{f:s4},439:{f:ht},440:{f:i4},441:{},442:{f:vo},443:{},444:{f:gt},445:{},446:{},448:{f:Dn},449:{f:OT,r:2},450:{f:Dn},512:{f:Cp},513:{f:p4},515:{f:GT},516:{f:LT},517:{f:Np},519:{f:m4},520:{f:bT},523:{},545:{f:Pp},549:{f:Ap},566:{},574:{f:RT},638:{f:UT},659:{},1048:{},1054:{f:MT},1084:{},1212:{f:JT},2048:{f:o4},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:sl},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Dn},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:f4,r:12},2173:{f:$3,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ht,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:qT,r:12},2197:{},2198:{f:I3,r:12},2199:{},2200:{},2201:{},2202:{f:QT,r:12},2203:{f:Dn},2204:{},2205:{},2206:{},2207:{},2211:{f:FT},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:gt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:h4},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:c4},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Cp},1:{},2:{f:y4},3:{f:w4},4:{f:v4},5:{f:Np},7:{f:_4},8:{},9:{f:sl},11:{},22:{f:gt},30:{f:BT},31:{},32:{},33:{f:Pp},36:{},37:{f:Ap},50:{f:k4},62:{},52:{},67:{},68:{f:gt},69:{},86:{},126:{},127:{f:g4},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:E4},223:{},234:{},354:{},421:{},518:{f:Su},521:{f:sl},536:{f:Op},547:{f:Fp},561:{},579:{},1030:{f:Su},1033:{f:sl},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ur(e,t,r,n){var a=t;if(!isNaN(a)){var s=(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&kg(r)&&e.push(r)}}function Hp(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,o=s&&s.index||e.length,l=GE(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,f=0,d=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(i=0;i<l.length;++i){var m=l[i].trim(),v=m.slice(0,3).toLowerCase();if(v=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(v!="<td"&&v!="<th")){var w=m.split(/<\/t[dh]>/i);for(o=0;o<w.length;++o){var y=w[o].trim();if(y.match(/<t[dh]/i)){for(var g=y,E=0;g.charAt(0)=="<"&&(E=g.indexOf(">"))>-1;)g=g.slice(E+1);for(var P=0;P<x.length;++P){var T=x[P];T.s.c==u&&T.s.r<c&&c<=T.e.r&&(u=T.e.c+1,P=-1)}var k=Se(y.slice(0,y.indexOf(">")));d=k.colspan?+k.colspan:1,((f=+k.rowspan)>1||d>1)&&x.push({s:{r:c,c:u},e:{r:c+(f||1)-1,c:u+d-1}});var I=k.t||k["data-t"]||"";if(!g.length){u+=d;continue}if(g=cg(g),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),!g.length){u+=d;continue}var R={t:"s",v:g};r.raw||!g.trim().length||I=="s"||(g==="TRUE"?R={t:"b",v:!0}:g==="FALSE"?R={t:"b",v:!1}:isNaN(Jr(g))?isNaN(Ps(g).getDate())||(R={t:"d",v:Pt(g)},r.cellDates||(R={t:"n",v:or(R.v)}),R.z=r.dateNF||Oe[14]):R={t:"n",v:Jr(g)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=R):n[Ae({r:c,c:u})]=R,u+=d}}}}return n["!ref"]=Ue(p),x.length&&(n["!merges"]=x),n}function kb(e,t,r,n){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>r||a[c].s.c>i)&&!(a[c].e.r<r||a[c].e.c<i)){if(a[c].s.r<r||a[c].s.c<i){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var u=Ae({r,c:i}),f=n.dense?(e[r]||[])[i]:e[u],d=f&&f.v!=null&&(f.h||Qf(f.w||(bn(f),f.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":f&&(p["data-t"]=f&&f.t||"z",f.v!=null&&(p["data-v"]=f.v),f.z!=null&&(p["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+f.l.Target+'">'+d+"</a>")),p.id=(n.id||"sjs")+"-"+u,s.push(lS("td",d,p))}}var x="<tr>";return x+s.join("")+"</tr>"}var Eb='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Sb="</body></html>";function Tb(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return fa(Hp(r[0],t),t);var n=md();return r.forEach(function(a,s){gd(n,Hp(a,t),"Sheet"+(s+1))}),n}function Ab(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Cb(e,t){var r=t||{},n=r.header!=null?r.header:Eb,a=r.footer!=null?r.footer:Sb,s=[n],i=Us(e["!ref"]);r.dense=Array.isArray(e),s.push(Ab(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)s.push(kb(e,i,o,r));return s.push("</table>"+a),s.join("")}function pv(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?ar(n.origin):n.origin;a=i.r,s=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var u=Us(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),a==-1&&(c.e.r=a=u.e.r+1)}var f=[],d=0,p=e["!rows"]||(e["!rows"]=[]),x=0,m=0,v=0,w=0,y=0,g=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&m<l;++x){var E=o[x];if(Vp(E)){if(n.display)continue;p[m]={hidden:!0}}var P=E.children;for(v=w=0;v<P.length;++v){var T=P[v];if(!(n.display&&Vp(T))){var k=T.hasAttribute("data-v")?T.getAttribute("data-v"):T.hasAttribute("v")?T.getAttribute("v"):cg(T.innerHTML),I=T.getAttribute("data-z")||T.getAttribute("z");for(d=0;d<f.length;++d){var R=f[d];R.s.c==w+s&&R.s.r<m+a&&m+a<=R.e.r&&(w=R.e.c+1-s,d=-1)}g=+T.getAttribute("colspan")||1,((y=+T.getAttribute("rowspan")||1)>1||g>1)&&f.push({s:{r:m+a,c:w+s},e:{r:m+a+(y||1)-1,c:w+s+(g||1)-1}});var U={t:"s",v:k},z=T.getAttribute("data-t")||T.getAttribute("t")||"";k!=null&&(k.length==0?U.t=z||"z":n.raw||k.trim().length==0||z=="s"||(k==="TRUE"?U={t:"b",v:!0}:k==="FALSE"?U={t:"b",v:!1}:isNaN(Jr(k))?isNaN(Ps(k).getDate())||(U={t:"d",v:Pt(k)},n.cellDates||(U={t:"n",v:or(U.v)}),U.z=n.dateNF||Oe[14]):U={t:"n",v:Jr(k)})),U.z===void 0&&I!=null&&(U.z=I);var B="",ae=T.getElementsByTagName("A");if(ae&&ae.length)for(var ge=0;ge<ae.length&&!(ae[ge].hasAttribute("href")&&(B=ae[ge].getAttribute("href"),B.charAt(0)!="#"));++ge);B&&B.charAt(0)!="#"&&(U.l={Target:B}),n.dense?(e[m+a]||(e[m+a]=[]),e[m+a][w+s]=U):e[Ae({c:w+s,r:m+a})]=U,c.e.c<w+s&&(c.e.c=w+s),w+=g}}++m}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,m-1+a),e["!ref"]=Ue(c),m>=l&&(e["!fullref"]=Ue((c.e.r=o.length-x+m-1+a,c))),e}function xv(e,t){var r=t||{},n=r.dense?[]:{};return pv(n,e,t)}function Nb(e,t){return fa(xv(e,t),t)}function Vp(e){var t="",r=bb(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function bb(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Fb(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=He(t.replace(/<[^>]*>/g,""));return[r]}var Wp={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function mv(e,t){var r=t||{},n=Zf(e),a=[],s,i,o={name:""},l="",c=0,u,f,d={},p=[],x=r.dense?[]:{},m,v,w={value:""},y="",g=0,E=[],P=-1,T=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},I=0,R={},U=[],z={},B=0,ae=0,ge=[],ue=1,pe=1,de=[],ie={Names:[]},M={},se=["",""],me=[],b={},H="",L=0,j=!1,Z=!1,V=0;for(eo.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=eo.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"工作表":m[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?x["!ref"]=Ue(k):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(x["!fullref"]=x["!ref"],k.e.r=r.sheetRows-1,x["!ref"]=Ue(k)),U.length&&(x["!merges"]=U),ge.length&&(x["!rows"]=ge),u.name=u.名称||u.name,typeof JSON<"u"&&JSON.stringify(u),p.push(u.name),d[u.name]=x,Z=!1):m[0].charAt(m[0].length-2)!=="/"&&(u=Se(m[0],!1),P=T=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,x=r.dense?[]:{},U=[],ge=[],Z=!0);break;case"table-row-group":m[1]==="/"?--I:++I;break;case"table-row":case"行":if(m[1]==="/"){P+=ue,ue=1;break}if(f=Se(m[0],!1),f.行号?P=f.行号-1:P==-1&&(P=0),ue=+f["number-rows-repeated"]||1,ue<10)for(V=0;V<ue;++V)I>0&&(ge[P+V]={level:I});T=-1;break;case"covered-table-cell":m[1]!=="/"&&++T,r.sheetStubs&&(r.dense?(x[P]||(x[P]=[]),x[P][T]={t:"z"}):x[Ae({r:P,c:T})]={t:"z"}),y="",E=[];break;case"table-cell":case"数据":if(m[0].charAt(m[0].length-2)==="/")++T,w=Se(m[0],!1),pe=parseInt(w["number-columns-repeated"]||"1",10),v={t:"z",v:null},w.formula&&r.cellFormula!=!1&&(v.f=Bp(He(w.formula))),(w.数据类型||w["value-type"])=="string"&&(v.t="s",v.v=He(w["string-value"]||""),r.dense?(x[P]||(x[P]=[]),x[P][T]=v):x[Ae({r:P,c:T})]=v),T+=pe-1;else if(m[1]!=="/"){++T,y="",g=0,E=[],pe=1;var q=ue?P+ue-1:P;if(T>k.e.c&&(k.e.c=T),T<k.s.c&&(k.s.c=T),P<k.s.r&&(k.s.r=P),q>k.e.r&&(k.e.r=q),w=Se(m[0],!1),me=[],b={},v={t:w.数据类型||w["value-type"],v:null},r.cellFormula)if(w.formula&&(w.formula=He(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(B=parseInt(w["number-matrix-rows-spanned"],10)||0,ae=parseInt(w["number-matrix-columns-spanned"],10)||0,z={s:{r:P,c:T},e:{r:P+B-1,c:T+ae-1}},v.F=Ue(z),de.push([z,v.F])),w.formula)v.f=Bp(w.formula);else for(V=0;V<de.length;++V)P>=de[V][0].s.r&&P<=de[V][0].e.r&&T>=de[V][0].s.c&&T<=de[V][0].e.c&&(v.F=de[V][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(B=parseInt(w["number-rows-spanned"],10)||0,ae=parseInt(w["number-columns-spanned"],10)||0,z={s:{r:P,c:T},e:{r:P+B-1,c:T+ae-1}},U.push(z)),w["number-columns-repeated"]&&(pe=parseInt(w["number-columns-repeated"],10)),v.t){case"boolean":v.t="b",v.v=tt(w["boolean-value"]);break;case"float":v.t="n",v.v=parseFloat(w.value);break;case"percentage":v.t="n",v.v=parseFloat(w.value);break;case"currency":v.t="n",v.v=parseFloat(w.value);break;case"date":v.t="d",v.v=Pt(w["date-value"]),r.cellDates||(v.t="n",v.v=or(v.v)),v.z="m/d/yy";break;case"time":v.t="n",v.v=HE(w["time-value"])/86400,r.cellDates&&(v.t="d",v.v=Dc(v.v)),v.z="HH:MM:SS";break;case"number":v.t="n",v.v=parseFloat(w.数据数值);break;default:if(v.t==="string"||v.t==="text"||!v.t)v.t="s",w["string-value"]!=null&&(y=He(w["string-value"]),E=[]);else throw new Error("Unsupported value type "+v.t)}}else{if(j=!1,v.t==="s"&&(v.v=y||"",E.length&&(v.R=E),j=g==0),M.Target&&(v.l=M),me.length>0&&(v.c=me,me=[]),y&&r.cellText!==!1&&(v.w=y),j&&(v.t="z",delete v.v),(!j||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=P))for(var Q=0;Q<ue;++Q){if(pe=parseInt(w["number-columns-repeated"]||"1",10),r.dense)for(x[P+Q]||(x[P+Q]=[]),x[P+Q][T]=Q==0?v:jt(v);--pe>0;)x[P+Q][T+pe]=jt(v);else for(x[Ae({r:P+Q,c:T})]=v;--pe>0;)x[Ae({r:P+Q,c:T+pe})]=jt(v);k.e.c<=T&&(k.e.c=T)}pe=parseInt(w["number-columns-repeated"]||"1",10),T+=pe-1,pe=0,v={},y="",E=[]}M={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s;b.t=y,E.length&&(b.R=E),b.a=H,me.push(b)}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);H="",L=0,y="",g=0,E=[];break;case"creator":m[1]==="/"?H=n.slice(L,m.index):L=m.index+m[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);y="",g=0,E=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(R[o.name]=l,(s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(l="",o=Se(m[0],!1),a.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Se(m[0],!1),l+=Wp[m[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Se(m[0],!1),l+=Wp[m[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":i=Se(m[0],!1),se=Tu(i["cell-range-address"]);var te={Name:i.name,Ref:se[0]+"!"+se[1]};Z&&(te.Sheet=p.length),ie.Names.push(te);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(m[1]==="/"&&(!w||!w["string-value"])){var Ee=Fb(n.slice(g,m.index));y=(y.length>0?y+`
`:"")+Ee[0]}else Se(m[0],!1),g=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{se=Tu(Se(m[0])["target-range-address"]),d[se[0]]["!autofilter"]={ref:se[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(M=Se(m[0],!1),!M.href)break;M.Target=He(M.href),delete M.href,M.Target.charAt(0)=="#"&&M.Target.indexOf(".")>-1?(se=Tu(M.Target.slice(1)),M.Target="#"+se[0]+"!"+se[1]):M.Target.match(/^\.\.[\\\/]/)&&(M.Target=M.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(m)}}var F={Sheets:d,SheetNames:p,Workbook:ie};return r.bookSheets&&delete F.Sheets,F}function Gp(e,t){t=t||{},Nr(e,"META-INF/manifest.xml")&&GS(mt(e,"META-INF/manifest.xml"),t);var r=wr(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=mv(Je(r),t);return Nr(e,"meta.xml")&&(n.Props=bg(mt(e,"meta.xml"))),n}function Kp(e,t){return mv(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function dd(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function B0(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Je($a(e))}function U0(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function Xp(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Ob(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function ao(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function At(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Kt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=ao(e,r),s=a&7;a=Math.floor(a/8);var i=0,o;if(a==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=ao(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var c={data:o,type:s};t[a]==null?t[a]=[c]:t[a].push(c)}return t}function hd(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Pb(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=ao(e,n),s=Kt(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:At(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Kt(o.data),c=At(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(i.merge=At(s[3][0].data)>>>0>0),r.push(i)}return r}function Rb(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=ao(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}a.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[U0(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(a.push(a[0].slice(-l)),c-=l;c>=a[a.length-1].length;)a.push(a[a.length-1]),c-=a[a.length-1].length;a.push(a[0].slice(-l,-l+c))}}var u=U0(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Db(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Rb(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return U0(t)}function Ib(e,t,r,n){var a=dd(e),s=a.getUint32(4,!0),i=(n>1?12:8)+Xp(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);s&512&&(o=a.getUint32(i,!0),i+=4),i+=Xp(s&(n>1?12288:4096))*4,s&16&&(l=a.getUint32(i,!0),i+=4),s&32&&(c=a.getFloat64(i,!0),i+=8),s&64&&(u.setTime(u.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(l>-1)f={t:"s",v:t[l]};else if(!isNaN(c))f={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function jb(e,t,r){var n=dd(e),a=n.getUint32(8,!0),s=12,i=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);a&1&&(l=Ob(e,s),s+=16),a&2&&(c=n.getFloat64(s,!0),s+=8),a&4&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(o=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(i>-1)f={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return f}function Lb(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Ib(e,t,r,e[0]);case 5:return jb(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ta(e){var t=Kt(e);return ao(t[1][0].data)}function Yp(e,t){var r=Kt(t.data),n=At(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(i){var o=Kt(i.data),l=At(o[1][0].data)>>>0;switch(n){case 1:s[l]=B0(o[3][0].data);break;case 8:{var c=e[ta(o[9][0].data)][0],u=Kt(c.data),f=e[ta(u[1][0].data)][0],d=At(f.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var p=Kt(f.data);s[l]=p[3].map(function(x){return B0(x.data)}).join("")}break}}),s}function Mb(e,t){var r,n,a,s,i,o,l,c,u,f,d,p,x,m,v=Kt(e),w=At(v[1][0].data)>>>0,y=At(v[2][0].data)>>>0,g=((n=(r=v[8])==null?void 0:r[0])==null?void 0:n.data)&&At(v[8][0].data)>0||!1,E,P;if((s=(a=v[7])==null?void 0:a[0])!=null&&s.data&&t!=0)E=(o=(i=v[7])==null?void 0:i[0])==null?void 0:o.data,P=(c=(l=v[6])==null?void 0:l[0])==null?void 0:c.data;else if((f=(u=v[4])==null?void 0:u[0])!=null&&f.data&&t!=1)E=(p=(d=v[4])==null?void 0:d[0])==null?void 0:p.data,P=(m=(x=v[3])==null?void 0:x[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var T=g?4:1,k=dd(E),I=[],R=0;R<E.length/2;++R){var U=k.getUint16(R*2,!0);U<65535&&I.push([R,U])}if(I.length!=y)throw"Expected ".concat(y," cells, found ").concat(I.length);var z=[];for(R=0;R<I.length-1;++R)z[I[R][0]]=P.subarray(I[R][1]*T,I[R+1][1]*T);return I.length>=1&&(z[I[I.length-1][0]]=P.subarray(I[I.length-1][1]*T)),{R:w,cells:z}}function Bb(e,t){var r,n=Kt(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?At(n[7][0].data)>>>0>0?1:0:-1,s=hd(n[5],function(i){return Mb(i,a)});return{nrows:At(n[4][0].data)>>>0,data:s.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,c){if(i[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));i[o.R][c]=l}),i},[])}}function Ub(e,t,r){var n,a=Kt(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(At(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(At(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Ue(s);var i=Kt(a[4][0].data),o=Yp(e,e[ta(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?Yp(e,e[ta(i[17][0].data)][0]):[],c=Kt(i[3][0].data),u=0;c[1].forEach(function(f){var d=Kt(f.data),p=e[ta(d[2][0].data)][0],x=At(p.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var m=Bb(e,p);m.data.forEach(function(v,w){v.forEach(function(y,g){var E=Ae({r:u+w,c:g}),P=Lb(y,o,l);P&&(r[E]=P)})}),u+=m.nrows})}function $b(e,t){var r=Kt(t.data),n={"!ref":"A1"},a=e[ta(r[2][0].data)],s=At(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return Ub(e,a[0],n),n}function zb(e,t){var r,n=Kt(t.data),a={name:(r=n[1])!=null&&r[0]?B0(n[1][0].data):"",sheets:[]},s=hd(n[2],ta);return s.forEach(function(i){e[i].forEach(function(o){var l=At(o.meta[1][0].data);l==6e3&&a.sheets.push($b(e,o))})}),a}function Hb(e,t){var r=md(),n=Kt(t.data),a=hd(n[1],ta);if(a.forEach(function(s){e[s].forEach(function(i){var o=At(i.meta[1][0].data);if(o==2){var l=zb(e,i);l.sheets.forEach(function(c,u){gd(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Cu(e){var t,r,n,a,s={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=Db(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var u;try{u=Pb(c)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){s[f.id]=f.messages,i.push(f.id)})}}),!i.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&At(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||i.forEach(function(l){s[l].forEach(function(c){var u=At(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Hb(s,o)}function Vb(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function pd(e){Vb([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Wb(e){return ps.WS.indexOf(e)>-1?"sheet":e==ps.CS?"chart":e==ps.DS?"dialog":e==ps.MS?"macro":e&&e.length?e:"sheet"}function Gb(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Wb(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Kb(e,t,r,n,a,s,i,o,l,c,u,f){try{s[n]=Ci(wr(e,r,!0),t);var d=mt(e,t),p;switch(o){case"sheet":p=ZN(d,t,a,l,s[n],c,u,f);break;case"chart":if(p=eb(d,t,a,l,s[n],c,u,f),!p||!p["!drawel"])break;var x=ui(p["!drawel"].Target,t),m=D0(x),v=Q3(wr(e,x,!0),Ci(wr(e,m,!0),x)),w=ui(v,x),y=D0(w);p=jN(wr(e,w,!0),w,l,Ci(wr(e,y,!0),w),c,p);break;case"macro":p=tb(d,t,a,l,s[n],c,u,f);break;case"dialog":p=rb(d,t,a,l,s[n],c,u,f);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=p;var g=[];s&&s[n]&&ln(s[n]).forEach(function(E){var P="";if(s[n][E].Type==ps.CMNT){P=ui(s[n][E].Target,t);var T=ib(mt(e,P,!0),P,l);if(!T||!T.length)return;Dp(p,T,!1)}s[n][E].Type==ps.TCMNT&&(P=ui(s[n][E].Target,t),g=g.concat(eA(mt(e,P,!0),l)))}),g&&g.length&&Dp(p,g,!0,l.people||[])}catch(E){if(l.WTF)throw E}}function Ar(e){return e.charAt(0)=="/"?e.slice(1):e}function Xb(e,t){if(eg(),t=t||{},pd(t),Nr(e,"META-INF/manifest.xml")||Nr(e,"objectdata.xml"))return Gp(e,t);if(Nr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Cu<"u"){if(e.FileIndex)return Cu(e);var r=Be.utils.cfb_new();return op(e).forEach(function(ge){YE(r,ge,XE(e,ge))}),Cu(r)}throw new Error("Unsupported NUMBERS file")}if(!Nr(e,"[Content_Types].xml"))throw Nr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Nr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=op(e),a=VS(wr(e,"[Content_Types].xml")),s=!1,i,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",mt(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!mt(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(Fi=[],a.sst)try{Fi=sb(mt(e,Ar(a.sst)),a.sst,t)}catch(ge){if(t.WTF)throw ge}t.cellStyles&&a.themes.length&&(l=ab(wr(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(c=nb(mt(e,Ar(a.style)),a.style,l,t))}a.links.map(function(ge){try{var ue=Ci(wr(e,D0(Ar(ge))),ge);return lb(mt(e,Ar(ge)),ue,ge,t)}catch{}});var u=QN(mt(e,Ar(a.workbooks[0])),a.workbooks[0],t),f={},d="";a.coreprops.length&&(d=mt(e,Ar(a.coreprops[0]),!0),d&&(f=bg(d)),a.extprops.length!==0&&(d=mt(e,Ar(a.extprops[0]),!0),d&&YS(d,f,t)));var p={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(d=wr(e,Ar(a.custprops[0]),!0),d&&(p=JS(d,t)));var x={};if((t.bookSheets||t.bookProps)&&(u.Sheets?i=u.Sheets.map(function(ue){return ue.name}):f.Worksheets&&f.SheetNames.length>0&&(i=f.SheetNames),t.bookProps&&(x.Props=f,x.Custprops=p),t.bookSheets&&typeof i<"u"&&(x.SheetNames=i),t.bookSheets?x.SheetNames:t.bookProps))return x;i={};var m={};t.bookDeps&&a.calcchain&&(m=ob(mt(e,Ar(a.calcchain)),a.calcchain));var v=0,w={},y,g;{var E=u.Sheets;f.Worksheets=E.length,f.SheetNames=[];for(var P=0;P!=E.length;++P)f.SheetNames[P]=E[P].name}var T=s?"bin":"xml",k=a.workbooks[0].lastIndexOf("/"),I=(a.workbooks[0].slice(0,k+1)+"_rels/"+a.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");Nr(e,I)||(I="xl/_rels/workbook."+T+".rels");var R=Ci(wr(e,I,!0),I.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=cb(mt(e,Ar(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=tA(mt(e,Ar(a.people[0])),t)),R&&(R=Gb(R,u.Sheets));var U=mt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=f.Worksheets;++v){var z="sheet";if(R&&R[v]?(y="xl/"+R[v][1].replace(/[\/]?xl\//,""),Nr(e,y)||(y=R[v][1]),Nr(e,y)||(y=I.replace(/_rels\/.*$/,"")+R[v][1]),z=R[v][2]):(y="xl/worksheets/sheet"+(v+1-U)+"."+T,y=y.replace(/sheet0\./,"sheet.")),g=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(v!=t.sheets)continue e;break;case"string":if(f.SheetNames[v].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var B=!1,ae=0;ae!=t.sheets.length;++ae)typeof t.sheets[ae]=="number"&&t.sheets[ae]==v&&(B=1),typeof t.sheets[ae]=="string"&&t.sheets[ae].toLowerCase()==f.SheetNames[v].toLowerCase()&&(B=1);if(!B)continue e}}Kb(e,y,g,f.SheetNames[v],v,w,i,z,t,u,l,c)}return x={Directory:a,Workbook:u,Props:f,Custprops:p,Deps:m,Sheets:i,SheetNames:f.SheetNames,Strings:Fi,Styles:c,Themes:l,SSF:jt(Oe)},t&&t.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(ge,ue){ge=ge.replace(/^Root Entry[\/]/,""),x.keys.push(ge),x.files[ge]=e.FileIndex[ue]}))),t&&t.bookVBA&&(a.vba.length>0?x.vbaraw=mt(e,Ar(a.vba[0]),!0):a.defaults&&a.defaults.bin===sA&&(x.vbaraw=mt(e,"xl/vbaProject.bin",!0))),x}function Yb(e,t){var r=t||{},n="Workbook",a=Be.find(e,n);try{if(n="/!DataSpaces/Version",a=Be.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if($4(a.content),n="/!DataSpaces/DataSpaceMap",a=Be.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=H4(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Be.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=V4(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Be.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);G4(a.content)}catch{}if(n="/EncryptionInfo",a=Be.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=K4(a.content);if(n="/EncryptedPackage",a=Be.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function xd(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Er(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function qb(e,t){return Be.find(e,"EncryptedPackage")?Yb(e,t):hv(e,t)}function Jb(e,t){var r,n=e,a=t||{};return a.type||(a.type=Le&&Buffer.isBuffer(e)?"buffer":"base64"),r=ig(n,a),Xb(r,a)}function gv(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return L0(e.slice(r),t);default:break e}return to.to_workbook(e,t)}function Qb(e,t){var r="",n=xd(e,t);switch(t.type){case"base64":r=Er(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Ia(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Je(r)),t.type="binary",gv(r,t)}function Zb(e,t){var r=e;return t.type=="base64"&&(r=Er(r)),r=Ji.utils.decode(1200,r.slice(2),"str"),t.type="binary",gv(r,t)}function eF(e){return e.match(/[^\x00-\x7F]/)?fi(e):e}function Nu(e,t,r,n){return n?(r.type="string",to.to_workbook(e,r)):to.to_workbook(t,r)}function $0(e,t){zm();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return $0(new Uint8Array(e),(r=jt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Es={},r.dateNF&&(Es.dateNF=r.dateNF),r.type||(r.type=Le&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Le?"buffer":"binary",n=$E(e),typeof Uint8Array<"u"&&!Le&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=eF(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=jt(r),r.type="array",$0(Kf(n),r)}switch((a=xd(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return qb(Be.read(n,r),r);break;case 9:if(a[1]<=8)return hv(n,r);break;case 60:return L0(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return N4(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return A4.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?Jb(n,r):Nu(e,n,r,s);case 239:return a[3]===60?L0(n,r):Nu(e,n,r,s);case 255:if(a[1]===254)return Zb(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return bi.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return bi.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Rp.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return s3.to_workbook(n,r);break;case 10:case 13:case 32:return Qb(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return S4.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Rp.to_workbook(n,r):Nu(e,n,r,s)}function tF(e,t,r,n,a,s,i,o){var l=Lt(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,d=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!i||e[r])for(var p=t.s.c;p<=t.e.c;++p){var x=i?e[r][p]:e[n[p]+l];if(x===void 0||x.t===void 0){if(c===void 0)continue;s[p]!=null&&(d[s[p]]=c);continue}var m=x.v;switch(x.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(s[p]!=null){if(m==null)if(x.t=="e"&&m===null)d[s[p]]=null;else if(c!==void 0)d[s[p]]=c;else if(u&&m===null)d[s[p]]=null;else continue;else d[s[p]]=u&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?m:bn(x,m,o);m!=null&&(f=!1)}}return{row:d,isempty:f}}function z0(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=ft(u);break;case"number":l=ft(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(a=0);var f=Lt(l.s.r),d=[],p=[],x=0,m=0,v=Array.isArray(e),w=l.s.r,y=0,g={};v&&!e[w]&&(e[w]=[]);var E=c.skipHidden&&e["!cols"]||[],P=c.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(E[y]||{}).hidden)switch(d[y]=Tt(y),r=v?e[w][y]:e[d[y]+f],n){case 1:s[y]=y-l.s.c;break;case 2:s[y]=d[y];break;case 3:s[y]=c.header[y-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=bn(r,null,c),m=g[i]||0,!m)g[i]=1;else{do o=i+"_"+m++;while(g[o]);g[i]=m,g[o]=1}s[y]=o}for(w=l.s.r+a;w<=l.e.r;++w)if(!(P[w]||{}).hidden){var T=tF(e,l,w,d,n,s,v,c);(T.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[x++]=T.row)}return p.length=x,p}var qp=/"/g;function rF(e,t,r,n,a,s,i,o){for(var l=!0,c=[],u="",f=Lt(r),d=t.s.c;d<=t.e.c;++d)if(n[d]){var p=o.dense?(e[r]||[])[d]:e[n[d]+f];if(p==null)u="";else if(p.v!=null){l=!1,u=""+(o.rawNumbers&&p.t=="n"?p.v:bn(p,null,o));for(var x=0,m=0;x!==u.length;++x)if((m=u.charCodeAt(x))===a||m===s||m===34||o.forceQuotes){u='"'+u.replace(qp,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(l=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace(qp,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(i)}function vv(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=ft(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",f=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],x=a.s.c;x<=a.e.c;++x)(d[x]||{}).hidden||(f[x]=Tt(x));for(var m=0,v=a.s.r;v<=a.e.r;++v)(p[v]||{}).hidden||(u=rF(e,a,v,f,i,l,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((m++?o:"")+u)));return delete n.dense,r.join("")}function nF(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=vv(e,t);return r}function aF(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=ft(e["!ref"]),s="",i=[],o,l=[],c=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)i[o]=Tt(o);for(var u=a.s.r;u<=a.e.r;++u)for(s=Lt(u),o=a.s.c;o<=a.e.c;++o)if(t=i[o]+s,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function wv(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},i=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?ar(n.origin):n.origin;i=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:i+t.length-1+a}};if(s["!ref"]){var f=ft(s["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),i==-1&&(i=f.e.r+1,u.e.r=i+t.length-1+a)}else i==-1&&(i=0,u.e.r=t.length-1+a);var d=n.header||[],p=0;t.forEach(function(m,v){ln(m).forEach(function(w){(p=d.indexOf(w))==-1&&(d[p=d.length]=w);var y=m[w],g="z",E="",P=Ae({c:o+p,r:i+v+a});c=so(s,P),y&&typeof y=="object"&&!(y instanceof Date)?s[P]=y:(typeof y=="number"?g="n":typeof y=="boolean"?g="b":typeof y=="string"?g="s":y instanceof Date?(g="d",n.cellDates||(g="n",y=or(y)),E=n.dateNF||Oe[14]):y===null&&n.nullError&&(g="e",y=0),c?(c.t=g,c.v=y,delete c.w,delete c.R,E&&(c.z=E)):s[P]=c={t:g,v:y},E&&(c.z=E))})}),u.e.c=Math.max(u.e.c,o+d.length-1);var x=Lt(i);if(a)for(p=0;p<d.length;++p)s[Tt(p+o)+x]={t:"s",v:d[p]};return s["!ref"]=Ue(u),s}function sF(e,t){return wv(null,e,t)}function so(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=ar(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?so(e,Ae(t)):so(e,Ae({r:t,c:r||0}))}function iF(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function md(){return{SheetNames:[],Sheets:{}}}function gd(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=i+a)!=-1;++a);}if(VN(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function oF(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=iF(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function lF(e,t){return e.z=t,e}function yv(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function cF(e,t,r){return yv(e,"#"+t,r)}function uF(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function fF(e,t,r,n){for(var a=typeof t!="string"?t:ft(t),s=typeof t=="string"?t:Ue(t),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var l=so(e,i,o);l.t="n",l.F=s,delete l.v,i==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var dF={encode_col:Tt,encode_row:Lt,encode_cell:Ae,encode_range:Ue,decode_col:rd,decode_row:td,split_cell:ES,decode_cell:ar,decode_range:Us,format_cell:bn,sheet_add_aoa:Sg,sheet_add_json:wv,sheet_add_dom:pv,aoa_to_sheet:$s,json_to_sheet:sF,table_to_sheet:xv,table_to_book:Nb,sheet_to_csv:vv,sheet_to_txt:nF,sheet_to_json:z0,sheet_to_html:Cb,sheet_to_formulae:aF,sheet_to_row_object_array:z0,sheet_get_cell:so,book_new:md,book_append_sheet:gd,book_set_sheet_visibility:oF,cell_set_number_format:lF,cell_set_hyperlink:yv,cell_set_internal_link:cF,cell_add_comment:uF,sheet_set_array_formula:fF,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const In={rulesets:"dbulk.rulesets.v2",tasks:"dbulk.tasks.v1",apiKey:"dbulk.openai_api_key",model:"dbulk.openai_model"};function ra(e="id"){return`${e}_${Math.random().toString(36).slice(2,10)}`}const hF=[{id:ra("rule"),name:"Credit: Standard THB",appliesTo:"customers",enabled:!0,requiredColumns:["RecipientName","AccountNumber","BankCode","Amount","Currency","Note"],accountPattern:"^\\d{10,12}$",allowedCurrencies:["THB"],maxAmountPerTxn:2e6,maxTotalAmount:1e7,allowDuplicateAccountPerBatch:!1,businessHoursOnly:!1},{id:ra("rule"),name:"Debit: Standard THB",appliesTo:"products",enabled:!0,requiredColumns:["RecipientName","AccountNumber","BankCode","Amount","Currency","Note"],accountPattern:"^\\d{10,12}$",allowedCurrencies:["THB"],maxAmountPerTxn:2e6,maxTotalAmount:1e7,allowDuplicateAccountPerBatch:!1,businessHoursOnly:!1}],_v=["gpt-4o-mini","gpt-4o","gpt-4.1-mini","gpt-4.1"];async function pF(e){const t=await e.arrayBuffer(),r=$0(t,{type:"array"}),n=r.Sheets[r.SheetNames[0]];return dF.sheet_to_json(n,{defval:""}).map(s=>{const i={};for(const l of Object.keys(s)){const c=String(l).trim();i[c]=typeof s[l]=="string"?s[l].trim():s[l]}const o=Number(i.Amount)||0;return{RecipientName:String(i.RecipientName||""),AccountNumber:String(i.AccountNumber||""),BankCode:String(i.BankCode||""),Amount:o,Currency:String(i.Currency||""),Note:String(i.Note||"")}})}function xF(e,t){const r=[],n=new RegExp(t.accountPattern);if(!e||e.length===0)return r.push({rowIndex:0,level:"error",message:"No rows found"}),r;const a=Object.keys(e[0]||{}),s=t.requiredColumns.filter(l=>!a.includes(l));s.length&&r.push({rowIndex:0,level:"error",message:`Missing required columns: ${s.join(", ")}`});const i=new Map;let o=0;if(e.forEach((l,c)=>{l.RecipientName||r.push({rowIndex:c+1,level:"error",message:"RecipientName is required"}),n.test(l.AccountNumber)||r.push({rowIndex:c+1,level:"error",message:"AccountNumber invalid format"}),l.BankCode||r.push({rowIndex:c+1,level:"error",message:"BankCode is required"}),typeof l.Amount!="number"||isNaN(l.Amount)?r.push({rowIndex:c+1,level:"error",message:"Amount must be a number"}):(l.Amount<=0&&r.push({rowIndex:c+1,level:"error",message:"Amount must be > 0"}),l.Amount>t.maxAmountPerTxn&&r.push({rowIndex:c+1,level:"error",message:`Amount exceeds per-transaction max (${t.maxAmountPerTxn.toLocaleString()})`}),o+=l.Amount),t.allowedCurrencies.includes(l.Currency)||r.push({rowIndex:c+1,level:"error",message:`Currency not allowed (${l.Currency})`});const u=`${l.AccountNumber}|${l.Amount}`;t.allowDuplicateAccountPerBatch||(i.has(u)?r.push({rowIndex:c+1,level:"warning",message:"Possible duplicate (AccountNumber + Amount)"}):i.set(u,!0))}),o>t.maxTotalAmount&&r.push({rowIndex:0,level:"error",message:`Batch total exceeds limit (${t.maxTotalAmount.toLocaleString()})`}),t.businessHoursOnly){const l=new Date,c=l.getDay(),u=l.getHours();c>=1&&c<=5&&u>=9&&u<17||r.push({rowIndex:0,level:"warning",message:"Business hours rule active (Mon–Fri 09:00–17:00)"})}return r}function mF(e,t,r){const n=t.filter(l=>l.enabled&&l.appliesTo===r),a=e.reduce((l,c)=>l+(Number(c.Amount)||0),0),s=e.length,i=n.map(l=>{const c=xF(e,l).map(u=>({...u,ruleName:l.name}));return{ruleId:l.id,ruleName:l.name,issues:c,totalAmount:a,rowCount:s}});return{combined:i.flatMap(l=>l.issues),perRule:i,totalAmount:a,rowCount:s}}async function gF(e,t,r,n,a){var u,f,d;const s=`You are dP Copilot, a careful data platform assistant.
- Explain validations and suggest fixes succinctly.
- Never fabricate banking details.
- If asked to "submit", remind that this MVP only simulates submission.`,i=JSON.stringify(n).slice(0,12e3),o={model:t||"gpt-4o-mini",messages:[{role:"system",content:s},{role:"user",content:`Context (truncated JSON):
${i}

Question: ${r}`}],temperature:.2},l=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json",...a?{Authorization:`Bearer ${a}`}:{}},body:JSON.stringify(o)});if(!l.ok){const p=await l.text();throw new Error(`OpenAI error: ${l.status} ${p}`)}return((d=(f=(u=(await l.json()).choices)==null?void 0:u[0])==null?void 0:f.message)==null?void 0:d.content)||"(no response)"}function cl({icon:e,label:t,active:r,onClick:n,right:a}){return h.jsxs("button",{onClick:n,className:`flex items-center gap-2 px-3 py-2 rounded-xl w-full text-left transition ${r?"bg-emerald-200 text-emerald-800":"text-neutral-700 hover:bg-emerald-50"}`,children:[h.jsx(e,{size:18}),h.jsx("span",{className:"truncate flex-1 text-left",children:t}),a]})}function Jp({children:e,tone:t="neutral"}){const r=t==="success"?"bg-emerald-500/15 text-emerald-400 border-emerald-500/30":t==="danger"?"bg-rose-500/15 text-rose-400 border-rose-500/30":t==="warn"?"bg-amber-500/15 text-amber-400 border-amber-500/30":"bg-neutral-200 text-neutral-700 border-neutral-400";return h.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-md text-xs border ${r}`,children:e})}function vd({checked:e,onChange:t}){return h.jsxs("button",{onClick:()=>t(!e),className:`inline-flex items-center gap-1 px-2 py-1 rounded-md border ${e?"border-emerald-500/40 bg-emerald-500/10 text-emerald-300":"border-neutral-400 bg-neutral-200 text-neutral-700"}`,children:[e?h.jsx(rE,{size:16}):h.jsx(eE,{size:16}),h.jsx("span",{className:"text-xs",children:e?"On":"Off"})]})}function vF({domain:e,onClose:t,onSaved:r,accessToken:n}){const[a,s]=J.useState(e.name||""),[i,o]=J.useState(e.description||""),[l,c]=J.useState((e.business_key||[]).join(", ")),[u,f]=J.useState(!1),d=async()=>{try{f(!0);const p={"Content-Type":"application/json",...n?{Authorization:`Bearer ${n}`}:{}},x={name:a.trim(),description:i||null,business_key:l.split(",").map(w=>w.trim()).filter(Boolean)},m=await fetch(`/api/domains/${e.id}`,{method:"PUT",headers:p,body:JSON.stringify(x)});if(!m.ok)throw new Error((await m.json()).error||"Save failed");const v=await m.json();r==null||r(v)}catch(p){alert(p.message||"Save failed")}finally{f(!1)}};return h.jsx("div",{className:"fixed inset-0 bg-black/30 z-50 grid place-items-center",onClick:t,children:h.jsxs("div",{className:"bg-white rounded-lg border w-[520px] p-4",onClick:p=>p.stopPropagation(),children:[h.jsx("div",{className:"text-lg font-medium mb-3",children:"Edit Domain"}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("label",{className:"block text-sm",children:[h.jsx("div",{className:"text-neutral-600 mb-1",children:"Name"}),h.jsx("input",{value:a,onChange:p=>s(p.target.value),className:"w-full border rounded px-2 py-1"})]}),h.jsxs("label",{className:"block text-sm",children:[h.jsx("div",{className:"text-neutral-600 mb-1",children:"Description"}),h.jsx("textarea",{value:i,onChange:p=>o(p.target.value),className:"w-full border rounded px-2 py-1",rows:3})]}),h.jsxs("label",{className:"block text-sm",children:[h.jsx("div",{className:"text-neutral-600 mb-1",children:"Business Key (comma-separated)"}),h.jsx("input",{value:l,onChange:p=>c(p.target.value),className:"w-full border rounded px-2 py-1",placeholder:"email, id"})]})]}),h.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[h.jsx("button",{onClick:t,className:"px-3 py-1 rounded border",children:"Cancel"}),h.jsx("button",{onClick:d,disabled:u,className:"px-3 py-1 rounded bg-neutral-900 text-white disabled:opacity-50",children:u?"Saving…":"Save"})]})]})})}function wF({msg:e,rulesets:t,setRulesets:r,kind:n,domain:a}){const s=e.role==="user",i=s?"bg-neutral-200 text-neutral-900":e.type==="validation"?"bg-neutral-100 text-neutral-800 border border-neutral-300":"bg-neutral-100 text-neutral-800";return h.jsx("div",{className:`w-full flex ${s?"justify-end":"justify-start"}`,children:h.jsxs("div",{className:`max-w-[86%] rounded-2xl px-4 py-3 ${i}`,children:[e.type==="file"&&h.jsxs("div",{className:"flex items-center gap-2 mb-2 text-neutral-700",children:[h.jsx(Nk,{size:16})," ",h.jsx("span",{className:"text-sm",children:e.content})]}),e.type==="thinking"&&h.jsxs("div",{className:"flex items-center gap-2 text-neutral-600",children:[h.jsx(Hf,{className:"w-4 h-4 animate-spin"}),h.jsx("span",{className:"text-sm",children:"Thinking…"})]}),e.type==="validation"&&e.payload&&h.jsx(yF,{payload:e.payload,rulesets:t,setRulesets:r,domain:a}),(e.type==="text"||e.type==="summary")&&h.jsx("div",{className:"whitespace-pre-wrap leading-relaxed text-sm",children:e.content})]})})}function yF({payload:e,rulesets:t=[],setRulesets:r,domain:n}){const{combined:a=[],perRule:s=[],totalAmount:i=0,rowCount:o=0}=e||{},l=a.filter(d=>d.level==="error"),c=a.filter(d=>d.level==="warning"),u=t.filter(d=>d.appliesTo===n),f=(d,p)=>r(x=>x.map(m=>m.id===d?{...m,enabled:p}:m));return h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.length===0?h.jsx(Ek,{className:"text-emerald-400",size:18}):h.jsx(Ak,{className:"text-rose-400",size:18}),h.jsxs("div",{className:"text-sm",children:[l.length===0?"Ready to submit":`${l.length} error(s) found`," · ",c.length," warning(s) · ",o," rows · Total ",i.toLocaleString()]})]}),u.map(d=>{const p=s.find(v=>v.ruleId===d.id),x=p?p.issues.filter(v=>v.level==="error").length:0,m=p?p.issues.filter(v=>v.level==="warning").length:0;return h.jsxs("div",{className:"rounded-lg border border-neutral-300 p-3 bg-neutral-50",children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsx("div",{className:"text-sm font-medium",children:d.name}),h.jsx(vd,{checked:d.enabled,onChange:v=>f(d.id,v)})]}),d.enabled?p&&p.issues.length>0?h.jsxs("ul",{className:"space-y-1 max-h-36 overflow-auto pr-1",children:[p.issues.slice(0,20).map((v,w)=>h.jsxs("li",{className:"text-xs text-neutral-700",children:[h.jsxs("span",{className:"text-neutral-500 mr-1",children:["Row ",v.rowIndex,":"]}),h.jsx("span",{className:v.level==="error"?"text-rose-300":"text-amber-300",children:v.message})]},w)),p.issues.length>20&&h.jsxs("li",{className:"text-xs text-neutral-600",children:["…and ",p.issues.length-20," more"]})]}):h.jsx("div",{className:"text-xs text-neutral-500",children:"No issues for this rule."}):h.jsx("div",{className:"text-xs text-neutral-500",children:"Rule disabled"}),h.jsxs("div",{className:"text-xs text-neutral-500 mt-2",children:[x," error(s), ",m," warning(s)"]})]},d.id)})]})}function _F(){var j,Z,V,q,Q,te,Ee,F,Re,Te;const[e,t]=J.useState(()=>{const re=localStorage.getItem(In.rulesets);if(re)return JSON.parse(re);try{const xe=localStorage.getItem("dbulk.rules.v1");if(xe){const ne=JSON.parse(xe);return[{id:ra("rule"),name:"Migrated Credit",appliesTo:"customers",enabled:!0,...ne},{id:ra("rule"),name:"Migrated Debit",appliesTo:"products",enabled:!0,...ne}]}}catch{}return hF}),[r,n]=J.useState(()=>{const re=localStorage.getItem(In.tasks);return re?JSON.parse(re):[]}),[a,s]=J.useState(!0),[i,o]=J.useState(()=>localStorage.getItem(In.apiKey)||""),[l,c]=J.useState(()=>localStorage.getItem(In.model)||_v[0]),[u,f]=J.useState([]),[d,p]=J.useState([]),[x,m]=J.useState(null),[v,w]=J.useState("Dashboard:Domain"),[y,g]=J.useState([]),[E,P]=J.useState(null),{user:T}=Rc(),k=((j=T==null?void 0:T.user_metadata)==null?void 0:j.tenant_id)??((Z=T==null?void 0:T.app_metadata)==null?void 0:Z.tenant_id),[I,R]=J.useState(null),[U,z]=J.useState(!1),[B,ae]=J.useState(!1),ge=J.useRef(null),ue=J.useRef(null),[pe,de]=J.useState(!1);J.useEffect(()=>{const re=xe=>{ge.current&&!ge.current.contains(xe.target)&&(z(!1),ae(!1))};return document.addEventListener("mousedown",re),()=>document.removeEventListener("mousedown",re)},[]);async function ie(re){var xe,ne;if(!(!re||!(T!=null&&T.id)))try{de(!0);const Ne="avatars";try{const be=E||((ne=(xe=(await Pe.auth.getSession()).data)==null?void 0:xe.session)==null?void 0:ne.access_token);await fetch("/api/storage/ensure-bucket",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${be}`},body:JSON.stringify({name:Ne,public:!0})})}catch{}const Me=`${T.id}/${Date.now()}_${re.name}`,{error:Ge}=await Pe.storage.from(Ne).upload(Me,re,{upsert:!0,cacheControl:"3600"});if(Ge)throw Ge;const{data:Qe}=Pe.storage.from(Ne).getPublicUrl(Me),Ct=Qe==null?void 0:Qe.publicUrl;if(!Ct)throw new Error("Failed to get public URL");await Pe.auth.updateUser({data:{avatar_url:Ct}}),await Pe.from("users").update({profile_url:Ct}).eq("id",T.id),se("Profile photo updated")}catch(Ne){console.error("avatar upload error",Ne),se(Ne.message||"Upload failed")}finally{de(!1)}}J.useEffect(()=>{Pe.auth.getSession().then(({data:{session:xe}})=>{P((xe==null?void 0:xe.access_token)??null)});const{data:{subscription:re}}=Pe.auth.onAuthStateChange((xe,ne)=>{P((ne==null?void 0:ne.access_token)??null)});return()=>re.unsubscribe()},[]),J.useEffect(()=>{async function re(){try{if(!E)return;const xe=await fetch("/api/domains",{headers:{Authorization:`Bearer ${E}`}});if(!xe.ok)return;const ne=await xe.json();p(ne||[]),(!v||v==="Dashboard")&&ne&&ne.length&&w(ne[0].name)}catch{}}re()},[E]);const M=async()=>{if(!E)return;const re=await fetch("/api/domains",{headers:{Authorization:`Bearer ${E}`}});re.ok&&p(await re.json())};J.useEffect(()=>{if(!k){R(null);return}Pe.from("tenants").select("name").eq("id",k).single().then(({data:re,error:xe})=>{xe||R((re==null?void 0:re.name)||null)})},[k]);const se=re=>{const xe=ra("toast");g(ne=>[...ne,{id:xe,msg:re}]),setTimeout(()=>g(ne=>ne.filter(Ne=>Ne.id!==xe)),3e3)},me=async()=>{await xo(),P(null)},b=async()=>{var Ge,Qe;const re=prompt("New domain name");if(!re)return;const xe=E||((Qe=(Ge=(await Pe.auth.getSession()).data)==null?void 0:Ge.session)==null?void 0:Qe.access_token),ne={"Content-Type":"application/json",...xe?{Authorization:`Bearer ${xe}`}:{}},Ne=re.toLowerCase().includes("customer")?["email"]:["id"];if(!(await fetch("/api/domains",{method:"POST",headers:ne,body:JSON.stringify({name:re,business_key:Ne})})).ok){se("Create domain failed");return}await M(),w(re),se("Domain created")},H=(re,xe)=>t(ne=>ne.map(Ne=>Ne.id===re?{...Ne,...xe}:Ne)),L=re=>{t(xe=>xe.filter(ne=>ne.id!==re)),v===re&&w("customers")};return J.useEffect(()=>{localStorage.setItem(In.rulesets,JSON.stringify(e))},[e]),J.useEffect(()=>{localStorage.setItem(In.tasks,JSON.stringify(r))},[r]),J.useEffect(()=>{localStorage.setItem(In.apiKey,i||"")},[i]),J.useEffect(()=>{localStorage.setItem(In.model,l||"")},[l]),h.jsxs("div",{className:"h-full w-full min-h-screen bg-white text-neutral-900",children:[h.jsxs("div",{className:"h-12 border-b border-neutral-200 flex items-center justify-between px-4 sticky top-0 bg-white/80 backdrop-blur z-40",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"size-6 rounded-lg bg-emerald-200 grid place-items-center",children:h.jsx(Um,{size:14,className:"text-emerald-700"})}),h.jsx("div",{className:"font-semibold",children:"dP"}),k&&h.jsx("button",{className:"px-3 py-0.5 rounded-full border border-neutral-300 text-xs text-neutral-700",children:I||k})]}),h.jsx("div",{className:"flex items-center gap-4 text-xs text-neutral-500",children:E?h.jsxs("div",{className:"relative",ref:ge,children:[h.jsx("button",{onClick:()=>{z(re=>!re),ae(!1)},className:"w-8 h-8 rounded-full bg-neutral-300 overflow-hidden flex items-center justify-center",children:(V=T==null?void 0:T.user_metadata)!=null&&V.avatar_url?h.jsx("img",{src:T.user_metadata.avatar_url,alt:"profile",className:"w-full h-full object-cover"}):h.jsx("span",{className:"text-sm font-medium text-neutral-600",children:(Q=(q=T==null?void 0:T.email)==null?void 0:q[0])==null?void 0:Q.toUpperCase()})}),U&&h.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-md shadow-lg border border-neutral-200 text-neutral-700 z-50",children:[h.jsxs("div",{className:"p-4 border-b border-neutral-200 flex items-center gap-3",children:[h.jsx("div",{className:"w-10 h-10 rounded-full bg-neutral-300 overflow-hidden flex items-center justify-center",children:(te=T==null?void 0:T.user_metadata)!=null&&te.avatar_url?h.jsx("img",{src:T.user_metadata.avatar_url,alt:"profile",className:"w-full h-full object-cover"}):h.jsx("span",{className:"text-sm font-medium text-neutral-600",children:(F=(Ee=T==null?void 0:T.email)==null?void 0:Ee[0])==null?void 0:F.toUpperCase()})}),h.jsxs("div",{children:[h.jsx("div",{className:"text-sm font-medium",children:((Re=T==null?void 0:T.user_metadata)==null?void 0:Re.full_name)??(T==null?void 0:T.email)}),h.jsx("div",{className:"text-xs text-neutral-500",children:T==null?void 0:T.email})]})]}),h.jsxs("div",{className:"py-1 border-b border-neutral-200",children:[h.jsx("input",{ref:ue,type:"file",accept:"image/*",className:"hidden",onChange:re=>{var ne;const xe=(ne=re.target.files)==null?void 0:ne[0];xe&&ie(xe),re.target.value=""}}),h.jsxs("button",{onClick:()=>{var re;return(re=ue.current)==null?void 0:re.click()},disabled:pe,className:"w-full text-left px-4 py-2 text-sm hover:bg-neutral-100 flex items-center gap-2 disabled:opacity-50",children:[h.jsx(Vf,{size:14}),pe?"Uploading...":"Upload Photo"]}),h.jsx("button",{className:"w-full text-left px-4 py-2 text-sm hover:bg-neutral-100",children:"Account Preference"}),h.jsx("button",{onClick:()=>ae(re=>!re),className:"w-full text-left px-4 py-2 text-sm hover:bg-neutral-100",children:"Feature Preview"}),B&&h.jsx("div",{className:"border-t border-neutral-200",children:h.jsx(CF,{apiKey:i,setApiKey:o,model:l,setModel:c})})]}),h.jsx("div",{className:"py-1",children:h.jsx("button",{onClick:me,className:"w-full text-left px-4 py-2 text-sm hover:bg-neutral-100 text-red-600",children:"Logout"})})]})]}):h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("a",{href:"/login",className:"underline",children:"Login"}),h.jsx("a",{href:"/signup",className:"underline",children:"Sign up"})]})})]}),h.jsxs("div",{className:"flex",children:[h.jsxs("aside",{className:"w-[280px] border-r border-neutral-200 min-h-[calc(100vh-3rem)] p-3 hidden md:block",children:[h.jsxs("div",{className:"flex items-center justify-between text-xs uppercase tracking-wide text-neutral-500 px-2 mt-4 mb-2",children:[h.jsx("span",{children:"Data Domains"}),h.jsx("button",{onClick:b,className:"text-emerald-700",title:"Create",children:h.jsx(Jl,{size:12})})]}),h.jsxs("div",{className:"space-y-1",children:[d.map(re=>h.jsx(cl,{icon:kl,label:re.name,active:v===re.name,onClick:()=>w(re.name),right:h.jsx("button",{onClick:xe=>{xe.stopPropagation(),m({...re})},title:"Edit domain",className:"p-1 rounded hover:bg-neutral-100",children:"⋮"})},re.id)),d.length===0&&h.jsx("div",{className:"px-2 text-xs text-neutral-400",children:"No data domains"})]}),h.jsx("div",{className:"flex items-center justify-between text-xs uppercase tracking-wide text-neutral-500 px-2 mt-4 mb-2",children:h.jsx("span",{children:"Validate Rules"})}),h.jsxs("div",{className:"space-y-1",children:[e.map(re=>h.jsx(cl,{icon:Bm,label:re.name,active:v===re.id,onClick:()=>w(re.id)},re.id)),e.length===0&&h.jsx("div",{className:"px-2 text-xs text-neutral-400",children:"No rules"})]}),h.jsx("div",{className:"flex items-center justify-between text-xs uppercase tracking-wide text-neutral-500 px-2 mt-4 mb-2",children:h.jsx("span",{children:"Dashboard"})}),h.jsxs("div",{className:"space-y-1",children:[h.jsx(cl,{icon:ql,label:"Domain View",active:v==="Dashboard:Domain",onClick:()=>w("Dashboard:Domain")}),h.jsx(cl,{icon:ql,label:"Overall Data",active:v==="Dashboard:Overall",onClick:()=>w("Dashboard:Overall")})]})]}),h.jsx("main",{className:"flex-1 min-h-[calc(100vh-3rem)]",children:e.find(re=>re.id===v)?h.jsx(AF,{rule:e.find(re=>re.id===v),updateRule:H,deleteRule:L,domains:u}):u.find(re=>re.id===v)?h.jsx(Qp,{domain:v,kind:v==="customers"?"credit":"debit",rulesets:e,setRulesets:t,tasks:r,setTasks:n,apiKey:i,model:l,addToast:se}):v==="Dashboard:Domain"?h.jsx(kF,{domains:d,accessToken:E}):v==="Dashboard:Overall"?h.jsx(EF,{accessToken:E}):d.find(re=>re.name===v)?h.jsx(Qp,{domain:v,domainId:(Te=d.find(re=>re.name===v))==null?void 0:Te.id,kind:"credit",rulesets:e,setRulesets:t,tasks:r,setTasks:n,apiKey:i,model:l,addToast:re=>{se(re),M()}}):h.jsxs("div",{className:"p-6",children:['Domain "',v,'" not implemented yet.']})}),x&&h.jsx(vF,{domain:x,onClose:()=>m(null),onSaved:async re=>{m(null),await M(),v===x.name&&(re!=null&&re.name)&&re.name!==v&&w(re.name)},accessToken:E})]}),h.jsx("div",{className:"fixed bottom-4 right-4 space-y-2 z-50",children:y.map(re=>h.jsx("div",{className:"bg-emerald-100 text-emerald-800 px-4 py-2 rounded shadow",children:re.msg},re.id))})]})}function kF({domains:e,accessToken:t}){var u;const[r,n]=J.useState(((u=e==null?void 0:e[0])==null?void 0:u.id)||null),[a,s]=J.useState([]);J.useEffect(()=>{var f;n(((f=e==null?void 0:e[0])==null?void 0:f.id)||null)},[e]),J.useEffect(()=>{(async()=>{try{if(!r||!t)return s([]);const f=await fetch(`/api/domains/${r}/preview?limit=200`,{headers:{Authorization:`Bearer ${t}`}});s(f.ok?await f.json():[])}catch{s([])}})()},[r,t]);const i=a.length?Object.keys(a[0]):[],o=a.length,l=i.length,c=i.map(f=>a.filter(d=>d[f]==null||d[f]==="").length);return h.jsxs("div",{className:"p-4 space-y-4",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("select",{className:"border rounded px-2 py-1",value:r||"",onChange:f=>n(f.target.value),children:e.map(f=>h.jsx("option",{value:f.id,children:f.name},f.id))}),h.jsx("div",{className:"text-sm text-neutral-600",children:"Quick glance at current data"})]}),h.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[h.jsxs("div",{className:"border rounded p-3",children:[h.jsx("div",{className:"text-xs text-neutral-500",children:"Rows (sample)"}),h.jsx("div",{className:"text-2xl font-semibold",children:o})]}),h.jsxs("div",{className:"border rounded p-3",children:[h.jsx("div",{className:"text-xs text-neutral-500",children:"Columns"}),h.jsx("div",{className:"text-2xl font-semibold",children:l})]}),h.jsxs("div",{className:"border rounded p-3",children:[h.jsx("div",{className:"text-xs text-neutral-500",children:"Missing cells (sample)"}),h.jsx("div",{className:"text-2xl font-semibold",children:c.reduce((f,d)=>f+d,0)})]})]}),i.length>0&&h.jsxs("div",{className:"border rounded p-3",children:[h.jsx("div",{className:"text-sm font-medium mb-2",children:"Missing by column"}),h.jsx("div",{className:"space-y-1",children:i.map((f,d)=>{const p=c[d],x=o?Math.round(p/o*100):0;return h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"w-32 text-xs text-neutral-600 truncate",children:f}),h.jsx("div",{className:"flex-1 h-2 bg-neutral-200 rounded",children:h.jsx("div",{className:"h-2 bg-amber-500 rounded",style:{width:`${x}%`}})}),h.jsxs("div",{className:"w-10 text-xs text-neutral-600 text-right",children:[x,"%"]})]},f)})})]})]})}function EF({accessToken:e}){const[t,r]=J.useState([]),[n,a]=J.useState([]),[s,i]=J.useState(null);J.useEffect(()=>{(async()=>{var p;if(!e)return;const f=await fetch("/api/domains",{headers:{Authorization:`Bearer ${e}`}}),d=f.ok?await f.json():[];r(d||[]),i(((p=d==null?void 0:d[0])==null?void 0:p.id)||null)})()},[e]),J.useEffect(()=>{(async()=>{if(!s||!e){a([]);return}const f=await fetch(`/api/domains/${s}/preview?limit=200`,{headers:{Authorization:`Bearer ${e}`}});a(f.ok?await f.json():[])})()},[s,e]);const l=(n.length?Object.keys(n[0]):[])[0],c={};n.forEach(f=>{const d=String(f[l]??"");c[d]=(c[d]||0)+1});const u=Object.entries(c).sort((f,d)=>d[1]-f[1]).slice(0,10);return h.jsxs("div",{className:"p-4 space-y-4",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("select",{className:"border rounded px-2 py-1",value:s||"",onChange:f=>i(f.target.value),children:t.map(f=>h.jsx("option",{value:f.id,children:f.name},f.id))}),h.jsx("div",{className:"text-sm text-neutral-600",children:"Overall Data — simple visuals"})]}),h.jsxs("div",{className:"border rounded p-3",children:[h.jsxs("div",{className:"text-sm font-medium mb-2",children:["Top values in ",l||"—"]}),h.jsxs("div",{className:"space-y-1",children:[u.map(([f,d])=>h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"w-48 text-xs text-neutral-600 truncate",title:f,children:f}),h.jsx("div",{className:"flex-1 h-2 bg-neutral-200 rounded",children:h.jsx("div",{className:"h-2 bg-emerald-500 rounded",style:{width:`${Math.min(100,d/Math.max(1,u[0][1])*100)}%`}})}),h.jsx("div",{className:"w-10 text-xs text-neutral-600 text-right",children:d})]},f)),u.length===0&&h.jsx("div",{className:"text-xs text-neutral-500",children:"No data"})]})]})]})}function SF({domainId:e,onClose:t}){const[r,n]=J.useState([]),[a,s]=J.useState(!0);J.useEffect(()=>{(async()=>{var o,l;try{const c=(l=(o=(await Pe.auth.getSession()).data)==null?void 0:o.session)==null?void 0:l.access_token,u=await fetch(`/api/domains/${e}/rules`,{headers:{Authorization:`Bearer ${c}`}}),f=u.ok?await u.json():[];n(f||[])}finally{s(!1)}})()},[e]);const i=async(o,l)=>{var f,d;const c=(d=(f=(await Pe.auth.getSession()).data)==null?void 0:f.session)==null?void 0:d.access_token;(await fetch(`/api/domains/${e}/rules/${o}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify(l)})).ok&&n(p=>p.map(x=>x.id===o?{...x,...l}:x))};return h.jsx("div",{className:"fixed inset-0 bg-black/30 z-50 flex items-center justify-end",onClick:t,children:h.jsxs("div",{className:"bg-white h-full w-[420px] border-l",onClick:o=>o.stopPropagation(),children:[h.jsxs("div",{className:"px-4 py-3 border-b flex items-center justify-between",children:[h.jsx("div",{className:"font-medium",children:"Rules"}),h.jsx("button",{onClick:t,children:"✕"})]}),a?h.jsx("div",{className:"p-4 text-neutral-500",children:"Loading…"}):h.jsxs("div",{className:"p-3 space-y-2",children:[r.map(o=>h.jsxs("div",{className:"rounded-lg border border-neutral-300 p-3 bg-neutral-50",children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsx("input",{className:"text-sm font-medium bg-transparent border-b border-transparent focus:border-neutral-300 outline-none",defaultValue:o.name,onBlur:l=>{l.target.value!==o.name&&i(o.id,{name:l.target.value})}}),h.jsx(vd,{checked:o.status!=="disabled",onChange:l=>i(o.id,{status:l?"enabled":"disabled"})})]}),h.jsx("div",{className:"text-xs text-neutral-600",children:o.definition?JSON.stringify(o.definition):"No definition"})]},o.id)),r.length===0&&h.jsx("div",{className:"text-sm text-neutral-500",children:"No rules"})]})]})})}function TF({domainId:e,onClose:t}){const[r,n]=J.useState([]),[a,s]=J.useState([]),[i,o]=J.useState(!0);J.useEffect(()=>{(async()=>{var f,d;try{const p=(d=(f=(await Pe.auth.getSession()).data)==null?void 0:f.session)==null?void 0:d.access_token,x=await fetch(`/api/domains/${e}/versions`,{headers:{Authorization:`Bearer ${p}`}}),m=x.ok?await x.json():[];n(m||[])}finally{o(!1)}})()},[e]);const l=async()=>{var p,x;const f=(x=(p=(await Pe.auth.getSession()).data)==null?void 0:p.session)==null?void 0:x.access_token,d=await fetch(`/api/domains/${e}/clean`,{method:"POST",headers:{Authorization:`Bearer ${f}`}});if(d.ok){const m=await d.json();alert(`Clean completed. Changed ${m.changed} rows.`);const v=await fetch(`/api/domains/${e}/versions`,{headers:{Authorization:`Bearer ${f}`}});v.ok&&n(await v.json())}},c=async()=>{var p,x;const f=(x=(p=(await Pe.auth.getSession()).data)==null?void 0:p.session)==null?void 0:x.access_token,d=await fetch(`/api/domains/${e}/preview?limit=50`,{headers:{Authorization:`Bearer ${f}`}});d.ok&&s(await d.json())},u=a&&a.length?Object.keys(a[0]):[];return h.jsx("div",{className:"fixed inset-0 bg-black/30 z-50 flex items-center justify-end",onClick:t,children:h.jsxs("div",{className:"bg-white h-full w-[900px] border-l",onClick:f=>f.stopPropagation(),children:[h.jsxs("div",{className:"px-4 py-3 border-b flex items-center justify-between",children:[h.jsx("div",{className:"font-medium",children:"Versions"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{className:"px-3 py-1 rounded border",onClick:c,children:"Preview"}),h.jsx("button",{className:"px-3 py-1 rounded bg-neutral-900 text-white",onClick:l,children:"Clean"}),h.jsx("button",{onClick:t,className:"ml-2",children:"✕"})]})]}),i?h.jsx("div",{className:"p-4 text-neutral-500",children:"Loading…"}):h.jsxs("div",{className:"p-3 space-y-2",children:[r.map(f=>h.jsxs("div",{className:"rounded-lg border border-neutral-300 p-3 bg-neutral-50",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("div",{className:"text-sm",children:new Date(f.created_at).toLocaleString()}),h.jsxs("div",{className:"text-xs text-neutral-600",children:[f.rows_count??0," rows"]})]}),f.import_summary&&h.jsx("div",{className:"text-xs text-neutral-500 mt-1",children:JSON.stringify(f.import_summary)})]},f.id)),r.length===0&&h.jsx("div",{className:"text-sm text-neutral-500",children:"No versions"}),a.length>0&&h.jsxs("div",{className:"mt-2",children:[h.jsxs("div",{className:"text-sm font-medium mb-1",children:["Preview (first ",a.length," rows)"]}),h.jsx("div",{className:"border rounded overflow-auto max-h-[50vh]",children:h.jsxs("table",{className:"min-w-full text-xs",children:[h.jsx("thead",{className:"bg-neutral-100 sticky top-0",children:h.jsx("tr",{children:u.map(f=>h.jsx("th",{className:"text-left px-2 py-1 border-b border-neutral-200",children:f},f))})}),h.jsx("tbody",{children:a.map((f,d)=>h.jsx("tr",{className:"border-b border-neutral-100",children:u.map(p=>h.jsx("td",{className:"px-2 py-1 whitespace-nowrap",children:String(f[p]??"")},p))},d))})]})})]})]})]})})}function AF({rule:e,updateRule:t,deleteRule:r,domains:n}){return e?h.jsxs("div",{className:"max-w-5xl mx-auto p-6",children:[h.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(ql,{size:18,className:"text-neutral-600"}),h.jsx("h2",{className:"text-lg font-semibold",children:"Validation Rule"})]}),h.jsx("button",{onClick:()=>r(e.id),className:"px-2 py-1 rounded-md bg-neutral-100 border border-neutral-300 hover:bg-neutral-200 text-sm",children:h.jsx(Ql,{size:14})})]}),h.jsxs("div",{className:"rounded-xl border border-neutral-200 bg-white",children:[h.jsxs("div",{className:"p-3 border-b border-neutral-200 flex items-center gap-2",children:[h.jsx("input",{className:"bg-white border border-neutral-300 rounded-md px-2 py-1 text-sm",value:e.name,onChange:a=>t(e.id,{name:a.target.value})}),h.jsx("select",{className:"bg-white border border-neutral-300 rounded-md px-2 py-1 text-sm",value:e.appliesTo,onChange:a=>t(e.id,{appliesTo:a.target.value}),children:n.map(a=>h.jsx("option",{value:a.id,children:a.label},a.id))}),h.jsx(vd,{checked:e.enabled,onChange:a=>t(e.id,{enabled:a})})]}),h.jsxs("div",{className:"p-3 grid grid-cols-1 md:grid-cols-2 gap-3",children:[h.jsx(gn,{label:"Required Columns (comma-separated)",children:h.jsx("input",{className:"w-full bg-white border border-neutral-300 rounded-lg px-3 py-2 text-sm",value:e.requiredColumns.join(", "),onChange:a=>t(e.id,{requiredColumns:a.target.value.split(",").map(s=>s.trim()).filter(Boolean)})})}),h.jsx(gn,{label:"Account Number Pattern (RegExp)",children:h.jsx("input",{className:"w-full bg-white border border-neutral-300 rounded-lg px-3 py-2 text-sm",value:e.accountPattern,onChange:a=>t(e.id,{accountPattern:a.target.value})})}),h.jsx(gn,{label:"Allowed Currencies (comma-separated)",children:h.jsx("input",{className:"w-full bg-white border border-neutral-300 rounded-lg px-3 py-2 text-sm",value:e.allowedCurrencies.join(", "),onChange:a=>t(e.id,{allowedCurrencies:a.target.value.split(",").map(s=>s.trim()).filter(Boolean)})})}),h.jsx(gn,{label:"Max Amount per Transaction",children:h.jsx("input",{type:"number",className:"w-full bg-white border border-neutral-300 rounded-lg px-3 py-2 text-sm",value:e.maxAmountPerTxn,onChange:a=>t(e.id,{maxAmountPerTxn:Number(a.target.value)||0})})}),h.jsx(gn,{label:"Max Batch Total Amount",children:h.jsx("input",{type:"number",className:"w-full bg-white border border-neutral-300 rounded-lg px-3 py-2 text-sm",value:e.maxTotalAmount,onChange:a=>t(e.id,{maxTotalAmount:Number(a.target.value)||0})})}),h.jsx(gn,{label:"Allow Duplicates (Account+Amount)",children:h.jsxs("select",{className:"w-full bg-white border border-neutral-300 rounded-lg px-3 py-2 text-sm",value:e.allowDuplicateAccountPerBatch?"yes":"no",onChange:a=>t(e.id,{allowDuplicateAccountPerBatch:a.target.value==="yes"}),children:[h.jsx("option",{value:"no",children:"No"}),h.jsx("option",{value:"yes",children:"Yes"})]})}),h.jsx(gn,{label:"Business Hours Only (Mon–Fri 09:00–17:00)",children:h.jsxs("select",{className:"w-full bg-white border border-neutral-300 rounded-lg px-3 py-2 text-sm",value:e.businessHoursOnly?"yes":"no",onChange:a=>t(e.id,{businessHoursOnly:a.target.value==="yes"}),children:[h.jsx("option",{value:"no",children:"No"}),h.jsx("option",{value:"yes",children:"Yes"})]})})]})]}),h.jsxs("div",{className:"mt-8 text-sm text-neutral-600",children:["Rules are stored locally (browser). On upload, all ",h.jsx("em",{children:"enabled"})," rules for the active domain will run automatically."]})]}):null}function CF({apiKey:e,setApiKey:t,model:r,setModel:n}){return h.jsxs("div",{className:"p-4",children:[h.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[h.jsx(qk,{size:18,className:"text-neutral-600"}),h.jsx("h2",{className:"text-lg font-semibold",children:"AI Model"})]}),h.jsxs(gn,{label:"OpenAI API Key (temporary BYOK)",children:[h.jsxs("div",{className:"flex gap-2",children:[h.jsxs("div",{className:"relative flex-1",children:[h.jsx(Dk,{size:16,className:"absolute left-2 top-2.5 text-neutral-500"}),h.jsx("input",{className:"w-full bg-white border border-neutral-300 rounded-lg pl-8 pr-3 py-2 text-sm",placeholder:"sk-...",value:e,onChange:a=>t(a.target.value)})]}),h.jsx("button",{className:"px-3 py-2 rounded-lg bg-neutral-100 border border-neutral-300 hover:bg-neutral-200",onClick:()=>t(""),children:h.jsx(Ql,{size:16})})]}),h.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"For production, proxy OpenAI calls via your backend. Never ship keys in the browser."})]}),h.jsx(gn,{label:"Model",children:h.jsx("select",{className:"w-full bg-white border border-neutral-300 rounded-lg px-3 py-2 text-sm",value:r,onChange:a=>n(a.target.value),children:_v.map(a=>h.jsx("option",{value:a,children:a},a))})}),h.jsx("div",{className:"mt-8 text-sm text-neutral-600",children:"This MVP runs entirely client-side."})]})}function gn({label:e,children:t}){return h.jsxs("label",{className:"block",children:[h.jsx("div",{className:"text-sm text-neutral-700 mb-1",children:e}),t]})}function Qp({domain:e,domainId:t=null,kind:r,rulesets:n,setRulesets:a,tasks:s,setTasks:i,apiKey:o,model:l,addToast:c}){const{user:u}=Rc(),f=t?`dp.chat.${t}`:`dp.chat.local.${e}`,[d,p]=J.useState(()=>{try{const V=localStorage.getItem(f);if(V)return JSON.parse(V)}catch{}return[{role:"assistant",type:"text",content:`Upload Excel/CSV for ${r==="credit"?"customers":"products"}. I’ll auto-validate using all enabled ${r==="credit"?"Credit":"Debit"} rules. Use Ask to query results.`}]}),[x,m]=J.useState(""),[v,w]=J.useState(!1),[y,g]=J.useState(null),[E,P]=J.useState(null),T=J.useRef(null),[k,I]=J.useState(null),[R,U]=J.useState(""),[z,B]=J.useState(!0),[ae,ge]=J.useState(null),[ue,pe]=J.useState(!1),[de,ie]=J.useState(!1);J.useEffect(()=>{var V;(V=T.current)==null||V.scrollTo({top:T.current.scrollHeight})},[d]),J.useEffect(()=>{try{const V=d.filter(q=>q.type!=="thinking");localStorage.setItem(f,JSON.stringify(V))}catch{}},[d,f]);const M=J.useMemo(()=>s.filter(V=>V.kind===r),[s,r]),se=t?e:r==="credit"?"Customers":"Products",me=t?kl:r==="credit"?Bm:kl;J.useEffect(()=>{(async()=>{var V,q;try{if(!t){ge(null);return}const Q=(q=(V=(await Pe.auth.getSession()).data)==null?void 0:V.session)==null?void 0:q.access_token;if(!Q)return;const te=await fetch(`/api/domains/${t}/rules`,{headers:{Authorization:`Bearer ${Q}`}});if(!te.ok)return;const Ee=await te.json();ge(Array.isArray(Ee)?Ee.length:0)}catch{}})()},[t]);const b=async V=>{var Te,re,xe,ne,Ne;if(!V)return;const q=await pF(V),{combined:Q,perRule:te,totalAmount:Ee,rowCount:F}=mF(q,n,e),Re={id:ra("batch"),kind:r,fileName:V.name,createdAt:new Date().toISOString(),rowCount:F,totalAmount:Ee,status:Q.some(Me=>Me.level==="error")?"draft":"validated",issues:Q,rows:q,ruleResults:te};P(Re),p(Me=>[...Me,{role:"user",type:"file",content:V.name},{role:"assistant",type:"validation",content:"Validation results",payload:{combined:Q,perRule:te,totalAmount:Ee,rowCount:F}}]);try{const Me=Object.keys(q[0]||{}),Ge=Me.length;let Qe=0;const Ct=Me.map(je=>0),be=new Map;for(const je of q.slice(0,1e4)){const ke=JSON.stringify(je);be.set(ke,(be.get(ke)||0)+1);for(let Ve=0;Ve<Me.length;Ve++){const Nt=je[Me[Ve]];(Nt==null||Nt==="")&&(Qe++,Ct[Ve]++)}}const $e=Array.from(be.values()).filter(je=>je>1).reduce((je,ke)=>je+(ke-1),0),wt=F*Math.max(1,Ge),Bt=wt?Math.round(Qe/wt*100):0,Qt=Me.map((je,ke)=>({c:je,p:F?Math.round(Ct[ke]/F*100):0})).sort((je,ke)=>ke.p-je.p).slice(0,3).filter(je=>je.p>0).map(je=>`${je.c} ${je.p}%`).join(" · "),lt=`Profile: ${F} rows · ${Ge} columns · missing ${Qe} cells (${Bt}%)`+($e?` · ~${$e} duplicate rows`:"")+(Qt?` · top missing: ${Qt}`:"");p(je=>[...je,{role:"assistant",type:"summary",content:lt}])}catch{}c("File uploaded");try{const Me=((Te=u==null?void 0:u.user_metadata)==null?void 0:Te.tenant_id)||((re=u==null?void 0:u.app_metadata)==null?void 0:re.tenant_id)||"00000000-0000-0000-0000-000000000001",Ge="domains",Qe=`${Me}/${e}/${Date.now()}_${V.name}`;try{await fetch("/api/storage/ensure-bucket",{method:"POST",headers:$e,body:JSON.stringify({name:Ge,public:!1})})}catch{}const{error:Ct}=await Pe.storage.from(Ge).upload(Qe,V,{upsert:!0,cacheControl:"3600"});if(Ct)throw Ct;const be=(ne=(xe=(await Pe.auth.getSession()).data)==null?void 0:xe.session)==null?void 0:ne.access_token,$e=be?{Authorization:`Bearer ${be}`,"Content-Type":"application/json"}:{"Content-Type":"application/json"};let wt=null;const Bt=await fetch("/api/domains",{headers:$e});if(Bt.ok&&(wt=((Ne=(await Bt.json()).find(ke=>{var Ve;return((Ve=ke.name)==null?void 0:Ve.toLowerCase())===String(e).toLowerCase()}))==null?void 0:Ne.id)||null),!wt){const ke=await fetch("/api/domains",{method:"POST",headers:$e,body:JSON.stringify({name:e,business_key:e==="customers"?["email"]:e==="products"?["sku"]:["id"]})});if(!ke.ok)throw new Error((await ke.json()).error||"Failed creating domain");wt=(await ke.json()).id}const Qt=await fetch(`/api/domains/${wt}/ingest`,{method:"POST",headers:$e,body:JSON.stringify({path:Qe})});if(!Qt.ok)throw new Error((await Qt.json()).error||"Ingest failed");const lt=await Qt.json();p(je=>[...je,{role:"assistant",type:"text",content:`Ingested ${lt.rows} rows to domain "${e}".`}])}catch(Me){console.error("domain ingest error",Me),p(Ge=>[...Ge,{role:"assistant",type:"text",content:`Domain ingest error: ${Me.message||Me}`}])}},H=async()=>{if(!E)return;if(E.issues.some(Q=>Q.level==="error")){p(Q=>[...Q,{role:"assistant",type:"text",content:"Cannot submit while errors remain. Fix the data or adjust rules."}]);return}const q={id:ra("task"),kind:r,fileName:E.fileName,createdAt:new Date().toISOString(),rowCount:E.rowCount,totalAmount:E.totalAmount,status:"initiated",endpoint:null};i(Q=>[q,...Q]),p(Q=>[...Q,{role:"assistant",type:"text",content:`Task "${E.fileName}" initiated for ${E.rowCount} records.`}]),P(null),c("Task initiated")},L=async()=>{var q,Q;if(!x.trim())return;const V=x.trim();m(""),p(te=>[...te,{role:"user",type:"text",content:V}]);try{w(!0);const te=ra("thinking");g(te),p(Te=>[...Te,{role:"assistant",type:"thinking",id:te}]);const Ee={rulesets:n,lastBatch:E?{fileName:E.fileName,rowCount:E.rowCount,totalAmount:E.totalAmount,issues:E.issues,ruleResults:E.ruleResults,sampleRows:E.rows.slice(0,20)}:null},F=(Q=(q=(await Pe.auth.getSession()).data)==null?void 0:q.session)==null?void 0:Q.access_token;let Re="(No API key set. Go to Feature Preview to add an OpenAI key.)";Re=await gF(o,l,V,Ee,F),p(Te=>Te.filter(re=>re.id!==te)),p(Te=>[...Te,{role:"assistant",type:"text",content:Re}])}catch(te){y&&p(Ee=>Ee.filter(F=>F.id!==y)),p(Ee=>[...Ee,{role:"assistant",type:"text",content:String((te==null?void 0:te.message)||te)}])}finally{w(!1),g(null)}},j=V=>{var Q;V.preventDefault();const q=(Q=V.dataTransfer.files)==null?void 0:Q[0];q&&b(q)},Z=()=>{if(!k||!R)return;const V=k.id;i(q=>q.map(Q=>Q.id===V?{...Q,endpoint:R,status:"connecting"}:Q)),I(null),U(""),setTimeout(()=>{i(q=>q.map(Q=>Q.id===V?{...Q,status:"transferring"}:Q))},3e3),setTimeout(()=>{i(q=>q.map(Q=>Q.id===V?{...Q,status:"completed"}:Q))},6e3)};return h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:`grid grid-cols-1 ${z?"lg:grid-cols-3":"lg:grid-cols-1"} gap-0`,children:[h.jsxs("div",{className:`${z?"lg:col-span-2":"lg:col-span-1"} h-[calc(100vh-3rem)] flex flex-col`,children:[h.jsxs("div",{className:"border-b border-neutral-200 px-4 py-3 flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(me,{size:18,className:"text-neutral-600"}),h.jsx("div",{className:"font-medium",children:se}),h.jsx(Jp,{tone:"neutral",children:"Chat Mode"})]}),h.jsxs("div",{className:"flex gap-2",children:[t&&h.jsxs("button",{className:"px-3 py-1.5 rounded-lg bg-neutral-100 border border-neutral-300 text-sm flex items-center gap-2",title:"Add rule",onClick:async()=>{var V,q;try{const Q=prompt("Rule name");if(!Q)return;const te={type:"transform",transforms:[{name:"trim",columns:["*"]}]},Ee=(q=(V=(await Pe.auth.getSession()).data)==null?void 0:V.session)==null?void 0:q.access_token,F=await fetch(`/api/domains/${t}/rules`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Ee}`},body:JSON.stringify({name:Q,definition:te})});if(!F.ok)throw new Error((await F.json()).error||"Create rule failed");ge(Re=>Re==null?1:Re+1),p(Re=>[...Re,{role:"assistant",type:"text",content:`Rule "${Q}" created.`}])}catch(Q){p(te=>[...te,{role:"assistant",type:"text",content:`Create rule error: ${Q.message}`}])}},children:[h.jsx(Jl,{size:16})," Rule",ae!=null?` (${ae})`:""]}),t&&h.jsx("button",{className:"px-3 py-1.5 rounded-lg bg-neutral-100 border border-neutral-300 text-sm",onClick:()=>pe(!0),children:"Rules"}),t&&h.jsx("button",{className:"px-3 py-1.5 rounded-lg bg-neutral-100 border border-neutral-300 text-sm",onClick:()=>ie(!0),children:"Versions"}),h.jsx("button",{onClick:()=>B(V=>!V),className:"p-2 rounded-lg hover:bg-neutral-200","aria-label":z?"Hide Tasks":"Show Tasks",title:z?"Hide Tasks":"Show Tasks",children:h.jsx(Fk,{size:16})})]})]}),h.jsxs("div",{ref:T,onDragOver:V=>V.preventDefault(),onDrop:j,className:"flex-1 overflow-auto space-y-3 p-4",children:[d.map((V,q)=>h.jsx(wF,{msg:V,rulesets:n,setRulesets:a,kind:r,domain:e},q)),h.jsx("div",{className:"text-center text-xs text-neutral-600 pt-6",children:"Drop an Excel/CSV anywhere above to import"})]}),h.jsxs("div",{className:"border-t border-neutral-200 p-3",children:[h.jsxs("div",{className:"relative",children:[h.jsx("textarea",{className:"w-full bg-neutral-100 border border-neutral-300 rounded-xl text-lg resize-none h-28 px-3 pt-2 pb-14 pr-20 pl-10",placeholder:"Ask about the data, rules, or validation results...",value:x,onKeyDown:V=>{V.key==="Enter"&&!V.shiftKey&&(V.preventDefault(),L())},onChange:V=>m(V.target.value)}),h.jsx("div",{className:"absolute left-2 bottom-2",children:h.jsxs("label",{children:[h.jsx("input",{type:"file",className:"hidden",accept:".xlsx,.xls,.csv",onChange:V=>{var q;return((q=V.target.files)==null?void 0:q[0])&&b(V.target.files[0])}}),h.jsx("div",{className:"p-2 rounded-lg hover:bg-neutral-200 cursor-pointer",title:"Import",children:h.jsx(Vf,{size:16})})]})}),h.jsxs("div",{className:"absolute right-2 bottom-2 flex gap-2",children:[h.jsx("button",{disabled:v,onClick:L,className:"p-2 rounded-lg hover:bg-neutral-200 disabled:opacity-50","aria-label":"Ask",title:"Ask",children:h.jsx(Xk,{size:16})}),h.jsx("button",{disabled:v,onClick:H,className:"p-2 rounded-lg text-emerald-600 hover:bg-neutral-200 hover:text-emerald-500 disabled:opacity-50","aria-label":"Task",title:"Task",children:h.jsx(Uk,{size:16})})]})]}),h.jsxs("div",{className:"text-[11px] text-neutral-500 mt-2",children:["Use ",h.jsx("strong",{children:"Ask"})," for questions · Use ",h.jsx("strong",{children:"Task"})," to validate/submit"]}),h.jsx("div",{className:"text-[11px] text-neutral-500 mt-2",children:"Hint: Import first — validation runs automatically using enabled rules for this transfer type."})]})]}),z&&h.jsxs("div",{className:"border-l border-neutral-200 h-[calc(100vh-3rem)] overflow-auto",children:[h.jsxs("div",{className:"px-4 py-3 border-b border-neutral-200 flex items-center gap-2",children:[h.jsx(kl,{size:18,className:"text-neutral-600"}),h.jsx("div",{className:"font-medium",children:"Data Provider Monitoring"})]}),M.length===0?h.jsx("div",{className:"p-4 text-sm text-neutral-500",children:"No tasks yet. Upload a file to start."}):h.jsx("ul",{className:"p-2 space-y-2",children:M.map(V=>h.jsxs("li",{className:"p-3 bg-neutral-100 rounded-xl border border-neutral-200",children:[h.jsxs("div",{className:"flex items-center justify-between gap-2",children:[h.jsx("div",{className:`text-sm truncate ${V.status==="connecting"||V.status==="transferring"?"ai-highlight":""}`,children:V.fileName}),h.jsx(Jp,{tone:V.status==="completed"?"success":V.status==="failed"?"danger":V.status==="initiated"?"neutral":"warn",children:V.status})]}),h.jsxs("div",{className:"text-xs text-neutral-500 mt-1",children:[new Date(V.createdAt).toLocaleString()," · ",V.rowCount," rows · Total ",V.totalAmount.toLocaleString()]}),V.endpoint&&h.jsxs("div",{className:"text-xs text-neutral-500 mt-1 truncate",children:["API: ",V.endpoint]}),V.status!=="completed"&&h.jsx("div",{className:"mt-2 flex justify-end",children:h.jsx("button",{className:"px-2 py-1 rounded-md bg-neutral-200 border border-neutral-300 text-xs",onClick:()=>{I(V),U(V.endpoint||"")},children:"Select API"})})]},V.id))})]})]}),k&&h.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center",children:h.jsxs("div",{className:"bg-neutral-100 p-4 rounded-lg border border-neutral-300 w-80",children:[h.jsx("div",{className:"mb-2 font-medium",children:"Select API endpoint"}),h.jsxs("select",{className:"w-full bg-neutral-200 border border-neutral-300 rounded px-2 py-1 text-sm",value:R,onChange:V=>U(V.target.value),children:[h.jsx("option",{value:"",children:"Choose endpoint"}),h.jsx("option",{value:"https://api.bank1.example/transfer",children:"https://api.bank1.example/transfer"}),h.jsx("option",{value:"https://api.bank2.example/payment",children:"https://api.bank2.example/payment"}),h.jsx("option",{value:"https://api.demo.example/send",children:"https://api.demo.example/send"})]}),h.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[h.jsx("button",{onClick:()=>I(null),className:"px-3 py-1.5 rounded-md bg-neutral-200 border border-neutral-300 text-sm",children:"Cancel"}),h.jsx("button",{onClick:Z,className:"px-3 py-1.5 rounded-md bg-emerald-600 hover:bg-emerald-500 text-sm",children:"Assign"})]})]})}),t&&ue&&h.jsx(SF,{domainId:t,onClose:()=>pe(!1)}),t&&de&&h.jsx(TF,{domainId:t,onClose:()=>ie(!1)})]})}function NF(){const{user:e}=Rc(),[t,r]=J.useState({email:"",password:""}),[n,a]=J.useState(""),[s,i]=J.useState(!1);if(J.useEffect(()=>{e&&(window.location.href="/")},[e]),e===void 0)return h.jsx("div",{className:"p-4 text-neutral-500",children:"Loading..."});if(e)return null;const o=c=>{c.key==="Enter"&&l(c)},l=async c=>{var u,f;if(c.preventDefault(),!s){a(""),i(!0);try{const{data:d,error:p}=await jm(t);if(p)console.error("[Login] login error",p),p.message&&p.message.toLowerCase().includes("email not confirmed")?a("Please verify your email before logging in."):a(p.message);else{const x=await Yl(d==null?void 0:d.user);if((((u=x==null?void 0:x.user_metadata)==null?void 0:u.role)||((f=x==null?void 0:x.app_metadata)==null?void 0:f.role))==="super_admin"){await xo(),a("Please use the super admin login page.");return}window.location.href="/"}}catch(d){console.error("[Login] unexpected error",d),a(d.message)}finally{i(!1)}}};return h.jsxs("div",{className:"min-h-screen flex flex-col bg-white",children:[h.jsxs("nav",{className:"flex items-center justify-between p-4",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"size-6 rounded-lg bg-emerald-200 grid place-items-center",children:h.jsx("span",{className:"text-emerald-700 text-xs",children:"⚡"})}),h.jsx("div",{className:"font-semibold",children:"dP"})]}),h.jsx("a",{href:"/docs",className:"text-sm underline",children:"Docs"})]}),h.jsx("header",{className:"px-6 md:px-10 lg:px-20 pt-8 pb-6 text-center",children:h.jsxs("div",{className:"max-w-4xl mx-auto",children:[h.jsx("h1",{className:"text-4xl md:text-6xl font-semibold tracking-tight leading-tight",children:"The fastest platform for cleaning and shipping data"}),h.jsx("p",{className:"mt-5 text-neutral-600 text-lg max-w-2xl mx-auto",children:"Import. Chat. Generate rules. Version datasets. Move from raw → ready in minutes, not months."})]})}),h.jsx("div",{id:"signin",className:"flex items-start justify-center p-6",children:h.jsxs("form",{onSubmit:l,onKeyDown:o,className:"w-full max-w-md space-y-4 border rounded-2xl p-6",children:[h.jsxs("div",{className:"text-center",children:[h.jsx("h3",{className:"text-2xl font-medium",children:"Welcome back"}),h.jsx("p",{className:"text-sm text-neutral-600 mt-1",children:"Sign in to continue cleaning and shipping data."})]}),n&&h.jsx("div",{className:"text-sm text-red-500 text-center",children:n}),h.jsx("input",{type:"email",required:!0,value:t.email,onChange:c=>r({...t,email:c.target.value}),placeholder:"Work email",className:"w-full border rounded px-3 py-2"}),h.jsx("input",{type:"password",required:!0,value:t.password,onChange:c=>r({...t,password:c.target.value}),placeholder:"Password",className:"w-full border rounded px-3 py-2"}),h.jsx("button",{type:"submit",disabled:s,className:"w-full bg-neutral-900 text-white rounded py-2 flex items-center justify-center",children:s?h.jsxs(h.Fragment,{children:[h.jsx(Hf,{className:"w-4 h-4 animate-spin"}),h.jsx("span",{className:"sr-only",children:"Signing in..."})]}):"Sign in"}),h.jsxs("p",{className:"text-sm text-center text-neutral-600",children:["New to dP? ",h.jsx("a",{href:"/signup",className:"underline",children:"Create an account"})]}),h.jsx("p",{className:"text-xs text-center text-neutral-500",children:"By continuing you agree to our Terms and Privacy Policy."})]})}),h.jsx("section",{className:"px-6 md:px-10 lg:px-20 pt-4 pb-10 text-center",children:h.jsxs("div",{className:"max-w-4xl mx-auto",children:[h.jsxs("div",{className:"mt-2 flex items-center justify-center gap-4",children:[h.jsx("a",{href:"#signin",className:"px-5 py-3 rounded-full bg-neutral-900 text-white text-sm",children:"Start building ↗"}),h.jsx("a",{href:"/docs",className:"px-5 py-3 rounded-full border text-sm",children:"Learn more"})]}),h.jsxs("div",{className:"mt-8 grid grid-cols-2 sm:grid-cols-4 gap-6 text-neutral-400 justify-items-center",children:[h.jsx("div",{className:"text-sm",children:"Paradigm"}),h.jsx("div",{className:"text-sm",children:"Wix"}),h.jsx("div",{className:"text-sm",children:"Gov. of Iceland"}),h.jsx("div",{className:"text-sm",children:"Ironclad"})]})]})}),h.jsxs("section",{className:"px-6 md:px-10 lg:px-20 py-12 text-center",children:[h.jsx("h2",{className:"text-2xl md:text-3xl font-medium",children:"Access the power of our tools"}),h.jsxs("div",{className:"mt-4 inline-flex items-center gap-2 rounded-full bg-neutral-100 px-3 py-1 text-sm",children:[h.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white border",children:"Rules Engine"}),h.jsx("span",{children:"Domain Versioning"}),h.jsx("span",{children:"AI Chat"}),h.jsx("span",{children:"APIs"})]}),h.jsxs("div",{className:"mt-8 grid md:grid-cols-2 gap-8 items-center max-w-5xl mx-auto",children:[h.jsxs("div",{className:"text-left md:pr-8",children:[h.jsx("h3",{className:"text-xl font-medium mb-2",children:"Responses API"}),h.jsx("p",{className:"text-sm text-neutral-600",children:"A simple API for agents, combining AI chat with data tooling. Generate rules, profile data, and keep history with a single call."}),h.jsx("a",{href:"/docs",className:"text-sm underline mt-3 inline-block",children:"Learn more"})]}),h.jsx("div",{className:"rounded-2xl bg-neutral-100 h-64 grid place-items-center text-neutral-400 text-sm",children:h.jsx("span",{children:"API code sample coming soon"})})]})]})]})}function bF(){const[e,t]=J.useState({email:"",password:""}),[r,n]=J.useState(""),[a,s]=J.useState(!1),i=async o=>{o.preventDefault(),n("");try{const{data:l,error:c}=await mk(e);c?(console.error("[Signup] signup error",c),n(c.message)):l!=null&&l.session?window.location.href="/":s(!0)}catch(l){console.error("[Signup] unexpected error",l),n(l.message)}};return h.jsxs("div",{className:"min-h-screen flex flex-col",children:[h.jsxs("nav",{className:"flex items-center justify-between p-4 border-b border-neutral-200",children:[h.jsx("div",{className:"font-semibold",children:"dP"}),h.jsx("a",{href:"/login",className:"underline",children:"Sign in"})]}),h.jsx("div",{className:"flex-grow flex items-center justify-center p-4",children:a?h.jsxs("div",{className:"w-full max-w-sm space-y-4 text-center",children:[h.jsx("h1",{className:"text-2xl font-medium",children:"Check your email"}),h.jsxs("p",{className:"text-sm text-neutral-600",children:["We've sent a verification link to ",e.email,". Please verify your account to continue."]}),h.jsx("button",{onClick:()=>window.location.href="/login",className:"w-full bg-neutral-900 text-white rounded py-2",children:"Go to login"})]}):h.jsxs("form",{onSubmit:i,className:"w-full max-w-sm space-y-4",children:[h.jsx("h1",{className:"text-2xl font-medium text-center",children:"Create account"}),r&&h.jsx("div",{className:"text-sm text-red-500 text-center",children:r}),h.jsx("input",{type:"email",required:!0,value:e.email,onChange:o=>t({...e,email:o.target.value}),placeholder:"Email",className:"w-full border rounded px-3 py-2"}),h.jsx("input",{type:"password",required:!0,value:e.password,onChange:o=>t({...e,password:o.target.value}),placeholder:"Password",className:"w-full border rounded px-3 py-2"}),h.jsx("button",{type:"submit",className:"w-full bg-neutral-900 text-white rounded py-2",children:"Sign up"}),h.jsxs("p",{className:"text-sm text-center text-neutral-600",children:["Already have an account?"," ",h.jsx("a",{href:"/login",className:"underline",children:"Login"})]})]})})]})}function FF(){const[e,t]=J.useState("");return J.useEffect(()=>{async function r(){var n,a,s,i;try{const o=new URL(window.location.href),l=o.searchParams.get("code");if(l){const{error:x}=await Pe.auth.exchangeCodeForSession(l);if(x)throw x;o.searchParams.delete("code"),window.history.replaceState({},document.title,o.toString())}const{data:{user:c},error:u}=await Pe.auth.getUser();if(u)throw u;if(!c)throw new Error("User not found after confirmation");const f=((n=c==null?void 0:c.user_metadata)==null?void 0:n.role)||((a=c==null?void 0:c.app_metadata)==null?void 0:a.role)||"user",d=((s=c==null?void 0:c.user_metadata)==null?void 0:s.tenant_id)??((i=c==null?void 0:c.app_metadata)==null?void 0:i.tenant_id)??"00000000-0000-0000-0000-000000000001",{error:p}=await Pe.from("users").upsert({id:c.id,username:c.email,role:f,tenant_id:d,status:"active"},{onConflict:"id"});if(p)throw p;window.location.replace(f==="super_admin"?"/superadmin":"/")}catch(o){console.error("[Confirm] error",o),t(o.message)}}r()},[]),h.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e?h.jsxs("div",{className:"text-center space-y-4",children:[h.jsx("h1",{className:"text-2xl font-medium",children:"Confirmation failed"}),h.jsx("p",{className:"text-sm text-neutral-600",children:e}),h.jsx("button",{onClick:()=>window.location.href="/login",className:"bg-neutral-900 text-white rounded px-4 py-2",children:"Go to login"})]}):h.jsxs("div",{className:"text-center space-y-4",children:[h.jsx("h1",{className:"text-2xl font-medium",children:"Confirming..."}),h.jsx("p",{className:"text-sm text-neutral-600",children:"Please wait while we set up your account."})]})})}function OF({tenantId:e,token:t}){const[r,n]=J.useState([]),[a,s]=J.useState(""),[i,o]=J.useState(!1);return J.useEffect(()=>{!e||!t||(o(!0),fetch(`/api/superadmin/audit?tenantId=${e}&limit=50`,{headers:{Authorization:`Bearer ${t}`}}).then(async l=>{if(!l.ok)throw new Error((await l.json()).error||l.statusText);return l.json()}).then(l=>n(l||[])).catch(l=>s(l.message)).finally(()=>o(!1)))},[e,t]),e?h.jsxs("div",{className:"mt-6 border rounded",children:[h.jsx("div",{className:"px-3 py-2 border-b text-sm font-medium bg-neutral-50",children:"Audit Logs"}),i?h.jsx("div",{className:"p-3 text-neutral-500",children:"Loading..."}):a?h.jsx("div",{className:"p-3 text-red-600 text-sm",children:a}):h.jsx("div",{className:"p-3",children:r.length===0?h.jsx("div",{className:"text-sm text-neutral-500",children:"No audit logs yet."}):h.jsx("ul",{className:"text-sm space-y-2",children:r.map(l=>{const c=l.meta||{};let u="";if(l.resource==="user"){const f=c.disabled?"disabled":c.status||"active";u=[c.email,c.role,f].filter(Boolean).join(" · ")}else if(l.resource==="tenant"){const f=[];c.trial&&f.push(`trial ${c.trial_days||""}d`),c.subscription_active&&f.push(`sub ${c.subscription_period_months||""}m`),c.active_plan&&f.push(`plan ${c.active_plan}`),u=f.join(" · ")}else l.resource==="policy"&&(u=`${Array.isArray(c.items)?c.items.length:0} rules saved`);return h.jsxs("li",{className:"flex items-start gap-2",children:[h.jsx("span",{className:"text-neutral-500 w-56 shrink-0",children:new Date(l.created_at).toLocaleString()}),h.jsx("span",{className:"px-2 py-0.5 rounded-full border bg-neutral-50 text-neutral-700",children:l.action}),h.jsx("span",{className:"capitalize",children:l.resource}),h.jsx("span",{className:"text-neutral-500 truncate",children:l.resource_id||""}),c.actor_email&&h.jsxs("span",{className:"ml-auto text-neutral-500",children:["by ",c.actor_email]}),u&&h.jsxs("span",{className:"ml-2 text-neutral-700",children:["— ",u]})]},l.id)})})})]}):null}function PF(){var Ao,Co,No,bo,Fo,Oo;const[e,t]=J.useState(""),[r,n]=J.useState([]),[a,s]=J.useState(""),[i,o]=J.useState(null),[l,c]=J.useState([]),[u,f]=J.useState({email:"",password:""}),[d,p]=J.useState("user"),[x,m]=J.useState(!1),[v,w]=J.useState(""),[y,g]=J.useState(!1),[E,P]=J.useState(""),[T,k]=J.useState(!1),[I,R]=J.useState(""),[U,z]=J.useState(!1),[B,ae]=J.useState(""),[ge,ue]=J.useState(null),[pe,de]=J.useState(""),[ie,M]=J.useState(null),[se,me]=J.useState(""),[b,H]=J.useState(!1),L=J.useRef(null),j=J.useRef(null),[Z,V]=J.useState(!1),[q,Q]=J.useState(null),[te,Ee]=J.useState([]),F=["dashboard","domain","rules"],[Re,Te]=J.useState({user:F.reduce((D,Y)=>({...D,[Y]:{can_create:!1,can_update:!1,can_delete:!1}}),{}),admin:F.reduce((D,Y)=>({...D,[Y]:{can_create:!1,can_update:!1,can_delete:!1}}),{})}),re=["pro","enterprise"],xe=[6,12,18,24];J.useEffect(()=>{Pe.auth.getSession().then(({data:Y})=>{var oe,ye;t(((oe=Y.session)==null?void 0:oe.access_token)||""),Q(((ye=Y.session)==null?void 0:ye.user)||null)});const{data:D}=Pe.auth.onAuthStateChange((Y,oe)=>{t((oe==null?void 0:oe.access_token)||""),Q((oe==null?void 0:oe.user)||null)});return()=>{var Y,oe;return(oe=(Y=D==null?void 0:D.subscription)==null?void 0:Y.unsubscribe)==null?void 0:oe.call(Y)}},[]),J.useEffect(()=>{e&&ne()},[e]),J.useEffect(()=>{e&&i&&Promise.all(["user","admin"].map(fn)).catch(()=>{})},[e,i]);const ne=async()=>{m(!0),w("");try{const D=await fetch("/api/superadmin/tenants",{headers:{Authorization:`Bearer ${e}`}});if(!D.ok){const oe=await Zt(D);throw new Error(oe)}const Y=await D.json();n(Y||[]),Xe("Tenants loaded")}catch(D){w(D.message||"Failed to load tenants."),Xe(D.message||"Failed to load tenants","danger")}finally{m(!1)}},Ne=async()=>{k(!0),R("");try{const D=await fetch("/api/superadmin/tenants",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({name:a})});if(!D.ok){const oe=await Zt(D);throw new Error(oe)}const Y=await D.json();n(oe=>[...oe,Y]),s(""),Xe("Tenant added","success")}catch(D){R(D.message||"Failed to add tenant."),Xe(D.message||"Failed to add tenant","danger")}finally{k(!1)}},Me=D=>{o(D),Ge(D)},Ge=async D=>{g(!0),P("");try{const Y=await fetch(`/api/superadmin/tenants/${D.id}/users`,{headers:{Authorization:`Bearer ${e}`}});if(!Y.ok){const ye=await Zt(Y);throw new Error(ye)}const oe=await Y.json();c((oe||[]).map(ye=>({...ye,disabled:(ye.status||"active")==="disabled"}))),Xe("Users loaded")}catch(Y){P(Y.message||"Failed to load users."),Xe(Y.message||"Failed to load users","danger"),c([])}finally{g(!1)}},Qe=async()=>{if(i){if(!ko(u.email)){ae("Valid email required");return}if(!Vs(u.password)){ae("Password must be 8+ chars with upper, lower, number and symbol");return}z(!0),ae("");try{const D=await fetch("/api/superadmin/users",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({...u,tenantId:i.id,role:d})});if(!D.ok){const oe=await Zt(D);throw new Error(oe)}const Y=await D.json();c(oe=>[...oe,{...(Y==null?void 0:Y.user)||Y,disabled:!1}]),f({email:"",password:""}),p("user"),Xe("User added","success")}catch(D){ae(D.message||"Failed to add user."),Xe(D.message||"Failed to add user","danger")}finally{z(!1)}}},Ct=async D=>{try{const Y=await fetch(`/api/superadmin/tenants/${D}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({name:pe})});if(!Y.ok){const ye=await Zt(Y);throw new Error(ye)}const oe=await Y.json();n(ye=>ye.map(_=>_.id===D?oe:_)),ue(null),(i==null?void 0:i.id)===D&&o(oe)}catch(Y){Xe(Y.message||"Failed to rename tenant","danger")}},[be,$e]=J.useState({active_plan:"pro",trial:!0,subscription_start:"",subscription_end:"",subscription_active:!1,subscription_period_months:"",trial_days:7,settings:{}});J.useEffect(()=>{i&&$e({active_plan:i.active_plan||"pro",trial:!!i.trial,subscription_start:i.subscription_start||"",subscription_end:i.subscription_end||"",subscription_active:!!i.subscription_active,subscription_period_months:i.subscription_period_months||"",trial_days:i.trial_days||7,settings:i.settings||{}})},[i]);const wt=async()=>{if(i)try{const D={active_plan:be.active_plan,subscription_start:be.subscription_start||null,subscription_end:be.subscription_end||null,subscription_active:!!be.subscription_active,subscription_period_months:be.subscription_period_months||null,trial:!!be.trial,trial_days:be.trial?be.trial_days||7:null,settings:be.settings||{}},Y=await fetch(`/api/superadmin/tenants/${i.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(D)});if(!Y.ok)throw new Error(await Zt(Y));const oe=await Y.json();o(oe),n(ye=>ye.map(_=>_.id===oe.id?oe:_)),Xe("Tenant updated","success")}catch(D){Xe(D.message||"Failed to update tenant","danger")}};function Bt(D,Y){try{const oe=new Date(D),ye=oe.getUTCFullYear(),_=oe.getUTCMonth(),C=oe.getUTCDate();return new Date(Date.UTC(ye,_+Number(Y),C,oe.getUTCHours(),oe.getUTCMinutes())).toISOString()}catch{return""}}function Qt(D,Y){try{const oe=new Date(D);return oe.setUTCDate(oe.getUTCDate()+Number(Y)),oe.toISOString()}catch{return""}}function lt(D){if(!D)return"";try{return new Date(D).toLocaleString()}catch{return D}}const je=async D=>{if(confirm("Delete this tenant? This cannot be undone.")){M(D);try{const Y=await fetch(`/api/superadmin/tenants/${D}`,{method:"DELETE",headers:{Authorization:`Bearer ${e}`}});if(!Y.ok){const oe=await Zt(Y);throw new Error(oe)}n(oe=>oe.filter(ye=>ye.id!==D)),(i==null?void 0:i.id)===D&&(o(null),c([])),Xe("Tenant deleted","success")}catch(Y){Xe(Y.message||"Failed to delete tenant","danger")}finally{M(null)}}},ke=async(D,Y)=>{try{const oe=await fetch(`/api/superadmin/users/${D}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({role:Y})});if(!oe.ok){const ye=await Zt(oe);throw new Error(ye)}c(ye=>ye.map(_=>_.id===D?{..._,role:Y}:_))}catch(oe){Xe(oe.message||"Failed to update role","danger")}},Ve=async D=>{const Y=window.prompt("Enter a strong temporary password");if(Y){if(!Vs(Y)){alert("Password must be 8+ chars with upper, lower, number and symbol");return}try{const oe=await fetch(`/api/superadmin/users/${D}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({password:Y})});if(!oe.ok){const ye=await Zt(oe);throw new Error(ye)}Xe("Password updated","success")}catch(oe){Xe(oe.message||"Failed to update password","danger")}}},Nt=async D=>{if(confirm("Disable this user?"))try{const Y=await fetch(`/api/superadmin/users/${D}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({disabled:!0})});if(!Y.ok)throw new Error(await Zt(Y));c(oe=>oe.map(ye=>ye.id===D?{...ye,disabled:!0,status:"disabled"}:ye)),Xe("User disabled","neutral")}catch(Y){Xe(Y.message||"Failed to disable user","danger")}},dt=async D=>{try{const Y=await fetch(`/api/superadmin/users/${D}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({disabled:!1})});if(!Y.ok)throw new Error(await Zt(Y));c(oe=>oe.map(ye=>ye.id===D?{...ye,disabled:!1,status:"active"}:ye)),Xe("User enabled","success")}catch(Y){Xe(Y.message||"Failed to enable user","danger")}};async function fn(D){try{const Y=await fetch(`/api/superadmin/policies/${D}?tenantId=${(i==null?void 0:i.id)||""}`,{headers:{Authorization:`Bearer ${e}`}});if(!Y.ok)throw new Error(await Zt(Y));const oe=await Y.json(),ye=F.reduce((_,C)=>({..._,[C]:{can_create:!1,can_update:!1,can_delete:!1}}),{});oe.forEach(_=>{ye[_.resource]={can_create:!!_.can_create,can_update:!!_.can_update,can_delete:!!_.can_delete}}),Te(_=>({..._,[D]:ye}))}catch{}}async function zs(D){try{const Y=F.map(ye=>({resource:ye,...Re[D][ye]})),oe=await fetch(`/api/superadmin/policies/${D}?tenantId=${(i==null?void 0:i.id)||""}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({items:Y})});if(!oe.ok)throw new Error(await Zt(oe));Xe(`Policies saved for ${D}`,"success")}catch(Y){Xe(Y.message||"Failed to save policies","danger")}}function Xe(D,Y="neutral"){const oe=`${Date.now()}-${Math.random().toString(36).slice(2)}`,ye=Y==="success"?"🎉":Y==="danger"?"⚠️":"✨";Ee(_=>[..._,{id:oe,message:D,tone:Y,icon:ye}]),setTimeout(()=>Ee(_=>_.filter(C=>C.id!==oe)),2600)}async function Mc(D){var Y,oe;if(!(!D||!(q!=null&&q.id)))try{V(!0);const ye="avatars";try{const N=e||((oe=(Y=(await Pe.auth.getSession()).data)==null?void 0:Y.session)==null?void 0:oe.access_token);await fetch("/api/storage/ensure-bucket",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${N}`},body:JSON.stringify({name:ye,public:!0})})}catch{}const _=`${q.id}/${Date.now()}_${D.name}`,{error:C}=await Pe.storage.from(ye).upload(_,D,{upsert:!0,cacheControl:"3600"});if(C)throw C;const{data:S}=Pe.storage.from(ye).getPublicUrl(_),A=S==null?void 0:S.publicUrl;if(!A)throw new Error("Failed to get public URL");await Pe.auth.updateUser({data:{avatar_url:A}}),await Pe.from("users").update({profile_url:A}).eq("id",q.id),Q(N=>N&&{...N,user_metadata:{...N.user_metadata,avatar_url:A}}),Xe("Profile photo updated","success")}catch(ye){console.error("avatar upload error",ye),Xe(ye.message||"Upload failed","danger")}finally{V(!1)}}J.useEffect(()=>{const D=Y=>{L.current&&!L.current.contains(Y.target)&&H(!1)};return document.addEventListener("mousedown",D),()=>document.removeEventListener("mousedown",D)},[]);const Hs=J.useMemo(()=>{const D=se.trim().toLowerCase();return D?r.filter(Y=>Y.name.toLowerCase().includes(D)):r},[r,se]);function ko(D){return/[^\s@]+@[^\s@]+\.[^\s@]+/.test(D)}function Vs(D){return typeof D=="string"&&D.length>=8&&/[a-z]/.test(D)&&/[A-Z]/.test(D)&&/[0-9]/.test(D)&&/[^A-Za-z0-9]/.test(D)}async function Zt(D){var Y,oe;try{const ye=await D.json();return(ye==null?void 0:ye.error)||((oe=(Y=ye==null?void 0:ye.errors)==null?void 0:Y.map)==null?void 0:oe.call(Y,_=>_.msg).join(", "))||D.statusText}catch{return D.statusText}}function Eo(D){if(!D)return"";try{const Y=new Date(D),oe=Y.getTimezoneOffset();return new Date(Y.getTime()-oe*60*1e3).toISOString().slice(0,16)}catch{return""}}function dn(D){if(!D)return"";try{return new Date(D).toISOString()}catch{return""}}function So(){return{features:{beta_access:!1,seats:5},branding:{primary_color:"#10b981",logo_url:"https://example.com/logo.png"},notifications:{billing_email:"billing@example.com"}}}function To(D){try{const Y=new Date(D).getTime(),oe=Date.now(),ye=Math.max(0,Y-oe);return Math.ceil(ye/(1e3*60*60*24))}catch{return null}}return h.jsxs("div",{className:"min-h-[calc(100vh-3rem)] flex flex-col",children:[h.jsxs("div",{className:"h-12 border-b border-neutral-200 flex items-center justify-between px-4 md:px-6 lg:px-8 sticky top-0 bg-white/80 backdrop-blur z-40",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"size-6 rounded-lg bg-emerald-200 grid place-items-center",children:h.jsx(Um,{size:14,className:"text-emerald-700"})}),h.jsx("div",{className:"font-semibold",children:"dP"}),h.jsx("span",{className:"text-neutral-400",children:"/"}),h.jsx("div",{className:"text-sm text-neutral-700",children:"Super Admin"})]}),h.jsxs("div",{className:"relative",ref:L,children:[h.jsx("button",{onClick:()=>H(D=>!D),className:"w-8 h-8 rounded-full bg-neutral-200 overflow-hidden flex items-center justify-center","aria-label":"Account menu",children:(Ao=q==null?void 0:q.user_metadata)!=null&&Ao.avatar_url?h.jsx("img",{src:q.user_metadata.avatar_url,alt:"profile",className:"w-full h-full object-cover"}):q!=null&&q.email?h.jsx("span",{className:"text-sm font-medium text-neutral-600",children:(Co=q.email[0])==null?void 0:Co.toUpperCase()}):h.jsx(iE,{size:16,className:"text-neutral-700"})}),b&&h.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-md shadow-lg border border-neutral-200 text-neutral-700 z-50",children:[h.jsxs("div",{className:"p-4 border-b border-neutral-200 flex items-center gap-3",children:[h.jsx("div",{className:"w-10 h-10 rounded-full bg-neutral-300 overflow-hidden flex items-center justify-center",children:(No=q==null?void 0:q.user_metadata)!=null&&No.avatar_url?h.jsx("img",{src:q.user_metadata.avatar_url,alt:"profile",className:"w-full h-full object-cover"}):h.jsx("span",{className:"text-sm font-medium text-neutral-600",children:(Fo=(bo=q==null?void 0:q.email)==null?void 0:bo[0])==null?void 0:Fo.toUpperCase()})}),h.jsxs("div",{children:[h.jsx("div",{className:"text-sm font-medium",children:((Oo=q==null?void 0:q.user_metadata)==null?void 0:Oo.full_name)??(q==null?void 0:q.email)}),h.jsx("div",{className:"text-xs text-neutral-500",children:q==null?void 0:q.email})]})]}),h.jsxs("div",{className:"py-1 border-b border-neutral-200",children:[h.jsx("input",{ref:j,type:"file",accept:"image/*",className:"hidden",onChange:D=>{var oe;const Y=(oe=D.target.files)==null?void 0:oe[0];Y&&Mc(Y),D.target.value=""}}),h.jsxs("button",{onClick:()=>{var D;return(D=j.current)==null?void 0:D.click()},disabled:Z,className:"w-full text-left px-4 py-2 text-sm hover:bg-neutral-100 flex items-center gap-2 disabled:opacity-50",children:[h.jsx(Vf,{size:14}),Z?"Uploading...":"Upload Photo"]})]}),h.jsx("div",{className:"py-1",children:h.jsxs("button",{onClick:async()=>{H(!1),await xo(),window.location.replace("/login")},className:"w-full text-left px-4 py-2 text-sm hover:bg-neutral-100 text-red-600 flex items-center gap-2",children:[h.jsx(Lk,{size:14}),"Logout"]})})]})]})]}),h.jsxs("div",{className:"flex-1 px-4 md:px-6 lg:px-8 py-4 flex gap-6",children:[h.jsxs("aside",{className:"w-[320px] shrink-0",children:[h.jsxs("div",{className:"flex items-center justify-between mb-3",children:[h.jsx("h1",{className:"text-xl font-semibold",children:"Tenants"}),h.jsx("button",{onClick:ne,className:"p-2 rounded-lg hover:bg-neutral-100",title:"Refresh",children:h.jsx(Zo,{size:16})})]}),h.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[h.jsx("input",{type:"text",placeholder:"Search tenants...",value:se,onChange:D=>me(D.target.value),className:"flex-1 border rounded px-2 py-1"}),h.jsx(Gk,{size:16,className:"text-neutral-400"})]}),x?h.jsx("div",{className:"p-3 text-neutral-500",children:"Loading tenants..."}):v?h.jsxs("div",{className:"mb-4 space-y-1 text-red-600",children:[h.jsx("p",{children:v}),h.jsx("button",{onClick:ne,className:"underline",children:"Retry"})]}):h.jsxs("ul",{className:"mb-4 border rounded divide-y",children:[Hs.map(D=>h.jsxs("li",{className:`flex items-center justify-between px-3 py-2 ${(i==null?void 0:i.id)===D.id?"bg-neutral-100":""}`,children:[ge===D.id?h.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[h.jsx("input",{value:pe,onChange:Y=>de(Y.target.value),className:"flex-1 border rounded px-1 py-0.5",placeholder:"New name",autoFocus:!0,onKeyDown:Y=>{Y.key==="Enter"&&Ct(D.id),Y.key==="Escape"&&ue(null)}}),h.jsx("button",{onClick:()=>Ct(D.id),className:"p-1 hover:bg-neutral-100 rounded",title:"Save",children:h.jsx(Kh,{size:14})}),h.jsx("button",{onClick:()=>ue(null),className:"p-1 hover:bg-neutral-100 rounded",title:"Cancel",children:h.jsx(cE,{size:14})})]}):h.jsx("button",{onClick:()=>{(i==null?void 0:i.id)===D.id?(ue(D.id),de(D.name)):Me(D)},className:"flex-1 text-left underline decoration-dotted",title:(i==null?void 0:i.id)===D.id?"Click to rename":"Click to select",children:D.name}),h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[!D.trial&&!D.subscription_active&&D.active_plan&&h.jsx("span",{className:"px-2 py-0.5 rounded-full border bg-neutral-50 text-neutral-700",title:`Plan: ${D.active_plan}`,children:D.active_plan}),D.trial&&(D.trial_days||i!=null&&i.trial_days)?h.jsxs("span",{className:"px-2 py-0.5 rounded-full border bg-amber-50 text-amber-700",title:D.subscription_end?`Ends ${new Date(D.subscription_end).toLocaleString()}`:"Trial",children:["Trial ",D.trial_days||7,"d"]}):D.subscription_active&&D.subscription_period_months?h.jsxs("span",{className:"px-2 py-0.5 rounded-full border bg-emerald-50 text-emerald-700",title:D.subscription_end?`Ends ${new Date(D.subscription_end).toLocaleString()}`:"Subscription",children:["Sub ",D.subscription_period_months,"m"]}):null,D.subscription_end&&h.jsx(ql,{size:14,className:"text-neutral-400",title:`Ends in ${To(D.subscription_end)} days`,"aria-label":`Ends in ${To(D.subscription_end)} days`}),h.jsx("button",{disabled:ie===D.id,onClick:()=>je(D.id),className:"p-1 rounded hover:bg-neutral-100 disabled:opacity-50",title:"Delete","aria-label":"Delete",children:h.jsx(Ql,{size:14,className:"text-red-600"})})]})]},D.id)),Hs.length===0&&h.jsx("li",{className:"px-3 py-2 text-sm text-neutral-500",children:"No tenants found"})]}),h.jsx("div",{className:"space-y-2",children:h.jsxs("div",{className:"relative",children:[h.jsx("input",{type:"text",placeholder:"New tenant name",value:a,onChange:D=>s(D.target.value),onKeyDown:D=>{D.key==="Enter"&&a.trim()&&!T&&Ne()},className:"w-full border rounded px-2 pr-8 py-1"}),h.jsx("button",{onClick:Ne,disabled:T||!a.trim(),className:"absolute right-1 top-1/2 -translate-y-1/2 p-1 rounded hover:bg-neutral-100 disabled:opacity-50",title:"Add tenant","aria-label":"Add tenant",children:T?h.jsx(Zo,{size:14,className:"animate-spin"}):h.jsx(Jl,{size:14})})]})})]}),h.jsx("main",{className:"flex-1",children:i?h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-3",children:[h.jsxs("h2",{className:"text-lg font-medium",children:["Users · ",i.name]}),h.jsx("button",{onClick:()=>Ge(i),className:"p-2 rounded-lg hover:bg-neutral-100",title:"Refresh",children:h.jsx(Zo,{size:16})})]}),h.jsxs("div",{className:"mb-4 border rounded",children:[h.jsx("div",{className:"px-3 py-2 border-b flex items-center gap-2 text-neutral-700 bg-neutral-50",children:h.jsx("span",{className:"text-sm font-medium",children:"Tenant Details"})}),h.jsxs("div",{className:"p-3 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 items-end",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-xs text-neutral-500",children:"Plan"}),h.jsx("select",{value:be.active_plan,onChange:D=>$e(Y=>({...Y,active_plan:D.target.value})),className:"w-full border rounded px-2 py-1",children:re.map(D=>h.jsx("option",{value:D,children:D},D))})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs text-neutral-500",children:"Mode"}),h.jsxs("div",{className:"flex border rounded overflow-hidden",children:[h.jsx("button",{type:"button",onClick:()=>$e(D=>({...D,trial:!0,subscription_active:!1})),className:`px-3 py-1 text-sm ${be.trial?"bg-emerald-50 text-emerald-700":"bg-white text-neutral-700"}`,style:{borderRight:"1px solid #e5e7eb"},children:"Trial"}),h.jsx("button",{type:"button",onClick:()=>$e(D=>({...D,trial:!1,subscription_active:!0})),className:`px-3 py-1 text-sm ${be.subscription_active?"bg-emerald-50 text-emerald-700":"bg-white text-neutral-700"}`,children:"Subscription"})]})]}),be.trial?h.jsxs(h.Fragment,{children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-xs text-neutral-500",children:"Trial days"}),h.jsxs("select",{value:be.trial_days,onChange:D=>$e(Y=>{const oe=Number(D.target.value||7),ye=Y.subscription_start||new Date().toISOString();return{...Y,trial_days:oe,subscription_start:ye,subscription_end:Qt(ye,oe)}}),className:"w-full border rounded px-2 py-1",children:[h.jsx("option",{value:7,children:"7"}),h.jsx("option",{value:14,children:"14"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs text-neutral-500",children:"Trial start"}),h.jsx("input",{type:"datetime-local",value:Eo(be.subscription_start),onChange:D=>$e(Y=>({...Y,subscription_start:dn(D.target.value),subscription_end:Y.trial_days?Qt(dn(D.target.value),Y.trial_days):Y.subscription_end})),className:"w-full border rounded px-2 py-1"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs text-neutral-500",children:"Ends"}),h.jsx("div",{className:"px-2 py-1 border rounded bg-neutral-50 text-neutral-700",children:be.subscription_end?lt(be.subscription_end):"—"})]})]}):be.subscription_active&&h.jsxs(h.Fragment,{children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-xs text-neutral-500",children:"Period (months)"}),h.jsxs("select",{value:be.subscription_period_months,onChange:D=>{const Y=Number(D.target.value||0);$e(oe=>{const ye=oe.subscription_start||new Date().toISOString(),_=Y?Bt(ye,Y):"";return{...oe,subscription_period_months:Y,subscription_start:ye,subscription_end:_}})},className:"w-full border rounded px-2 py-1",children:[h.jsx("option",{value:"",children:"Select"}),xe.map(D=>h.jsx("option",{value:D,children:D},D))]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs text-neutral-500",children:"Subscription start"}),h.jsx("input",{type:"datetime-local",value:Eo(be.subscription_start),onChange:D=>$e(Y=>({...Y,subscription_start:dn(D.target.value),subscription_end:Y.subscription_period_months?Bt(dn(D.target.value),Y.subscription_period_months):Y.subscription_end})),className:"w-full border rounded px-2 py-1"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs text-neutral-500",children:"Ends"}),h.jsx("div",{className:"px-2 py-1 border rounded bg-neutral-50 text-neutral-700",children:be.subscription_end?lt(be.subscription_end):"—"})]})]}),h.jsxs("div",{className:"md:col-span-2 lg:col-span-3",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("label",{className:"text-xs text-neutral-500",children:"Settings (JSON)"}),h.jsx("button",{type:"button",onClick:()=>$e(D=>({...D,settings:So()})),className:"text-xs underline",title:"Insert sample",children:"Sample"})]}),h.jsx("textarea",{value:JSON.stringify(be.settings||{},null,2),onChange:D=>{try{const Y=JSON.parse(D.target.value||"{}");$e(oe=>({...oe,settings:Y}))}catch{}},rows:6,placeholder:JSON.stringify(So(),null,2),className:"w-full border rounded px-2 py-1 font-mono text-xs"})]}),h.jsxs("div",{className:"md:col-span-2 lg:col-span-3 flex gap-2",children:[h.jsx("button",{onClick:wt,className:"px-3 py-1 rounded bg-neutral-900 text-white text-sm",children:"Save"}),h.jsx("button",{onClick:()=>$e({active_plan:i.active_plan||"free",trial:!!i.trial,subscription_start:i.subscription_start||"",subscription_end:i.subscription_end||"",settings:i.settings||{}}),className:"px-3 py-1 rounded border text-sm",children:"Reset"})]})]})]}),y?h.jsx("div",{className:"p-3 text-neutral-500",children:"Loading users..."}):E?h.jsxs("div",{className:"mb-4 space-y-1 text-red-600",children:[h.jsx("p",{children:E}),h.jsx("button",{onClick:()=>Ge(i),className:"underline",children:"Retry"})]}):h.jsxs("table",{className:"w-full text-sm border rounded overflow-hidden",children:[h.jsx("thead",{className:"bg-neutral-100 text-neutral-700",children:h.jsxs("tr",{children:[h.jsx("th",{className:"text-left px-3 py-2",children:"Email"}),h.jsx("th",{className:"text-left px-3 py-2",children:"Role"}),h.jsx("th",{className:"text-left px-3 py-2",children:"Status"}),h.jsx("th",{className:"text-left px-3 py-2",children:"Actions"})]})}),h.jsxs("tbody",{children:[l.map(D=>h.jsxs("tr",{className:"border-t",children:[h.jsx("td",{className:"px-3 py-2",children:D.username||D.email}),h.jsx("td",{className:"px-3 py-2",children:h.jsxs("select",{value:D.role||"user",onChange:Y=>ke(D.id,Y.target.value),className:"border rounded px-2 py-1",children:[h.jsx("option",{value:"user",children:"user"}),h.jsx("option",{value:"admin",children:"admin"}),h.jsx("option",{value:"super_admin",children:"super_admin"})]})}),h.jsx("td",{className:"px-3 py-2",children:h.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full border ${D.disabled?"bg-neutral-100 text-neutral-700 border-neutral-300":"bg-emerald-50 text-emerald-700 border-emerald-200"}`,children:D.disabled?"Disabled":"Active"})}),h.jsxs("td",{className:"px-3 py-2 space-x-3",children:[h.jsx("button",{onClick:()=>Ve(D.id),className:"p-1 rounded hover:bg-neutral-100",title:"Reset password",children:h.jsx(Pk,{size:16})}),D.disabled?h.jsx("button",{onClick:()=>dt(D.id),className:"p-1 rounded hover:bg-neutral-100",title:"Enable",children:h.jsx(Kh,{size:16,className:"text-emerald-600"})}):h.jsx("button",{onClick:()=>Nt(D.id),className:"p-1 rounded hover:bg-neutral-100",title:"Disable",children:h.jsx(Ql,{size:16,className:"text-red-600"})})]})]},D.id)),l.length===0&&h.jsx("tr",{children:h.jsx("td",{className:"px-3 py-3 text-neutral-500",colSpan:"4",children:"No users for this tenant"})}),h.jsxs("tr",{className:"border-t",children:[h.jsx("td",{className:"px-3 py-2",children:h.jsx("input",{type:"email",placeholder:"User email",value:u.email,onChange:D=>f({...u,email:D.target.value}),className:"w-full border rounded px-2 py-1"})}),h.jsx("td",{className:"px-3 py-2",children:h.jsxs("select",{value:d,onChange:D=>p(D.target.value),className:"w-full border rounded px-2 py-1",children:[h.jsx("option",{value:"user",children:"user"}),h.jsx("option",{value:"admin",children:"admin"}),h.jsx("option",{value:"super_admin",children:"super_admin"})]})}),h.jsx("td",{className:"px-3 py-2",children:h.jsx("input",{type:"password",placeholder:"Password",value:u.password,onChange:D=>f({...u,password:D.target.value}),className:"w-full border rounded px-2 py-1"})}),h.jsx("td",{className:"px-3 py-2",children:h.jsx("button",{onClick:Qe,disabled:U||!u.email||!u.password,className:"px-3 py-1 rounded bg-neutral-900 text-white disabled:opacity-50",title:"Add user",children:U?h.jsx(Zo,{size:14,className:"animate-spin"}):h.jsx(Jl,{size:14})})})]}),B&&h.jsx("tr",{children:h.jsx("td",{colSpan:4,className:"px-3 pb-2 text-sm text-red-600",children:B})})]})]}),h.jsx("div",{className:"text-[11px] text-neutral-500 mt-2",children:"Draft values persist across tenants"}),h.jsxs("div",{className:"mt-6 border rounded",children:[h.jsxs("div",{className:"px-3 py-2 border-b flex items-center gap-2 text-neutral-700 bg-neutral-50",children:[h.jsx(Qk,{size:16}),h.jsx("span",{className:"text-sm font-medium",children:"Policy Settings"})]}),h.jsx("div",{className:"p-3 grid grid-cols-1 md:grid-cols-2 gap-4",children:["user","admin"].map(D=>h.jsxs("div",{className:"border rounded",children:[h.jsx("div",{className:"px-3 py-2 border-b text-sm font-medium capitalize bg-neutral-50",children:D}),h.jsxs("div",{className:"p-3 space-y-2 text-sm",children:[h.jsxs("div",{className:"grid grid-cols-4 gap-2 items-center",children:[h.jsx("div",{className:"text-neutral-500",children:"Resource"}),h.jsx("div",{className:"text-center",children:"Create"}),h.jsx("div",{className:"text-center",children:"Update"}),h.jsx("div",{className:"text-center",children:"Delete"})]}),F.map(Y=>h.jsxs("div",{className:"grid grid-cols-4 gap-2 items-center",children:[h.jsx("div",{className:"capitalize",children:Y}),["can_create","can_update","can_delete"].map(oe=>h.jsx("div",{className:"text-center",children:h.jsx("input",{type:"checkbox",checked:!!Re[D][Y][oe],onChange:ye=>Te(_=>({..._,[D]:{..._[D],[Y]:{..._[D][Y],[oe]:ye.target.checked}}}))})},oe))]},Y)),h.jsx("div",{className:"pt-2"})]})]},D))}),h.jsx("div",{className:"p-3 border-t",children:h.jsxs("button",{onClick:async()=>{await zs("user"),await zs("admin")},className:"px-3 py-1 rounded bg-neutral-900 text-white flex items-center gap-2 text-sm",children:[h.jsx(Vk,{size:14}),"Save Policies"]})})]}),h.jsx(OF,{tenantId:i.id,token:e})]}):h.jsx("div",{className:"p-3 text-neutral-600",children:"Select a tenant to view users."})})]}),h.jsx("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 space-y-2 z-50 w-[90%] max-w-md pointer-events-none",children:te.map(D=>h.jsxs("div",{className:`mx-auto px-4 py-2 rounded-lg shadow-lg text-sm border backdrop-blur pointer-events-auto flex items-center gap-2 justify-center ${D.tone==="success"?"bg-emerald-50/90 border-emerald-200 text-emerald-800":D.tone==="danger"?"bg-red-50/90 border-red-200 text-red-800":"bg-neutral-50/90 border-neutral-200 text-neutral-800"}`,children:[h.jsx("span",{className:"text-base",children:D.icon}),h.jsx("span",{children:D.message})]},D.id))})]})}const RF="270823";function DF(){const[e,t]=J.useState({email:"",password:"",code:""}),[r,n]=J.useState(""),[a,s]=J.useState(!1),[i,o]=J.useState(!1),[l,c]=J.useState(!1),u=p=>{p.key==="Enter"&&f(p)},f=async p=>{var x,m;if(p.preventDefault(),!l){n(""),c(!0);try{const{data:v,error:w}=await jm(e);if(w){console.error("[SuperAdminLogin] login error",w),n(w.message),c(!1);return}const y=await Yl(v==null?void 0:v.user);if((((x=y==null?void 0:y.user_metadata)==null?void 0:x.role)||((m=y==null?void 0:y.app_metadata)==null?void 0:m.role))!=="super_admin"){await xo(),n("Access restricted to super admins."),c(!1);return}window.location.replace("/superadmin")}catch(v){console.error("[SuperAdminLogin] unexpected error",v),n(v.message)}finally{c(!1)}}},d=async p=>{if(p.preventDefault(),n(""),e.code!==RF){n("Invalid invitation code.");return}try{const{error:x}=await gk(e);x?(console.error("[SuperAdminSignup] signup error",x),n(x.message)):o(!0)}catch(x){console.error("[SuperAdminSignup] unexpected error",x),n(x.message)}};return h.jsxs("div",{className:"min-h-screen flex flex-col",children:[h.jsx("nav",{className:"flex items-center justify-between p-4 border-b border-neutral-200",children:h.jsx("div",{className:"font-semibold",children:"dP"})}),h.jsx("div",{className:"flex-grow flex items-center justify-center p-4",children:a?i?h.jsxs("div",{className:"w-full max-w-sm space-y-4 text-center",children:[h.jsx("h1",{className:"text-2xl font-medium",children:"Check your email"}),h.jsxs("p",{className:"text-sm text-neutral-600",children:["We've sent a verification link to ",e.email,". Please verify your account to continue."]}),h.jsx("button",{onClick:()=>{o(!1),s(!1)},className:"w-full bg-neutral-900 text-white rounded py-2",children:"Go to login"})]}):h.jsxs("form",{onSubmit:d,className:"w-full max-w-sm space-y-4",children:[h.jsx("h1",{className:"text-2xl font-medium text-center",children:"Super Admin Sign up"}),r&&h.jsx("div",{className:"text-sm text-red-500 text-center",children:r}),h.jsx("input",{type:"email",required:!0,value:e.email,onChange:p=>t({...e,email:p.target.value}),placeholder:"Email",className:"w-full border rounded px-3 py-2"}),h.jsx("input",{type:"password",required:!0,value:e.password,onChange:p=>t({...e,password:p.target.value}),placeholder:"Password",className:"w-full border rounded px-3 py-2"}),h.jsx("input",{type:"text",required:!0,value:e.code,onChange:p=>t({...e,code:p.target.value}),placeholder:"Invitation Code",className:"w-full border rounded px-3 py-2"}),h.jsx("button",{type:"submit",className:"w-full bg-neutral-900 text-white rounded py-2",children:"Sign up"}),h.jsxs("p",{className:"text-sm text-center text-neutral-600",children:["Already have an account?"," ",h.jsx("button",{type:"button",onClick:()=>{s(!1),n("")},className:"underline",children:"Sign in"})]})]}):h.jsxs("form",{onSubmit:f,onKeyDown:u,className:"w-full max-w-sm space-y-4",children:[h.jsx("h1",{className:"text-2xl font-medium text-center",children:"Super Admin Sign in"}),r&&h.jsx("div",{className:"text-sm text-red-500 text-center",children:r}),h.jsx("input",{type:"email",required:!0,value:e.email,onChange:p=>t({...e,email:p.target.value}),placeholder:"Email",className:"w-full border rounded px-3 py-2"}),h.jsx("input",{type:"password",required:!0,value:e.password,onChange:p=>t({...e,password:p.target.value}),placeholder:"Password",className:"w-full border rounded px-3 py-2"}),h.jsx("button",{type:"submit",disabled:l,className:"w-full bg-neutral-900 text-white rounded py-2 flex items-center justify-center",children:l?h.jsxs(h.Fragment,{children:[h.jsx(Hf,{className:"w-4 h-4 animate-spin"}),h.jsx("span",{className:"sr-only",children:"Signing in..."})]}):"Sign in"}),h.jsxs("p",{className:"text-sm text-center text-neutral-600",children:["Need an account?"," ",h.jsx("button",{type:"button",onClick:()=>{s(!0),n("")},className:"underline",children:"Sign up"})]})]})})]})}function Zp({role:e,children:t}){var i,o;const{user:r,loading:n}=Rc();if(n||r===void 0)return console.log("[RoleGuard] user loading"),h.jsx("div",{className:"p-4 text-neutral-500",children:"Loading..."});if(!r)return console.warn("[RoleGuard] no user, redirecting"),window.location.replace("/login"),null;const a=((i=r==null?void 0:r.user_metadata)==null?void 0:i.role)||((o=r==null?void 0:r.app_metadata)==null?void 0:o.role)||"user";console.log("[RoleGuard] checking role",{required:e,userRole:a});const s=Array.isArray(e)?e:[e];return s.length&&!s.includes(a)?(console.warn("[RoleGuard] access denied",{required:s,userRole:a}),window.location.replace("/unauthorized"),null):(console.log("[RoleGuard] access granted",{userRole:a}),h.jsx(h.Fragment,{children:t}))}function IF(){const[e,t]=J.useState(!1);return h.jsx("div",{className:"min-h-screen flex items-center justify-center p-6",children:h.jsxs("div",{className:"max-w-md w-full border rounded-lg shadow-sm p-6 text-center",children:[h.jsx("h1",{className:"text-2xl font-semibold mb-2",children:"Unauthorized"}),h.jsx("p",{className:"text-sm text-neutral-600 mb-6",children:"You don't have permission to access this page."}),h.jsx("div",{className:"flex items-center justify-center gap-3",children:h.jsx("button",{onClick:async()=>{if(!e){try{t(!0),await xo()}catch{}window.location.replace("/login")}},disabled:e,className:"px-4 py-2 rounded bg-neutral-900 text-white disabled:opacity-50",children:e?"Signing out...":"Go to login"})})]})})}function jF(){const e=window.location.pathname.replace(/\/+$/,"");return e==="/login"?h.jsx(xa,{children:h.jsx(NF,{})}):e==="/superadmin/login"||e==="/super-admin/login"?h.jsx(xa,{children:h.jsx(DF,{})}):e==="/signup"?h.jsx(xa,{children:h.jsx(bF,{})}):e==="/confirm"?h.jsx(xa,{children:h.jsx(FF,{})}):e==="/unauthorized"?h.jsx(xa,{children:h.jsx(IF,{})}):e==="/superadmin"||e==="/super-admin"?h.jsx(xa,{children:h.jsx(Zp,{role:"super_admin",children:h.jsx(PF,{})})}):h.jsx(xa,{children:h.jsx(Zp,{role:["admin","user"],children:h.jsx(_F,{})})})}const kv=document.getElementById("root")||document.getElementById("app");if(!kv)throw new Error("Root container missing. Expected #root or #app");dm(kv).render(h.jsx(Uv.StrictMode,{children:h.jsx(jF,{})}));
